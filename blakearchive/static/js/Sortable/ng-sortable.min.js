/**
 * @author RubaXa <trash@rubaxa.org>
 * @licence MIT
 */
(function(c){"function"===typeof define&&define.amd?define(["angular","./Sortable"],c):"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?(require("angular"),c(angular,require("./Sortable")),module.exports="ng-sortable"):window.angular&&window.Sortable&&c(angular,Sortable)})(function(c,p){c.module("ng-sortable",[]).constant("ngSortableVersion","0.4.0").constant("ngSortableConfig",{}).directive("ngSortable",["$parse","ngSortableConfig",function(r,t){var d,l,u=function(c,
d){var b=[].filter.call(c.childNodes,function(c){return 8===c.nodeType&&-1!==c.nodeValue.indexOf("ngRepeat:")})[0];if(!b)return function(){return null};var b=b.nodeValue.match(/ngRepeat:\s*(?:\(.*?,\s*)?([^\s)]+)[\s)]+in\s+([^\s|]+)/),h=r(b[2]);return function(){return h(d.$parent)||[]}};return{restrict:"AC",scope:{ngSortable:"=?"},link:function(g,q){function b(a,c){var b="on"+a.type.charAt(0).toUpperCase()+a.type.substr(1),d=m();e[b]&&e[b]({model:c||d[a.newIndex],models:d,oldIndex:a.oldIndex,newIndex:a.newIndex})}
function h(a){var b=m();if(b){var e=a.oldIndex,h=a.newIndex;if(k!==a.from){var f=a.from["Sortable:ng-sortable"]();d=f[e];a.clone?(d=c.copy(d),f.splice(p.utils.index(a.clone),0,f.splice(e,1)[0]),a.from.removeChild(a.clone)):f.splice(e,1);b.splice(h,0,d);a.from.insertBefore(a.item,l)}else b.splice(h,0,b.splice(e,1)[0]);g.$apply()}}var k=q[0],e=c.extend(g.ngSortable||{},t),n=[],m=u(k,g),f;k["Sortable:ng-sortable"]=m;f=p.create(k,Object.keys(e).reduce(function(a,b){a[b]=a[b]||e[b];return a},{onStart:function(a){l=
a.item.nextSibling;b(a);g.$apply()},onEnd:function(a){b(a,d);g.$apply()},onAdd:function(a){h(a);b(a,d);g.$apply()},onUpdate:function(a){h(a);b(a)},onRemove:function(a){b(a,d)},onSort:function(a){b(a)}}));q.on("$destroy",function(){c.forEach(n,function(a){a()});f.destroy();l=f=n=k=k["Sortable:ng-sortable"]=null});c.forEach("sort disabled draggable handle animation group ghostClass filter onStart onEnd onAdd onUpdate onRemove onSort".split(" "),function(a){n.push(g.$watch("ngSortable."+a,function(b){void 0!==
b&&(e[a]=b,/^on[A-Z]/.test(a)||f.option(a,b))}))})}}}])});