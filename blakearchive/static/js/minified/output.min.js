!function(a){"function"==typeof define&&define.amd?define(["angular","./Sortable"],a):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?(require("angular"),a(angular,require("./Sortable")),module.exports="ng-sortable"):window.angular&&window.Sortable&&a(angular,Sortable)}(function(a,b){a.module("ng-sortable",[]).constant("ngSortableVersion","0.4.0").constant("ngSortableConfig",{}).directive("ngSortable",["$parse","ngSortableConfig",function(c,d){var e,f,g=function(a,b){var d=[].filter.call(a.childNodes,function(a){return 8===a.nodeType&&-1!==a.nodeValue.indexOf("ngRepeat:")})[0];if(!d)return function(){return null};var d=d.nodeValue.match(/ngRepeat:\s*(?:\(.*?,\s*)?([^\s)]+)[\s)]+in\s+([^\s|]+)/),e=c(d[2]);return function(){return e(b.$parent)||[]}};return{restrict:"AC",scope:{ngSortable:"=?"},link:function(c,h){function i(a,b){var c="on"+a.type.charAt(0).toUpperCase()+a.type.substr(1),d=o();m[c]&&m[c]({model:b||d[a.newIndex],models:d,oldIndex:a.oldIndex,newIndex:a.newIndex})}function j(d){var g=o();if(g){var h=d.oldIndex,i=d.newIndex;if(l!==d.from){var j=d.from["Sortable:ng-sortable"]();e=j[h],d.clone?(e=a.copy(e),j.splice(b.utils.index(d.clone),0,j.splice(h,1)[0]),d.from.removeChild(d.clone)):j.splice(h,1),g.splice(i,0,e),d.from.insertBefore(d.item,f)}else g.splice(i,0,g.splice(h,1)[0]);c.$apply()}}var k,l=h[0],m=a.extend(c.ngSortable||{},d),n=[],o=g(l,c);l["Sortable:ng-sortable"]=o,k=b.create(l,Object.keys(m).reduce(function(a,b){return a[b]=a[b]||m[b],a},{onStart:function(a){f=a.item.nextSibling,i(a),c.$apply()},onEnd:function(a){i(a,e),c.$apply()},onAdd:function(a){j(a),i(a,e),c.$apply()},onUpdate:function(a){j(a),i(a)},onRemove:function(a){i(a,e)},onSort:function(a){i(a)}})),h.on("$destroy",function(){a.forEach(n,function(a){a()}),k.destroy(),f=k=n=l=l["Sortable:ng-sortable"]=null}),a.forEach("sort disabled draggable handle animation group ghostClass filter onStart onEnd onAdd onUpdate onRemove onSort".split(" "),function(a){n.push(c.$watch("ngSortable."+a,function(b){void 0!==b&&(m[a]=b,/^on[A-Z]/.test(a)||k.option(a,b))}))})}}}])}),function(a){var b=function(a){var b=a.module("FBAngular",[]);return b.factory("Fullscreen",["$document","$rootScope",function(b,c){var d=b[0],e="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element&&Element.ALLOW_KEYBOARD_INPUT,f=c.$new();b.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){f.$emit("FBFullscreen.change",g.isEnabled())});var g={$on:a.bind(f,f.$on),all:function(){g.enable(d.documentElement)},enable:function(a){a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?/Version\/[\d]{1,2}(\.[\d]{1,2}){1}(\.(\d){1,2}){0,1} Safari/.test(navigator.userAgent)?a.webkitRequestFullscreen():a.webkitRequestFullscreen(e):a.msRequestFullscreen&&a.msRequestFullscreen()},cancel:function(){d.cancelFullScreen?d.cancelFullScreen():d.mozCancelFullScreen?d.mozCancelFullScreen():d.webkitExitFullscreen?d.webkitExitFullscreen():d.msExitFullscreen&&d.msExitFullscreen()},isEnabled:function(){return d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement?!0:!1},toggleAll:function(){g.isEnabled()?g.cancel():g.all()},isSupported:function(){var a=d.documentElement;return a.requestFullScreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen?!0:!1}};return g}]),b.directive("fullscreen",["Fullscreen",function(a){return{link:function(b,c,d){if(d.fullscreen){b.$watch(d.fullscreen,function(b){var d=a.isEnabled();b&&!d?(a.enable(c[0]),c.addClass("isInFullScreen")):!b&&d&&(a.cancel(),c.removeClass("isInFullScreen"))});var e=a.$on("FBFullscreen.change",function(a,e){e||b.$evalAsync(function(){b.$eval(d.fullscreen+"= false"),c.removeClass("isInFullScreen")})});b.$on("$destroy",function(){e()})}else void 0===d.onlyWatchedProperty&&c.on("click",function(b){a.enable(c[0])})}}}]),b};"function"==typeof define&&define.amd?define("FBAngular",["angular"],function(a){return b(a)}):b(a.angular)}(window),!function(a,b,c,d){var e=a(b);a.fn.lazyload=function(f){function g(){var b=0;i.each(function(){var c=a(this);if(!j.skip_invisible||c.is(":visible"))if(a.abovethetop(this,j)||a.leftofbegin(this,j));else if(a.belowthefold(this,j)||a.rightoffold(this,j)){if(++b>j.failure_limit)return!1}else c.trigger("appear"),b=0})}var h,i=this,j={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return f&&(d!==f.failurelimit&&(f.failure_limit=f.failurelimit,delete f.failurelimit),d!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),a.extend(j,f)),h=j.container===d||j.container===b?e:a(j.container),0===j.event.indexOf("scroll")&&h.bind(j.event,function(){return g()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,(c.attr("src")===d||c.attr("src")===!1)&&c.is("img")&&c.attr("src",j.placeholder),c.one("appear",function(){if(!this.loaded){if(j.appear){var d=i.length;j.appear.call(b,d,j)}a("<img />").bind("load",function(){var d=c.attr("data-"+j.data_attribute);c.hide(),c.is("img")?c.attr("src",d):c.css("background-image","url('"+d+"')"),c[j.effect](j.effect_speed),b.loaded=!0;var e=a.grep(i,function(a){return!a.loaded});if(i=a(e),j.load){var f=i.length;j.load.call(b,f,j)}}).attr("src",c.attr("data-"+j.data_attribute))}}),0!==j.event.indexOf("scroll")&&c.bind(j.event,function(){b.loaded||c.trigger("appear")})}),e.bind("resize",function(){g()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent&&b.originalEvent.persisted&&i.each(function(){a(this).trigger("appear")})}),a(c).ready(function(){g()}),this},a.belowthefold=function(c,f){var g;return g=f.container===d||f.container===b?(b.innerHeight?b.innerHeight:e.height())+e.scrollTop():a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return g=f.container===d||f.container===b?e.width()+e.scrollLeft():a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollTop():a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollLeft():a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!(a.rightoffold(b,c)||a.leftofbegin(b,c)||a.belowthefold(b,c)||a.abovethetop(b,c))},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})}(jQuery,window,document),!function(a,b){"use strict";function c(b){b=a.extend({},q,b||{}),null===n&&(n=a("body"));for(var c=a(this),e=0,f=c.length;f>e;e++)d(c.eq(e),b);return c}function d(c,d){if(!c.hasClass(o.base)){d=a.extend({},d,c.data(m+"-options"));var h="";h+='<div class="'+o.bar+'">',h+='<div class="'+o.track+'">',h+='<div class="'+o.handle+'">',h+="</div></div></div>",d.paddingRight=parseInt(c.css("padding-right"),10),d.paddingBottom=parseInt(c.css("padding-bottom"),10),c.addClass([o.base,d.customClass].join(" ")).wrapInner('<div class="'+o.content+'" />').prepend(h),d.horizontal&&c.addClass(o.isHorizontal);var i=a.extend({$scroller:c,$content:c.find(l(o.content)),$bar:c.find(l(o.bar)),$track:c.find(l(o.track)),$handle:c.find(l(o.handle))},d);i.trackMargin=parseInt(i.trackMargin,10),i.$content.on("scroll."+m,i,e),i.$scroller.on(p.start,l(o.track),i,f).on(p.start,l(o.handle),i,g).data(m,i),r.reset.apply(c),a(b).one("load",function(){r.reset.apply(c)})}}function e(a){a.preventDefault(),a.stopPropagation();var b=a.data,c={};if(b.horizontal){var d=b.$content.scrollLeft();0>d&&(d=0);var e=d/b.scrollRatio;e>b.handleBounds.right&&(e=b.handleBounds.right),c={left:e}}else{var f=b.$content.scrollTop();0>f&&(f=0);var g=f/b.scrollRatio;g>b.handleBounds.bottom&&(g=b.handleBounds.bottom),c={top:g}}b.$handle.css(c)}function f(a){a.preventDefault(),a.stopPropagation();var b=a.data,c=a.originalEvent,d=b.$track.offset(),e="undefined"!=typeof c.targetTouches?c.targetTouches[0]:null,f=e?e.pageX:a.clientX,g=e?e.pageY:a.clientY;b.horizontal?(b.mouseStart=f,b.handleLeft=f-d.left-b.handleWidth/2,k(b,b.handleLeft)):(b.mouseStart=g,b.handleTop=g-d.top-b.handleHeight/2,k(b,b.handleTop)),h(b)}function g(a){a.preventDefault(),a.stopPropagation();var b=a.data,c=a.originalEvent,d="undefined"!=typeof c.targetTouches?c.targetTouches[0]:null,e=d?d.pageX:a.clientX,f=d?d.pageY:a.clientY;b.horizontal?(b.mouseStart=e,b.handleLeft=parseInt(b.$handle.css("left"),10)):(b.mouseStart=f,b.handleTop=parseInt(b.$handle.css("top"),10)),h(b)}function h(a){a.$content.off(l(m)),n.on(p.move,a,i).on(p.end,a,j)}function i(a){a.preventDefault(),a.stopPropagation();var b=a.data,c=a.originalEvent,d=0,e=0,f="undefined"!=typeof c.targetTouches?c.targetTouches[0]:null,g=f?f.pageX:a.clientX,h=f?f.pageY:a.clientY;b.horizontal?(e=b.mouseStart-g,d=b.handleLeft-e):(e=b.mouseStart-h,d=b.handleTop-e),k(b,d)}function j(a){a.preventDefault(),a.stopPropagation();var b=a.data;b.$content.on("scroll.scroller",b,e),n.off(".scroller")}function k(a,b){var c={};if(a.horizontal){b<a.handleBounds.left&&(b=a.handleBounds.left),b>a.handleBounds.right&&(b=a.handleBounds.right);var d=Math.round(b*a.scrollRatio);c={left:b},a.$content.scrollLeft(d)}else{b<a.handleBounds.top&&(b=a.handleBounds.top),b>a.handleBounds.bottom&&(b=a.handleBounds.bottom);var e=Math.round(b*a.scrollRatio);c={top:b},a.$content.scrollTop(e)}a.$handle.css(c)}function l(a){return"."+a}var m="scroller",n=null,o={base:"scroller",content:"scroller-content",bar:"scroller-bar",track:"scroller-track",handle:"scroller-handle",isHorizontal:"scroller-horizontal",isSetup:"scroller-setup",isActive:"scroller-active"},p={start:"touchstart."+m+" mousedown."+m,move:"touchmove."+m+" mousemove."+m,end:"touchend."+m+" mouseup."+m},q={customClass:"",duration:0,handleSize:0,horizontal:!1,trackMargin:0},r={defaults:function(b){return q=a.extend(q,b||{}),"object"==typeof this?a(this):!0},destroy:function(){return a(this).each(function(b,c){var d=a(c).data(m);d&&(d.$scroller.removeClass([d.customClass,o.base,o.isActive].join(" ")),d.$bar.remove(),d.$content.contents().unwrap(),d.$content.off(l(m)),d.$scroller.off(l(m)).removeData(m))})},scroll:function(b,c){return a(this).each(function(){var d=a(this).data(m),e=c||q.duration;if("number"!=typeof b){var f=a(b);if(f.length>0){var g=f.position();b=d.horizontal?g.left+d.$content.scrollLeft():g.top+d.$content.scrollTop()}else b=d.$content.scrollTop()}var h=d.horizontal?{scrollLeft:b}:{scrollTop:b};d.$content.stop().animate(h,e)})},reset:function(){return a(this).each(function(){var b=a(this).data(m);if(b){b.$scroller.addClass(o.isSetup);var c={},d={},e={},f=0,g=!0;if(b.horizontal){b.barHeight=b.$content[0].offsetHeight-b.$content[0].clientHeight,b.frameWidth=b.$content.outerWidth(),b.trackWidth=b.frameWidth-2*b.trackMargin,b.scrollWidth=b.$content[0].scrollWidth,b.ratio=b.trackWidth/b.scrollWidth,b.trackRatio=b.trackWidth/b.scrollWidth,b.handleWidth=b.handleSize>0?b.handleSize:b.trackWidth*b.trackRatio,b.scrollRatio=(b.scrollWidth-b.frameWidth)/(b.trackWidth-b.handleWidth),b.handleBounds={left:0,right:b.trackWidth-b.handleWidth},b.$content.css({paddingBottom:b.barHeight+b.paddingBottom});var h=b.$content.scrollLeft();f=h*b.ratio,g=b.scrollWidth<=b.frameWidth,c={width:b.frameWidth},d={width:b.trackWidth,marginLeft:b.trackMargin,marginRight:b.trackMargin},e={width:b.handleWidth}}else{b.barWidth=b.$content[0].offsetWidth-b.$content[0].clientWidth,b.frameHeight=b.$content.outerHeight(),b.trackHeight=b.frameHeight-2*b.trackMargin,b.scrollHeight=b.$content[0].scrollHeight,b.ratio=b.trackHeight/b.scrollHeight,b.trackRatio=b.trackHeight/b.scrollHeight,b.handleHeight=b.handleSize>0?b.handleSize:b.trackHeight*b.trackRatio,b.scrollRatio=(b.scrollHeight-b.frameHeight)/(b.trackHeight-b.handleHeight),b.handleBounds={top:0,bottom:b.trackHeight-b.handleHeight};var i=b.$content.scrollTop();f=i*b.ratio,g=b.scrollHeight<=b.frameHeight,c={height:b.frameHeight},d={height:b.trackHeight,marginBottom:b.trackMargin,marginTop:b.trackMargin},e={height:b.handleHeight}}g?b.$scroller.removeClass(o.isActive):b.$scroller.addClass(o.isActive),b.$bar.css(c),b.$track.css(d),b.$handle.css(e),k(b,f),b.$scroller.removeClass(o.isSetup)}})}};a.fn[m]=function(a){return r[a]?r[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:c.apply(this,arguments)},a[m]=function(a){"defaults"===a&&r.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery),function(){var a=1===angular.version.major&&0===angular.version.minor;angular.module("ui-rangeSlider",[]).directive("rangeSlider",["$document","$filter","$log",function(b,c,d){var e=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup",over:"pointerdown",out:"mouseout"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",over:"MSPointerDown",out:"mouseout"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend",over:"mouseover touchstart",out:"mouseout"},f=e.start+".rangeSlider",g=e.move+".rangeSlider",h=e.end+".rangeSlider",i=e.over+".rangeSlider",j=e.out+".rangeSlider",k=function(a){try{return[a.clientX||a.originalEvent.clientX||a.originalEvent.touches[0].clientX,a.clientY||a.originalEvent.clientY||a.originalEvent.touches[0].clientY]}catch(b){return["x","y"]}},l=function(a){return 0>a?0:a>100?100:a},m=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},e={disabled:"=?",min:"=",max:"=",modelMin:"=?",modelMax:"=?",onHandleDown:"&",onHandleUp:"&",orientation:"@",step:"@",decimalPlaces:"@",filter:"@",filterOptions:"@",showValues:"@",pinHandle:"@",preventEqualMinMax:"@",attachHandleValues:"@",getterSetter:"@"};return a&&(e.disabled="=",e.modelMin="=",e.modelMax="="),{restrict:"A",replace:!0,template:'<div class="ngrs-range-slider"><div class="ngrs-runner"><div class="ngrs-handle ngrs-handle-min"><i></i></div><div class="ngrs-handle ngrs-handle-max"><i></i></div><div class="ngrs-join"></div></div><div class="ngrs-value-runner"><div class="ngrs-value ngrs-value-min" ng-show="showValues"><div>{{filteredModelMin}}</div></div><div class="ngrs-value ngrs-value-max" ng-show="showValues"><div>{{filteredModelMax}}</div></div></div></div>',scope:e,link:function(a,e,n,o){function p(b){return a.getterSetter?arguments.length?a.modelMin(b):a.modelMin():arguments.length?a.modelMin=b:a.modelMin}function q(b){return a.getterSetter?arguments.length?a.modelMax(b):a.modelMax():arguments.length?a.modelMax=b:a.modelMax}function r(a){"min"===a?(angular.element(y[0]).css("display","none"),angular.element(y[1]).css("display","block")):"max"===a?(angular.element(y[0]).css("display","block"),angular.element(y[1]).css("display","none")):(angular.element(y[0]).css("display","block"),angular.element(y[1]).css("display","block"))}function s(a){a?x.addClass("ngrs-disabled"):x.removeClass("ngrs-disabled")}function t(){a.min>a.max&&w("min must be less than or equal to max"),angular.isDefined(a.min)&&angular.isDefined(a.max)&&(m(a.min)||w("min must be a number"),m(a.max)||w("max must be a number"),E=a.max-a.min,u())}function u(){if(p()>q()&&(d.warn("modelMin must be less than or equal to modelMax"),p(q())),(angular.isDefined(p())||"min"===a.pinHandle)&&(angular.isDefined(q())||"max"===a.pinHandle)){m(p())||("min"!==a.pinHandle&&d.warn("modelMin must be a number"),p(a.min)),m(q())||("max"!==a.pinHandle&&d.warn("modelMax must be a number"),q(a.max));var b,e,f=l((p()-a.min)/E*100),g=l((q()-a.min)/E*100);if(a.attachHandleValues&&(b=f,e=g),p(Math.max(a.min,p())),q(Math.min(a.max,q())),a.filter&&a.filterOptions)a.filteredModelMin=c(a.filter)(p(),a.filterOptions),a.filteredModelMax=c(a.filter)(q(),a.filterOptions);else if(a.filter){var h=a.filter.split(":"),i=a.filter.split(":")[0],j=h.slice().slice(1),j=j.map(function(a){return m(a)?+a:'"'==a[0]&&'"'==a[a.length-1]||"'"==a[0]&&"'"==a[a.length-1]?a.slice(1,-1):void 0}),h=j.slice(),j=j.slice();h.unshift(p()),j.unshift(q()),a.filteredModelMin=c(i).apply(null,h),a.filteredModelMax=c(i).apply(null,j)}else a.filteredModelMin=p(),a.filteredModelMax=q();a.min===a.max&&p()==q()?(angular.element(y[0]).css(B,"0%"),angular.element(y[1]).css(B,"100%"),a.attachHandleValues&&(angular.element(z[0]).css(B,"0%"),angular.element(z[1]).css(B,"100%")),angular.element(A).css(B,"0%").css(C,"0%")):(angular.element(y[0]).css(B,f+"%"),angular.element(y[1]).css(B,g+"%"),a.attachHandleValues&&(angular.element(z[0]).css(B,b+"%"),angular.element(z[1]).css(B,e+"%"),angular.element(z[1]).css(C,"auto")),angular.element(A).css(B,f+"%").css(C,100-g+"%"),f>95&&angular.element(y[0]).css("z-index",3))}}function v(c){var d=y[c];d.bind(f+"X",function(e){var f=(0===c?"ngrs-handle-min":"ngrs-handle-max")+"-down",i=((0===c?p():q())-a.min)/E*100,j=k(e),m=j,n=!1;angular.isFunction(a.onHandleDown)&&a.onHandleDown(),angular.element("body").bind("selectstart.rangeSlider",function(){return!1}),a.disabled||(F=!0,d.addClass("ngrs-down"),x.addClass("ngrs-focus "+f),angular.element("body").addClass("ngrs-touching"),b.bind(g,function(b){b.preventDefault(),b=k(b);var e,f,g=a.step/E*100,h=((0===c?q():p())-a.min)/E*100;"x"!==b[0]&&(b[0]-=j[0],b[1]-=j[1],e=[m[0]!==b[0],m[1]!==b[1]],f=i+100*b[D]/(D?x.height():x.width()),f=l(f),a.preventEqualMinMax&&(0===g&&(g=1/E*100),0===c?h-=g:1===c&&(h+=g)),0===c?f=f>h?h:f:1===c&&(f=h>f?h:f),0<a.step&&100>f&&f>0&&(f=Math.round(f/g)*g),f>95&&0===c?d.css("z-index",3):d.css("z-index",""),e[D]&&f!=n&&(0===c?p(parseFloat(parseFloat(f*E/100+a.min).toFixed(a.decimalPlaces))):1===c&&q(parseFloat(parseFloat(f*E/100+a.min).toFixed(a.decimalPlaces))),a.$apply(),n=f),m=b)}).bind(h,function(){angular.isFunction(a.onHandleUp)&&a.onHandleUp(),b.off(g),b.off(h),angular.element("body").removeClass("ngrs-touching"),F=!1,d.removeClass("ngrs-down"),d.removeClass("ngrs-over"),x.removeClass("ngrs-focus "+f)}))}).on(i,function(){d.addClass("ngrs-over")}).on(j,function(){F||d.removeClass("ngrs-over")})}function w(b){throw a.disabled=!0,Error("RangeSlider: "+b)}var x=angular.element(e),y=[e.find(".ngrs-handle-min"),e.find(".ngrs-handle-max")],z=[e.find(".ngrs-value-min"),e.find(".ngrs-value-max")],A=e.find(".ngrs-join"),B="left",C="right",D=0,E=0,F=!1;a.filteredModelMin=p(),a.filteredModelMax=q(),n.$observe("disabled",function(b){angular.isDefined(b)||(a.disabled=!1),a.$watch("disabled",s)}),n.$observe("orientation",function(b){angular.isDefined(b)||(a.orientation="horizontal"),b=a.orientation.split(" ");for(var c=0,d=b.length;d>c;c++)b[c]="ngrs-"+b[c];b=b.join(" "),x.addClass(b),("vertical"===a.orientation||"vertical left"===a.orientation||"vertical right"===a.orientation)&&(B="top",C="bottom",D=1)}),n.$observe("step",function(b){angular.isDefined(b)||(a.step=0)}),n.$observe("decimalPlaces",function(b){angular.isDefined(b)||(a.decimalPlaces=0)}),n.$observe("showValues",function(b){angular.isDefined(b)?a.showValues="false"===b?!1:!0:a.showValues=!0}),n.$observe("pinHandle",function(b){angular.isDefined(b)?a.pinHandle="min"===b||"max"===b?b:null:a.pinHandle=null,a.$watch("pinHandle",r)}),n.$observe("preventEqualMinMax",function(b){angular.isDefined(b)?a.preventEqualMinMax="false"===b?!1:!0:a.preventEqualMinMax=!1}),n.$observe("attachHandleValues",function(b){angular.isDefined(b)&&("true"===b||""===b)?(a.attachHandleValues=!0,e.find(".ngrs-value-runner").addClass("ngrs-attached-handles")):a.attachHandleValues=!1}),a.$watch("min",t),a.$watch("max",t),a.$watch(function(){return p()},u),a.$watch(function(){return q()},u),a.$on("$destroy",function(){x.off(".rangeSlider"),angular.element("body").off(".rangeSlider"),b.off(".rangeSlider");for(var a=0,c=y.length;c>a;a++)y[a].off(".rangeSlider"),y[a].off(".rangeSliderX")}),x.bind("selectstart.rangeSlider",function(a){return!1}).bind("click",function(a){a.stopPropagation()}),v(0),v(1)}}}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}()}(),directoryPrefix="/blake",angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(a,b,c,d){}]).directive("carousel",[function(){return{}}]),angular.module("blake",["ngRoute","ngSanitize","ui-rangeSlider","ui.bootstrap","ng-sortable","FBAngular","ngAnimate"]).config(["$routeProvider","$locationProvider",function(a,b){a.when(directoryPrefix+"/",{templateUrl:directoryPrefix+"/static/html/home.html",controller:"HomeController"}),a.when(directoryPrefix+"/object/:objectId",{templateUrl:directoryPrefix+"/static/html/object.html",controller:"ObjectController"}),a.when(directoryPrefix+"/copy/:copyId",{templateUrl:directoryPrefix+"/static/html/copy.html",controller:"CopyController"}),a.when(directoryPrefix+"/copy/:copyId/:objectId",{templateUrl:directoryPrefix+"/static/html/copy.html",controller:"CopyController"}),a.when(directoryPrefix+"/work/:workId",{templateUrl:directoryPrefix+"/static/html/work.html",controller:"WorkController"}),a.when(directoryPrefix+"/compare/",{templateUrl:directoryPrefix+"/static/html/compare.html"}),a.when(directoryPrefix+"/search/",{templateUrl:directoryPrefix+"/static/html/search.html",controller:"SearchController"}),a.otherwise({redirectTo:directoryPrefix+"/"}),b.html5Mode(!0)}]),angular.module("blake").factory("GenericService",function(){return function(a){return{create:function(b){var c,d;if(b.length)for(d=[],c=0;c<b.length;c++)d.push(a(b[c]));else d=a(b);return d}}}}),angular.module("blake").factory("BlakeObject",["GenericService",function(a){var b=function(a){var b=angular.copy(a);return b.illustration_description=angular.fromJson(a.illustration_description),b.characteristics=angular.fromJson(a.characteristics),b.text=angular.fromJson(a.text),b.header=angular.fromJson(a.header),b.source=angular.fromJson(a.source),b};return a(b)}]),angular.module("blake").factory("BlakeCopy",["BlakeObject","GenericService",function(a,b){var c=function(b){var c,d=angular.copy(b);if(d.header=angular.fromJson(b.header),d.source=angular.fromJson(b.source),b.objects)for(c=0;c<b.objects.length;c++)d.objects.push(a.create(b.objects[c]));return d};return b(c)}]),angular.module("blake").factory("BlakeWork",["BlakeCopy","GenericService",function(a,b){var c=function(b){var c,d=angular.copy(b);if(b.copies)for(c=0;c<b.copies.length;c++)d.copies.push(a.create(b.copies[c]));return d};return b(c)}]),angular.module("blake").factory("BlakeFeaturedWork",["GenericService",function(a){var b=function(a){return angular.copy(a)};return a(b)}]),angular.module("blake").factory("BlakeDataService",["$http","$q","$rootScope","BlakeWork","BlakeCopy","BlakeObject","BlakeFeaturedWork",function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=[],G=!1,H=!1,I=!1;return m=function(c){var d=directoryPrefix+"/api/query_objects";return b(function(b,e){a.post(d,c).success(function(a){b(a)}).error(function(a,b){e(a,b)})})},n=function(c){var d=directoryPrefix+"/api/object/"+c;return b(function(b,c){a.get(d).success(function(a){b(f.create(a))}).error(function(a,b){c(a,b)})})},E=function(){H=!1,I=!1,G=!1,c.$broadcast("objectSelectionChange")},o=function(c){var d=directoryPrefix+"/api/object/"+c+"/objects_with_same_motif";return b(function(b,c){a.get(d).success(function(a){a.results.length&&(G=!0),b(f.create(a.results))}).error(function(a,b){c(a,b)})})},p=function(c){var d=directoryPrefix+"/api/object/"+c+"/objects_from_same_matrix";return b(function(b,c){a.get(d).success(function(a){a.results.length&&(H=!0),b(f.create(a.results))}).error(function(a,b){c(a,b)})})},q=function(c){var d=directoryPrefix+"/api/object/"+c+"/objects_from_same_production_sequence";return b(function(b,c){a.get(d).success(function(a){a.results.length&&(I=!0),b(f.create(a.results))}).error(function(a,b){c(a,b)})})},r=function(c){var d=directoryPrefix+"/api/copy/"+c;return b(function(b,c){a.get(d).success(function(a){b(e.create(a))}).error(function(a,b){c(a,b)})})},s=function(c){var d=directoryPrefix+"/api/copy/"+c+"/objects";return b(function(b,c){a.get(d).success(function(a){b(f.create(a.results))}).error(function(a,b){c(a,b)})})},t=function(c){var e=directoryPrefix+"/api/work/"+c;return b(function(b,c){a.get(e).success(function(a){b(d.create(a))}).error(function(a,b){c(a,b)})})},u=function(){var c=directoryPrefix+"/api/work/";return b(function(b,e){a.get(c).success(function(a){b(d.create(a.results))}).error(function(a,b){e(a,b)})})},v=function(c){var d=directoryPrefix+"/api/work/"+c+"/copies";return b(function(b,c){a.get(d).success(function(a){b(e.create(a.results))}).error(function(a,b){c(a,b)})})},w=function(){var c=directoryPrefix+"/api/featured_work/";return b(function(b,d){a.get(c).success(function(a){b(g.create(a.results))}).error(function(a,b){d(a,b)})})},x=function(a){return t(a).then(function(b){h=b,c.$broadcast("workSelectionChange",b),v(a).then(function(a){k=a,c.$broadcast("workSelectionCopiesChange")})})},y=function(a,b){return r(a).then(function(d){i=d,c.$broadcast("copySelectionChange",d),s(a).then(function(a){l=a,b?a.forEach(function(a){a.object_id==b&&(j=a)}):j=a[0],c.$broadcast("copySelectionObjectsChange"),E()})})},z=function(a){return n(a).then(function(a){j=a,C(),A(a),E()})},A=function(a){var b,d=!1;for(b=F.length;b--;)if(F[b].object_id==a.object_id){d=!0;break}d||(F.push(a),c.$broadcast("comparisonObjectsChange"))},B=function(a){var b;for(b=F.length;b--;)if(F[b].object_id==a.object_id){F.splice(b,1),c.$broadcast("comparisonObjectsChange");break}},C=function(){F=[],c.$broadcast("comparisonObjectsChange")},D=function(a){for(var b=F.length;b--;)if(F[b].object_id==a.object_id)return!0;return!1},{queryObjects:m,getObject:n,getObjectsWithSameMotif:o,hasObjectsWithSameMotif:function(){return G},getObjectsFromSameMatrix:p,hasObjectsFromSameMatrix:function(){return H},getObjectsFromSameProductionSequence:q,hasObjectsFromSameProductionSequence:function(){return I},getCopy:r,getObjectsForCopy:s,getWork:t,getWorks:u,getCopiesForWork:v,getFeaturedWorks:w,setSelectedWork:x,setSelectedCopy:y,setSelectedObject:z,getSelectedWork:function(){return h},getSelectedCopy:function(){return i},getSelectedObject:function(){return j},getSelectedWorkCopies:function(){return k},getSelectedCopyObjects:function(){return l},addComparisonObject:A,removeComparisonObject:B,clearComparisonObjects:C,getComparisonObjects:function(){return F},isComparisonObject:D}}]),angular.module("blake").factory("MockBlakeDataService",["$http","$q","BlakeWork","BlakeCopy","BlakeObject","BlakeFeaturedWork",function(a,b,c,d,e,f){var g=function(){return b(function(b,c){a.get(directoryPrefix+"/static/json/objects.json").success(function(a){b(e.create(a))}).error(function(a,b){c(a,b)})})},h=function(){return b(function(b,c){a.get(directoryPrefix+"/static/json/objects.json").success(function(a){b(e.create(a[0]))}).error(function(a,b){c(a,b)})})},i=function(){return b(function(b,c){a.get(directoryPrefix+"/static/json/copies.json").success(function(a){b(d.create(a))}).error(function(a,b){c(a,b)})})},j=function(){return b(function(b,c){a.get(directoryPrefix+"/static/json/copies.json").success(function(a){b(d.create(a[0]))}).error(function(a,b){c(a,b)})})},k=function(){return b(function(b,d){a.get(directoryPrefix+"/static/json/works.json").success(function(a){b(c.create(a))}).error(function(a,b){d(a,b)})})},l=function(){return b(function(b,d){a.get(directoryPrefix+"/static/json/works.json").success(function(a){b(c.create(a[0]))}).error(function(a,b){d(a,b)})})},m=function(){return b(function(b,c){a.get(directoryPrefix+"/static/json/featured_works.json").success(function(a){b(f.create(a))}).error(function(a,b){c(a,b)})})};return{query:function(a){return g()},getObject:function(a){return h()},getObjectsWithSameMotif:function(a){return g()},getObjectsFromSameMatrix:function(a){return g()},getObjectsFromSameProductionSequence:function(a){return g()},getCopy:function(a){return j()},getObjectsForCopy:function(a){return g()},getWork:function(a){return l()},getWorks:function(){return k()},getCopiesForWork:function(a){return i()},getFeaturedWorks:function(){return m()}}}]),angular.module("blake").factory("FormatService",function(){var a=function(a){return/\s+copy\s+/.test(a)?a.replace(/copy/,"Copy"):!1};return{cap:function(){return a()}}}),angular.module("blake").factory("UtilityServices",function(){var a=function(){var a={};return a.waitForIdle=function(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}},a},b=function(a){var b=a.height(),c=$(".panel-group .panel-default").length,d=b-47*c;$(".panel-group").css("min-height",b+"px"),$(".panel-group .panel-body").css("max-height",d+"px")},c=function(c,d){angular.element(document).ready(function(){d(function(){var c=a(),d=$("#object-view");$("#object-detail-tray").length&&(b(d),d.resize(c.waitForIdle(function(){b(d)},10)))},c)})},d=function(){var a=$("#object-container");a.hasClass("tray-closed")?(a.removeClass("tray-closed").addClass("tray-open"),setTimeout(function(){$(".scrollbar").scroller("reset")},300),$(".scrollbar").scroller("reset")):(a.removeClass("tray-open").addClass("tray-closed"),$(".scrollbar").scroller("reset"),setTimeout(function(){$(".scrollbar").scroller("reset")},300))},e=function(a,b){return a.obj.text.lg.forEach(function(a){a.l.length?a.l.forEach(function(a){b.push(a["#text"])}):b.push(a.l["#text"])}),b},f=function(){var a=$(window).innerHeight(),b=Math.round(.35*a);return a-b},g=function(a,b){var c=$(".panel-group .panel-body");if(a.isEnabled())a.cancel();else{var d=c.css("max-height");localStorage.setItem("panel-height",d),a.enable(document.getElementById(b));var e=$(window).innerWidth(),f=Math.round(.3*e);c.css({"max-height":e-f+"px"})}},h=function(a){function b(){if(!a.isEnabled()){var b=localStorage.getItem("panel-height");localStorage.removeItem("panel-height"),$(".panel-group .panel-body").css("max-height",b)}}document.addEventListener&&(document.addEventListener("webkitfullscreenchange",b,!1),document.addEventListener("mozfullscreenchange",b,!1),document.addEventListener("fullscreenchange",b,!1),document.addEventListener("MSFullscreenChange",b,!1))};return{responseChange:a,trayHeight:b,getImageHeight:c,togglingTray:d,imageText:e,imageViewerHeight:f,fullScreen:g,resetPanelFromFullscreen:h}}),angular.module("blake").controller("HomeController",["$rootScope","$scope","BlakeDataService",function(a,b,c){a.showSubMenu=0,c.getFeaturedWorks().then(function(c){var d=0,e=1;angular.forEach(c,function(a){a.column=e,++d,4==d&&(++e,d=0)}),b.featured_works=c,a.homePageOverride=!0})}]),angular.module("blake").controller("WorkController",["$scope","$routeParams","BlakeDataService",function(a,b,c){c.setSelectedWork(b.workId)}]),angular.module("blake").controller("ObjectController",["$scope","$routeParams","BlakeDataService",function(a,b,c){c.setSelectedWork($routeParams.objectId)}]),angular.module("blake").controller("CopyController",["$scope","$routeParams","BlakeDataService",function(a,b,c){c.setSelectedCopy(b.copyId,b.objectId).then(function(a){c.setSelectedWork(c.getSelectedCopy().bad_id)})}]),angular.module("blake").controller("SearchController",["$rootScope","$scope","$location","$routeParams","BlakeDataService",function(a,b,c,d,e){
var f,g;a.showSubMenu=0,b.search=function(){e.queryObjects(b.searchConfig).then(function(a){b.results=a})},b.loadSearchPage=function(){c.url(directoryPrefix+"/search?search="+encodeURIComponent(b.searchText))},b.searchConfig={useCompDate:!0,searchTitle:!0,searchIlluminatedBooks:!0,searchCommercialBookIllustrations:!0,searchSeparatePrints:!0,searchDrawingsPaintings:!0,searchManuscripts:!0,searchRelatedMaterials:!0,minDate:1772,maxDate:1827},f=function(a){return b.searchConfig.searchIlluminatedBooks&&"illbk"==a.work_medium?!0:(!b.searchConfig.searchCommercialBookIllustrations||"comb"!=a.work_medium&&"comdes"!=a.work_medium&&"comeng"!=a.work_medium)&&(!b.searchConfig.searchSeparatePrints||"spb"!=a.work_medium&&"spdes"!=a.work_medium&&"speng"!=a.work_medium)&&!(b.searchConfig.searchCommercialBookIllustrations&&("comb"==a.work_medium||"comdes"==a.work_medium||"comeng"==a.work_medium)||b.searchConfig.searchDrawingsPaintings&&("cprint"==a.work_medium||"penc"==a.work_medium||"penink"==a.work_medium||"mono"==a.work_medium||"wc"==a.work_medium||"paint"==a.work_medium)||b.searchConfig.searchManuscripts&&("ms"==a.work_medium||"ltr"==a.work_medium||"te"==a.work_medium)||b.searchConfig.searchRelatedMaterials&&("rmb"==a.work_medium||"rmoth"==a.work_medium))?!1:!0},g=function(a){return b.searchConfig.searchIlluminatedBooks&&"illbk"==a.medium?!0:(!b.searchConfig.searchCommercialBookIllustrations||"comb"!=a.medium&&"comdes"!=a.medium&&"comeng"!=a.medium)&&(!b.searchConfig.searchSeparatePrints||"spb"!=a.medium&&"spdes"!=a.medium&&"speng"!=a.medium)&&!(b.searchConfig.searchCommercialBookIllustrations&&("comb"==a.medium||"comdes"==a.medium||"comeng"==a.medium)||b.searchConfig.searchDrawingsPaintings&&("cprint"==a.medium||"penc"==a.medium||"penink"==a.medium||"mono"==a.medium||"wc"==a.medium||"paint"==a.medium)||b.searchConfig.searchManuscripts&&("ms"==a.medium||"ltr"==a.medium||"te"==a.medium)||b.searchConfig.searchRelatedMaterials&&("rmb"==a.medium||"rmoth"==a.medium))?!1:!0},b.objectResultsMatchingFilter=function(a){var c,d,e=[];if(b.results)for(d=b.results.object_results[a],c=0;c<d.length;c++)d[c].copy_composition_date>=b.searchConfig.minDate&&d[c].copy_composition_date<=b.searchConfig.maxDate&&f(d[c])&&e.push(d[c]);return e},b.workResultsMatchingFilter=function(a){var c,d,e=[];if(b.results)for(d=b.results.work_results[a],c=0;c<d.length;c++)d[c].composition_date>=b.searchConfig.minDate&&d[c].composition_date<=b.searchConfig.maxDate&&g(d[c])&&e.push(d[c]);return e},d.search&&(b.searchConfig.searchString=d.search,b.search()),b.showWorks=!0,b.showCopies=!0,b.showObjects=!0}]),function(a){"use strict";a(function(){function b(){var b=d.height()-220;a("#object-view .carousel .featured-object img").css("height",b+"px")}function c(){var b=d.scrollTop();a("#scroll-wrapper1").css("margin-top",-90-.2*b+"px"),a("#scroll-wrapper2").css("margin-top",-20-.4*b+"px"),a("#scroll-wrapper3").css("margin-top",-90-.14*b+"px"),a("#scroll-wrapper4").css("margin-top",-20-.4*b+"px"),a("#scroll-wrapper5").css("margin-top",-90-.5*b+"px"),a("#scroll-wrapper6").css("margin-top",-20-.3*b+"px")}var d=a(window),e={};e.waitForIdle=function(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}},d.on("resize",e.waitForIdle(function(){if(a("nav.navbar ul.navbar-nav li.dropdown").hasClass("open")){var b=d.width(),c=a("nav.navbar ul.navbar-nav li.dropdown.open").offset().left;a("nav.navbar ul.navbar-nav li.dropdown.open").find("ul.dropdown-menu").css({width:b+"px",left:"-"+c+"px"})}},100));var f=a("button.collapse-archive"),g=a("nav.navbar");"true"!==localStorage.getItem("archive_menu_dismissed")?(f.addClass("menu-closed").removeClass("menu-open"),g.addClass("menu-closed").removeClass("menu-open")):(g.addClass("menu-open").removeClass("menu-closed"),f.addClass("menu-open").removeClass("menu-closed")),f.on("click",function(){g.hasClass("menu-open")?(g.removeClass("menu-open").addClass("menu-closed"),f.removeClass("menu-open").addClass("menu-closed"),localStorage.setItem("archive_menu_dismissed","false")):(g.addClass("menu-open").removeClass("menu-closed"),f.addClass("menu-open").removeClass("menu-closed"),localStorage.setItem("archive_menu_dismissed","true"))}),a("#object-view .carousel").length&&(b(),d.on("resize",e.waitForIdle(function(){b()},100))),a(".scrollbar").scroller({customClass:"advanced",trackMargin:10,horizontal:!0}),a(window).on("resize",e.waitForIdle(function(){a(".scrollbar").scroller("reset")},100));var h=a(".back-top");h.length&&(h.on("click",function(){a("html, body").animate({scrollTop:0},"slow")}),d.on("scroll",function(){var a=d.scrollTop();a>=50?h.addClass("scrolling"):h.removeClass("scrolling")})),c();var i=a("body.home");i.length&&d.bind("scroll",function(a){c()}),i.length&&a(function(){a("img.lazy-load").lazyload({threshold:100})})})}(this.jQuery),angular.module("blake").directive("objectsForCopy",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-for-copy/template.html",controller:"ObjectsForCopyController"}}),angular.module("blake").controller("ObjectsForCopyController",["$scope",function(a){}]),angular.module("blake").directive("copiesForWork",function(){return{restrict:"E",templateUrl:"/blake/static/directives/copies-for-work/template.html",controller:"CopiesForWorkController"}}),angular.module("blake").controller("CopiesForWorkController",["$scope","BlakeDataService",function(a,b){a.getCopyFirstObject=function(b){function c(a){switch(a){case"comb":return"com";case"comdes":return"com";case"comeng":return"com";case"spb":return"sp";case"spdes":return"sp";case"speng":return"sp";case"cprint":return"cpd";case"mono":return"wd";case"paint":return"pt";case"pen":return"pid";case"penink":return"pid";case"penc":return"pid";case"wc":return"wc";case"ms":return"ms";case"ltr":return"lt";case"te":return"typ";default:return!1}}return a.work?"illbk"==a.work.medium?"http://www.blakearchive.org/blake/images/"+b.bad_id+".p1.100.jpg":"http://www.blakearchive.org/blake/images/"+b.bad_id+".1."+c(a.work.medium)+".100.jpg":void 0};var c=function(a){switch(a){case"illbk":return"Illuminated Books";case"comb":case"comdes":case"comeng":return"Commercial Book Illustrations";case"spb":case"spdes":case"speng":case"cprint":return"Prints";case"mono":case"paint":case"pen":case"penink":case"penc":case"wc":return"Drawings and Paintings";case"ms":case"ltr":case"te":return"Manuscripts and Typographic Works";default:return!1}};a.$on("workSelectionChange",function(){a.work=b.getSelectedWork(),a.work.medium_pretty=c(a.work.medium)}),a.$on("workSelectionCopiesChange",function(){var c=b.getSelectedWorkCopies();c.sort(function(a,b){return a.source.objdescid.compdate["@value"]-b.source.objdescid.compdate["@value"]}),a.copies=c})}]),angular.module("blake").directive("viewSubMenu",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/view-sub-menu/template.html",controller:"viewSubMenuController"}}),angular.module("blake").controller("viewSubMenuController",["$scope",function(a){}]),angular.module("blake").directive("navigationMenu",function(){function a(a,b,c){var d=function(a){switch(a){case"illbk":return"illuminated_books";case"comb":return"book_illustration:designed_engraved";case"comdes":return"book_illustration:designed";case"comeng":return"book_illustration:engraved";case"spb":return"prints:designed_engraved";case"spdes":return"prints:designed";case"speng":return"prints:engraved";case"cprint":return"prints:drawings";case"mono":return"drawings_paintings:monochrome";case"paint":return"drawings_paintings:paintings";case"pen":case"penink":return"drawings_paintings:pen";case"penc":return"drawings_paintings:pencil";case"wc":return"drawings_paintings:wc";case"ms":return"manuscripts_typo:manuscripts";case"ltr":return"manuscripts_typo:letters";case"te":return"manuscripts_typo:typographic";default:return!1}};a.organizeMenus=function(b){if(b){b.sort(function(a,b){return a.composition_date-b.composition_date});var c={illuminated_books:[],book_illustration:[{designed_engraved:[],designed:[],engraved:[]}],prints:[{designed_engraved:[],designed:[],engraved:[],drawings:[]}],drawings_paintings:[{pencil:[],pen:[],monochrome:[],wc:[],paintings:[]}],manuscripts_typo:[{manuscripts:[],letters:[],typographic:[]}]};b.forEach(function(a){var b,e=d(a.medium);e&&(b=e.split(/:/),(void 0!==c[b[0]]||void 0!==c[b[0]][0][b[1]])&&(1===b.length?c[b[0]].push(a):c[b[0]][0][b[1]].push(a)))}),a.menu_lists=c}}}return{restrict:"E",link:a,controller:"MenuController",templateUrl:"/blake/static/directives/menu/template.html"}}),angular.module("blake").controller("MenuController",["$scope","BlakeDataService",function(a,b){$("nav.navbar ul.navbar-nav > li.dropdown").click(function(){var a=$(window).width(),b=$(this).offset().left;$(this).find("ul.dropdown-menu").css({width:a+"px",left:"-"+b+"px"})}),b.getWorks().then(function(b){a.organizeMenus(b)})}]),angular.module("blake").directive("copyInformation",function(){return{restrict:"E",templateUrl:"/blake/static/directives/copy-information/template.html",controller:"CopyInformationController"}}),angular.module("blake").controller("CopyInformationController",["$scope","BlakeDataService",function(a,b){a.copy=b.getSelectedCopy(),a.$on("copySelectionChange",function(){a.copy=b.getSelectedCopy()}),a.$on("objectSelectionChange",function(){var c=b.getSelectedObject(),d=b.getSelectedCopy();d.source&&d.header?(a.copySource=d.source,a.copyHeader=d.header):(a.copySource=c.source,a.copyHeader=c.header)}),a.getOriginationRole=function(a){if(a){if(a.join){var b=[];return a.forEach(function(a){b.push(a["#text"])}),b.join(" ")}return a["#text"]}}}]),angular.module("blake").directive("objectViewer",function(){return{restrict:"E",templateUrl:"/blake/static/directives/object-viewer/template.html",controller:"ObjectViewerController"}}),angular.module("blake").controller("ObjectViewerController",["$rootScope","$scope","$timeout","Fullscreen","BlakeDataService","UtilityServices",function(a,b,c,d,e,f){a.showSubMenu=1,b.BlakeDataService=e,b.getPreviousNextObjects=function(){if(b.objects&&b.objects.length)for(var a=b.objects.length;a--;)if(b.objects[a].object_id==b.obj.object_id){0>a-1?b.previousObject=b.objects[b.objects.length-1]:b.previousObject=b.objects[a-1],a+1>=b.objects.length?b.nextObject=b.objects[0]:b.nextObject=b.objects[a+1];break}},b.getObjLines=function(){var a=[];return b.obj&&b.obj.text&&b.obj.text.lg&&b.obj.text.lg.length&&(a=f.imageText(b,a)),a},b.toggleTray=f.togglingTray,b.openWindow=function(a){a.target.innerHTML;window.open("http://www.blakearchive.org/blake/")},b.goFullscreen=function(a){f.fullScreen(d,a)},f.resetPanelFromFullscreen(d),b.viewerHeight=f.imageViewerHeight()+"px",b.imageHeight=b.viewerHeight.split("px")[0]-50+"px",b.copy=e.getSelectedCopy(),b.objects=e.getSelectedCopyObjects(),b.obj=e.getSelectedObject(),b.copy&&!b.work?e.setSelectedWork(b.copy.bad_id):b.work=e.getSelectedWork(),b.getPreviousNextObjects(),b.$on("copySelectionChange",function(){b.copy=e.getSelectedCopy(),f.getImageHeight(100,c)}),b.$on("copySelectionObjectsChange",function(){b.objects=e.getSelectedCopyObjects(),f.getImageHeight(100,c)}),b.$on("objectSelectionChange",function(){b.obj=e.getSelectedObject(),b.getPreviousNextObjects(),f.getImageHeight(100,c)}),b.$on("workSelectionChange",function(){b.work=e.getSelectedWork()})}]),angular.module("blake").directive("objectsFromSameMatrix",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-from-same-matrix/template.html",controller:"ObjectsFromSameMatrixController"}}),angular.module("blake").controller("ObjectsFromSameMatrixController",["$scope","BlakeDataService",function(a,b){a.BlakeDataService=b,a.$on("objectSelectionChange",function(){var c=b.getSelectedObject();c&&(a.item=c,b.getObjectsFromSameMatrix(c.object_id).then(function(b){a.objects=b}))}),a.compareText="Select All Objects",a.selectedAll=!1,b.clearComparisonObjects(),a.selectAll=function(){var c=a.objects.length;if(b.clearComparisonObjects(),a.selectedAll){a.compareText="Select All Objects",a.selectedAll=!1;for(var d=c;d--;)a.objects[d].Selected=!1;b.clearComparisonObjects()}else{a.compareText="Clear All Objects",a.selectedAll=!0,b.addComparisonObject(a.item);for(var e=c;e--;)a.objects[e].Selected=!0,b.addComparisonObject(a.objects[e])}},a.selectOne=function(c){c.Selected?(c.Selected=!0,b.addComparisonObject(c)):(c.Selected=!1,b.removeComparisonObject(c)),b.getComparisonObjects&&b.addComparisonObject(a.item)}}]),angular.module("blake").directive("objectsFromSameProductionSequence",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-from-same-production-sequence/template.html",controller:"ObjectsFromSameProductionSequenceController"}}),angular.module("blake").controller("ObjectsFromSameProductionSequenceController",["$scope","BlakeDataService",function(a,b){a.BlakeDataService=b,a.$on("objectSelectionChange",function(){var c=b.getSelectedObject();c&&(a.item=c,b.getObjectsFromSameProductionSequence(c.object_id).then(function(b){a.objects=b}))})}]),angular.module("blake").directive("objectsWithSameMotif",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-with-same-motif/template.html",controller:"ObjectsWithSameMotifController"}}),angular.module("blake").controller("ObjectsWithSameMotifController",["$scope","BlakeDataService",function(a,b){a.BlakeDataService=b,a.$on("objectSelectionChange",function(){var c=b.getSelectedObject();c&&(a.item=c,b.getObjectsWithSameMotif(c.object_id).then(function(b){a.objects=b}))})}]),angular.module("blake").directive("objectCompare",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/object-compare/template.html",controller:"ObjectCompareController"}}),angular.module("blake").controller("ObjectCompareController",["$scope","$timeout","Fullscreen","BlakeDataService","UtilityServices",function(a,b,c,d,e){function f(){var a=0;$("#object-view #compare .item").each(function(){a+=Number($(this).width())}),$("#object-view #compare .compare-inner").css("width",a+10+"px")}function g(){var a=$(window).height()-370;$("#object-view #compare .featured-object img").css("height",a+"px")}a.BlakeDataService=d,a.updateCopyInfo=function(b,c){var e=b.split(".").slice(0,2).join(".");a.copy=d.setSelectedCopy(e,c)},a.getObjLines=function(){var b=[];return a.obj&&void 0!==a.obj.text&&null!==a.obj.text&&a.obj.text.lg.length&&(b=e.imageText(a,b)),b},a.toggleTray=e.togglingTray,a.compareViewerHeight=e.imageViewerHeight()+"px",a.compareImageHeight=a.compareViewerHeight.split("px")[0]-125+"px",a.goFullscreen=function(a){e.fullScreen(c,a)},e.resetPanelFromFullscreen(c),a.comparisonObjects=d.getComparisonObjects(),a.obj=d.getSelectedObject(),a.$on("comparisonObjectsChange",function(){a.comparisonObjects=d.getComparisonObjects()}),a.$on("objectSelectionChange",function(){a.obj=d.getSelectedObject()});var h=e.responseChange();angular.element(document).ready(function(){b(function(){f(),g();var a=$("div.compare-inner");$("#object-detail-tray").length&&(e.trayHeight(a),a.resize(h.waitForIdle(function(){e.trayHeight(a)},10)))},0)}),$(window).on("resize",h.waitForIdle(function(){f(),g()},100))}]),angular.module("blake").directive("infoTray",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/info-tray/template.html",controller:"infoTrayController"}}),angular.module("blake").controller("infoTrayController",["$scope",function(a){}]),angular.module("blake").directive("copyTabs",function(){return{restrict:"E",templateUrl:"/blake/static/directives/copy-tabs/template.html",controller:"CopyTabsController"}}),angular.module("blake").controller("CopyTabsController",["$scope","BlakeDataService",function(a,b){a.BlakeDataService=b,a.$on("objectSelectionChange",function(){a.tabs={},a.tabs[1]={href:"#objects-in-copy",name:"Objects in Copy",active:"active"};var c=b.getSelectedObject();c&&(b.getObjectsFromSameMatrix(c.object_id).then(function(c){b.hasObjectsFromSameMatrix()&&(a.tabs[2]={href:"#objects-from-same-matrix",name:"Objects Printed from the Same Matrix"})}),b.getObjectsFromSameProductionSequence(c.object_id).then(function(c){b.hasObjectsFromSameProductionSequence()&&(a.tabs[3]={href:"#objects-from-same-production-sequence",name:"Objects from the Same Production Sequence"})}),b.getObjectsWithSameMotif(c.object_id).then(function(c){b.hasObjectsWithSameMotif()&&(a.tabs[4]={href:"#objects-with-same-motif",name:"Objects with the Same Motif"})})),a.tabs[99]={href:"#copy-info",name:"Copy Information"},a.selectedTab="#objects-in-copy"}),a.selectedTab="#objects-in-copy",a.showTab=function(b){angular.forEach(a.tabs,function(c,d){c.href==b?c.active="active":c.active="",a.selectedTab=b})}}]);
//# sourceMappingURL=output.min.js.map