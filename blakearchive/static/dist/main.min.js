!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():"undefined"!=typeof Package?Sortable=t():window.Sortable=t()}(function(){"use strict";function t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=m({},e),t[M]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var i in n)!(i in e)&&(e[i]=n[i]);G(e);for(var a in this)"_"===a.charAt(0)&&(this[a]=this[a].bind(this));this.nativeDraggable=e.forceFallback?!1:P,o(t,"mousedown",this._onTapStart),o(t,"touchstart",this._onTapStart),this.nativeDraggable&&(o(t,"dragover",this),o(t,"dragenter",this)),V.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t){y&&y.state!==t&&(s(y,"display",t?"none":""),!t&&y.state&&S.insertBefore(y,b),y.state=t)}function n(t,e,n){if(t){n=n||U,e=e.split(".");var i=e.shift().toUpperCase(),o=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");do if(">*"===i&&t.parentNode===n||(""===i||t.nodeName.toUpperCase()==i)&&(!e.length||((" "+t.className+" ").match(o)||[]).length==e.length))return t;while(t!==n&&(t=t.parentNode))}return null}function i(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}function o(t,e,n){t.addEventListener(e,n,!1)}function a(t,e,n){t.removeEventListener(e,n,!1)}function r(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(k," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(k," ")}}function s(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return U.defaultView&&U.defaultView.getComputedStyle?n=U.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function l(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,a=i.length;if(n)for(;a>o;o++)n(i[o],o);return i}return[]}function d(t,e,n,i,o,a,r){var s=U.createEvent("Event"),l=(t||e[M]).options,d="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=o||e,s.item=i||e,s.clone=y,s.oldIndex=a,s.newIndex=r,e.dispatchEvent(s),l[d]&&l[d].call(t,s)}function c(t,e,n,i,o,a){var r,s,l=t[M],d=l.options.onMove;return r=U.createEvent("Event"),r.initEvent("move",!0,!0),r.to=e,r.from=t,r.dragged=n,r.draggedRect=i,r.related=o||e,r.relatedRect=a||e.getBoundingClientRect(),t.dispatchEvent(r),d&&(s=d.call(l,r)),s}function h(t){t.draggable=!1}function u(){j=!1}function f(t,e){var n=t.lastElementChild,i=n.getBoundingClientRect();return(e.clientY-(i.top+i.height)>5||e.clientX-(i.right+i.width)>5)&&n}function p(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function g(t){var e=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"!==t.nodeName.toUpperCase()&&e++;return e}function v(t,e){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?t.call(i,n[0]):t.apply(i,n),n=void 0},e))}}function m(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var b,D,_,y,S,T,w,C,E,x,N,B,O,X,Y,A,I,R={},k=/\s+/g,M="Sortable"+(new Date).getTime(),L=window,U=L.document,H=L.parseInt,P=!!("draggable"in U.createElement("div")),W=function(t){return t=U.createElement("x"),t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}(),j=!1,F=Math.abs,V=([].slice,[]),z=v(function(t,e,n){if(n&&e.scroll){var i,o,a,r,s=e.scrollSensitivity,l=e.scrollSpeed,d=t.clientX,c=t.clientY,h=window.innerWidth,u=window.innerHeight;if(C!==n&&(w=e.scroll,C=n,w===!0)){w=n;do if(w.offsetWidth<w.scrollWidth||w.offsetHeight<w.scrollHeight)break;while(w=w.parentNode)}w&&(i=w,o=w.getBoundingClientRect(),a=(F(o.right-d)<=s)-(F(o.left-d)<=s),r=(F(o.bottom-c)<=s)-(F(o.top-c)<=s)),a||r||(a=(s>=h-d)-(s>=d),r=(s>=u-c)-(s>=c),(a||r)&&(i=L)),R.vx===a&&R.vy===r&&R.el===i||(R.el=i,R.vx=a,R.vy=r,clearInterval(R.pid),i&&(R.pid=setInterval(function(){i===L?L.scrollTo(L.pageXOffset+a*l,L.pageYOffset+r*l):(r&&(i.scrollTop+=r*l),a&&(i.scrollLeft+=a*l))},24)))}},30),G=function(t){var e=t.group;e&&"object"==typeof e||(e=t.group={name:e}),["pull","put"].forEach(function(t){t in e||(e[t]=!0)}),t.groups=" "+e.name+(e.put.join?" "+e.put.join(" "):"")+" "};return t.prototype={constructor:t,_onTapStart:function(t){var e=this,i=this.el,o=this.options,a=t.type,r=t.touches&&t.touches[0],s=(r||t).target,l=s,c=o.filter;if(!("mousedown"===a&&0!==t.button||o.disabled)&&(s=n(s,o.draggable,i))){if(B=g(s),"function"==typeof c){if(c.call(this,t,s,this))return d(e,l,"filter",s,i,B),void t.preventDefault()}else if(c&&(c=c.split(",").some(function(t){return t=n(l,t.trim(),i),t?(d(e,t,"filter",s,i,B),!0):void 0})))return void t.preventDefault();o.handle&&!n(l,o.handle,i)||this._prepareDragStart(t,r,s)}},_prepareDragStart:function(t,e,n){var i,a=this,s=a.el,d=a.options,c=s.ownerDocument;n&&!b&&n.parentNode===s&&(Y=t,S=s,b=n,D=b.parentNode,T=b.nextSibling,X=d.group,i=function(){a._disableDelayedDrag(),b.draggable=!0,r(b,a.options.chosenClass,!0),a._triggerDragStart(e)},d.ignore.split(",").forEach(function(t){l(b,t.trim(),h)}),o(c,"mouseup",a._onDrop),o(c,"touchend",a._onDrop),o(c,"touchcancel",a._onDrop),d.delay?(o(c,"mouseup",a._disableDelayedDrag),o(c,"touchend",a._disableDelayedDrag),o(c,"touchcancel",a._disableDelayedDrag),o(c,"mousemove",a._disableDelayedDrag),o(c,"touchmove",a._disableDelayedDrag),a._dragStartTimer=setTimeout(i,d.delay)):i())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),a(t,"mouseup",this._disableDelayedDrag),a(t,"touchend",this._disableDelayedDrag),a(t,"touchcancel",this._disableDelayedDrag),a(t,"mousemove",this._disableDelayedDrag),a(t,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(t){t?(Y={target:b,clientX:t.clientX,clientY:t.clientY},this._onDragStart(Y,"touch")):this.nativeDraggable?(o(b,"dragend",this),o(S,"dragstart",this._onDragStart)):this._onDragStart(Y,!0);try{U.selection?U.selection.empty():window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(){S&&b&&(r(b,this.options.ghostClass,!0),t.active=this,d(this,S,"start",b,S,B))},_emulateDragOver:function(){if(A){if(this._lastX===A.clientX&&this._lastY===A.clientY)return;this._lastX=A.clientX,this._lastY=A.clientY,W||s(_,"display","none");var t=U.elementFromPoint(A.clientX,A.clientY),e=t,n=" "+this.options.group.name,i=V.length;if(e)do{if(e[M]&&e[M].options.groups.indexOf(n)>-1){for(;i--;)V[i]({clientX:A.clientX,clientY:A.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);W||s(_,"display","")}},_onTouchMove:function(e){if(Y){t.active||this._dragStarted(),this._appendGhost();var n=e.touches?e.touches[0]:e,i=n.clientX-Y.clientX,o=n.clientY-Y.clientY,a=e.touches?"translate3d("+i+"px,"+o+"px,0)":"translate("+i+"px,"+o+"px)";I=!0,A=n,s(_,"webkitTransform",a),s(_,"mozTransform",a),s(_,"msTransform",a),s(_,"transform",a),e.preventDefault()}},_appendGhost:function(){if(!_){var t,e=b.getBoundingClientRect(),n=s(b),i=this.options;_=b.cloneNode(!0),r(_,i.ghostClass,!1),r(_,i.fallbackClass,!0),s(_,"top",e.top-H(n.marginTop,10)),s(_,"left",e.left-H(n.marginLeft,10)),s(_,"width",e.width),s(_,"height",e.height),s(_,"opacity","0.8"),s(_,"position","fixed"),s(_,"zIndex","100000"),s(_,"pointerEvents","none"),i.fallbackOnBody&&U.body.appendChild(_)||S.appendChild(_),t=_.getBoundingClientRect(),s(_,"width",2*e.width-t.width),s(_,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,i=this.options;this._offUpEvents(),"clone"==X.pull&&(y=b.cloneNode(!0),s(y,"display","none"),S.insertBefore(y,b)),e?("touch"===e?(o(U,"touchmove",this._onTouchMove),o(U,"touchend",this._onDrop),o(U,"touchcancel",this._onDrop)):(o(U,"mousemove",this._onTouchMove),o(U,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,b)),o(U,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(t){var i,o,a,r=this.el,l=this.options,d=l.group,h=d.put,p=X===d,g=l.sort;if(void 0!==t.preventDefault&&(t.preventDefault(),!l.dragoverBubble&&t.stopPropagation()),I=!0,X&&!l.disabled&&(p?g||(a=!S.contains(b)):X.pull&&h&&(X.name===d.name||h.indexOf&&~h.indexOf(X.name)))&&(void 0===t.rootEl||t.rootEl===this.el)){if(z(t,l,this.el),j)return;if(i=n(t.target,l.draggable,r),o=b.getBoundingClientRect(),a)return e(!0),void(y||T?S.insertBefore(b,y||T):g||S.appendChild(b));if(0===r.children.length||r.children[0]===_||r===t.target&&(i=f(r,t))){if(i){if(i.animated)return;m=i.getBoundingClientRect()}e(p),c(S,r,b,o,i,m)!==!1&&(b.contains(r)||(r.appendChild(b),D=r),this._animate(o,b),i&&this._animate(m,i))}else if(i&&!i.animated&&i!==b&&void 0!==i.parentNode[M]){E!==i&&(E=i,x=s(i),N=s(i.parentNode));var v,m=i.getBoundingClientRect(),w=m.right-m.left,C=m.bottom-m.top,B=/left|right|inline/.test(x.cssFloat+x.display)||"flex"==N.display&&0===N["flex-direction"].indexOf("row"),O=i.offsetWidth>b.offsetWidth,Y=i.offsetHeight>b.offsetHeight,A=(B?(t.clientX-m.left)/w:(t.clientY-m.top)/C)>.5,R=i.nextElementSibling,k=c(S,r,b,o,i,m);if(k!==!1){if(j=!0,setTimeout(u,30),e(p),1===k||-1===k)v=1===k;else if(B){var L=b.offsetTop,U=i.offsetTop;v=L===U?i.previousElementSibling===b&&!O||A&&O:U>L}else v=R!==b&&!Y||A&&Y;b.contains(r)||(v&&!R?r.appendChild(b):i.parentNode.insertBefore(b,v?R:i)),D=b.parentNode,this._animate(o,b),this._animate(m,i)}}}},_animate:function(t,e){var n=this.options.animation;if(n){var i=e.getBoundingClientRect();s(e,"transition","none"),s(e,"transform","translate3d("+(t.left-i.left)+"px,"+(t.top-i.top)+"px,0)"),e.offsetWidth,s(e,"transition","all "+n+"ms"),s(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){s(e,"transition",""),s(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;a(U,"touchmove",this._onTouchMove),a(t,"mouseup",this._onDrop),a(t,"touchend",this._onDrop),a(t,"touchcancel",this._onDrop)},_onDrop:function(e){var n=this.el,i=this.options;clearInterval(this._loopId),clearInterval(R.pid),clearTimeout(this._dragStartTimer),a(U,"mousemove",this._onTouchMove),this.nativeDraggable&&(a(U,"drop",this),a(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(I&&(e.preventDefault(),!i.dropBubble&&e.stopPropagation()),_&&_.parentNode.removeChild(_),b&&(this.nativeDraggable&&a(b,"dragend",this),h(b),r(b,this.options.ghostClass,!1),r(b,this.options.chosenClass,!1),S!==D?(O=g(b),O>=0&&(d(null,D,"sort",b,S,B,O),d(this,S,"sort",b,S,B,O),d(null,D,"add",b,S,B,O),d(this,S,"remove",b,S,B,O))):(y&&y.parentNode.removeChild(y),b.nextSibling!==T&&(O=g(b),O>=0&&(d(this,S,"update",b,S,B,O),d(this,S,"sort",b,S,B,O)))),t.active&&(null!==O&&-1!==O||(O=B),d(this,S,"end",b,S,B,O),this.save())),S=b=D=_=T=y=w=C=Y=A=I=O=E=x=X=t.active=null)},handleEvent:function(t){var e=t.type;"dragover"===e||"dragenter"===e?b&&(this._onDragOver(t),i(t)):"drop"!==e&&"dragend"!==e||this._onDrop(t)},toArray:function(){for(var t,e=[],i=this.el.children,o=0,a=i.length,r=this.options;a>o;o++)t=i[o],n(t,r.draggable,this.el)&&e.push(t.getAttribute(r.dataIdAttr)||p(t));return e},sort:function(t){var e={},i=this.el;this.toArray().forEach(function(t,o){var a=i.children[o];n(a,this.options.draggable,i)&&(e[t]=a)},this),t.forEach(function(t){e[t]&&(i.removeChild(e[t]),i.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;return void 0===e?n[t]:(n[t]=e,void("group"===t&&G(n)))},destroy:function(){var t=this.el;t[M]=null,a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart),this.nativeDraggable&&(a(t,"dragover",this),a(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),V.splice(V.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},t.utils={on:o,off:a,css:s,find:l,is:function(t,e){return!!n(t,e,t)},extend:m,throttle:v,closest:n,toggleClass:r,index:g},t.create=function(e,n){return new t(e,n)},t.version="1.4.2",t});
!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():"undefined"!=typeof Package?Sortable=t():window.Sortable=t()}(function(){"use strict";function t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=m({},e),t[M]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var i in n)!(i in e)&&(e[i]=n[i]);G(e);for(var a in this)"_"===a.charAt(0)&&(this[a]=this[a].bind(this));this.nativeDraggable=e.forceFallback?!1:P,o(t,"mousedown",this._onTapStart),o(t,"touchstart",this._onTapStart),this.nativeDraggable&&(o(t,"dragover",this),o(t,"dragenter",this)),V.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t){y&&y.state!==t&&(s(y,"display",t?"none":""),!t&&y.state&&S.insertBefore(y,b),y.state=t)}function n(t,e,n){if(t){n=n||U,e=e.split(".");var i=e.shift().toUpperCase(),o=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");do if(">*"===i&&t.parentNode===n||(""===i||t.nodeName.toUpperCase()==i)&&(!e.length||((" "+t.className+" ").match(o)||[]).length==e.length))return t;while(t!==n&&(t=t.parentNode))}return null}function i(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}function o(t,e,n){t.addEventListener(e,n,!1)}function a(t,e,n){t.removeEventListener(e,n,!1)}function r(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(k," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(k," ")}}function s(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return U.defaultView&&U.defaultView.getComputedStyle?n=U.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function l(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,a=i.length;if(n)for(;a>o;o++)n(i[o],o);return i}return[]}function d(t,e,n,i,o,a,r){var s=U.createEvent("Event"),l=(t||e[M]).options,d="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=o||e,s.item=i||e,s.clone=y,s.oldIndex=a,s.newIndex=r,e.dispatchEvent(s),l[d]&&l[d].call(t,s)}function c(t,e,n,i,o,a){var r,s,l=t[M],d=l.options.onMove;return r=U.createEvent("Event"),r.initEvent("move",!0,!0),r.to=e,r.from=t,r.dragged=n,r.draggedRect=i,r.related=o||e,r.relatedRect=a||e.getBoundingClientRect(),t.dispatchEvent(r),d&&(s=d.call(l,r)),s}function h(t){t.draggable=!1}function u(){j=!1}function f(t,e){var n=t.lastElementChild,i=n.getBoundingClientRect();return(e.clientY-(i.top+i.height)>5||e.clientX-(i.right+i.width)>5)&&n}function p(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function g(t){var e=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"!==t.nodeName.toUpperCase()&&e++;return e}function v(t,e){var n,i;return function(){void 0===n&&(n=arguments,i=this,setTimeout(function(){1===n.length?t.call(i,n[0]):t.apply(i,n),n=void 0},e))}}function m(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var b,D,_,y,S,T,w,C,E,x,N,B,O,X,Y,A,I,R={},k=/\s+/g,M="Sortable"+(new Date).getTime(),L=window,U=L.document,H=L.parseInt,P=!!("draggable"in U.createElement("div")),W=function(t){return t=U.createElement("x"),t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}(),j=!1,F=Math.abs,V=([].slice,[]),z=v(function(t,e,n){if(n&&e.scroll){var i,o,a,r,s=e.scrollSensitivity,l=e.scrollSpeed,d=t.clientX,c=t.clientY,h=window.innerWidth,u=window.innerHeight;if(C!==n&&(w=e.scroll,C=n,w===!0)){w=n;do if(w.offsetWidth<w.scrollWidth||w.offsetHeight<w.scrollHeight)break;while(w=w.parentNode)}w&&(i=w,o=w.getBoundingClientRect(),a=(F(o.right-d)<=s)-(F(o.left-d)<=s),r=(F(o.bottom-c)<=s)-(F(o.top-c)<=s)),a||r||(a=(s>=h-d)-(s>=d),r=(s>=u-c)-(s>=c),(a||r)&&(i=L)),(R.vx!==a||R.vy!==r||R.el!==i)&&(R.el=i,R.vx=a,R.vy=r,clearInterval(R.pid),i&&(R.pid=setInterval(function(){i===L?L.scrollTo(L.pageXOffset+a*l,L.pageYOffset+r*l):(r&&(i.scrollTop+=r*l),a&&(i.scrollLeft+=a*l))},24)))}},30),G=function(t){var e=t.group;e&&"object"==typeof e||(e=t.group={name:e}),["pull","put"].forEach(function(t){t in e||(e[t]=!0)}),t.groups=" "+e.name+(e.put.join?" "+e.put.join(" "):"")+" "};return t.prototype={constructor:t,_onTapStart:function(t){var e=this,i=this.el,o=this.options,a=t.type,r=t.touches&&t.touches[0],s=(r||t).target,l=s,c=o.filter;if(!("mousedown"===a&&0!==t.button||o.disabled)&&(s=n(s,o.draggable,i))){if(B=g(s),"function"==typeof c){if(c.call(this,t,s,this))return d(e,l,"filter",s,i,B),void t.preventDefault()}else if(c&&(c=c.split(",").some(function(t){return t=n(l,t.trim(),i),t?(d(e,t,"filter",s,i,B),!0):void 0})))return void t.preventDefault();(!o.handle||n(l,o.handle,i))&&this._prepareDragStart(t,r,s)}},_prepareDragStart:function(t,e,n){var i,a=this,s=a.el,d=a.options,c=s.ownerDocument;n&&!b&&n.parentNode===s&&(Y=t,S=s,b=n,D=b.parentNode,T=b.nextSibling,X=d.group,i=function(){a._disableDelayedDrag(),b.draggable=!0,r(b,a.options.chosenClass,!0),a._triggerDragStart(e)},d.ignore.split(",").forEach(function(t){l(b,t.trim(),h)}),o(c,"mouseup",a._onDrop),o(c,"touchend",a._onDrop),o(c,"touchcancel",a._onDrop),d.delay?(o(c,"mouseup",a._disableDelayedDrag),o(c,"touchend",a._disableDelayedDrag),o(c,"touchcancel",a._disableDelayedDrag),o(c,"mousemove",a._disableDelayedDrag),o(c,"touchmove",a._disableDelayedDrag),a._dragStartTimer=setTimeout(i,d.delay)):i())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),a(t,"mouseup",this._disableDelayedDrag),a(t,"touchend",this._disableDelayedDrag),a(t,"touchcancel",this._disableDelayedDrag),a(t,"mousemove",this._disableDelayedDrag),a(t,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(t){t?(Y={target:b,clientX:t.clientX,clientY:t.clientY},this._onDragStart(Y,"touch")):this.nativeDraggable?(o(b,"dragend",this),o(S,"dragstart",this._onDragStart)):this._onDragStart(Y,!0);try{U.selection?U.selection.empty():window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(){S&&b&&(r(b,this.options.ghostClass,!0),t.active=this,d(this,S,"start",b,S,B))},_emulateDragOver:function(){if(A){if(this._lastX===A.clientX&&this._lastY===A.clientY)return;this._lastX=A.clientX,this._lastY=A.clientY,W||s(_,"display","none");var t=U.elementFromPoint(A.clientX,A.clientY),e=t,n=" "+this.options.group.name,i=V.length;if(e)do{if(e[M]&&e[M].options.groups.indexOf(n)>-1){for(;i--;)V[i]({clientX:A.clientX,clientY:A.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);W||s(_,"display","")}},_onTouchMove:function(e){if(Y){t.active||this._dragStarted(),this._appendGhost();var n=e.touches?e.touches[0]:e,i=n.clientX-Y.clientX,o=n.clientY-Y.clientY,a=e.touches?"translate3d("+i+"px,"+o+"px,0)":"translate("+i+"px,"+o+"px)";I=!0,A=n,s(_,"webkitTransform",a),s(_,"mozTransform",a),s(_,"msTransform",a),s(_,"transform",a),e.preventDefault()}},_appendGhost:function(){if(!_){var t,e=b.getBoundingClientRect(),n=s(b),i=this.options;_=b.cloneNode(!0),r(_,i.ghostClass,!1),r(_,i.fallbackClass,!0),s(_,"top",e.top-H(n.marginTop,10)),s(_,"left",e.left-H(n.marginLeft,10)),s(_,"width",e.width),s(_,"height",e.height),s(_,"opacity","0.8"),s(_,"position","fixed"),s(_,"zIndex","100000"),s(_,"pointerEvents","none"),i.fallbackOnBody&&U.body.appendChild(_)||S.appendChild(_),t=_.getBoundingClientRect(),s(_,"width",2*e.width-t.width),s(_,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,i=this.options;this._offUpEvents(),"clone"==X.pull&&(y=b.cloneNode(!0),s(y,"display","none"),S.insertBefore(y,b)),e?("touch"===e?(o(U,"touchmove",this._onTouchMove),o(U,"touchend",this._onDrop),o(U,"touchcancel",this._onDrop)):(o(U,"mousemove",this._onTouchMove),o(U,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",i.setData&&i.setData.call(this,n,b)),o(U,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(t){var i,o,a,r=this.el,l=this.options,d=l.group,h=d.put,p=X===d,g=l.sort;if(void 0!==t.preventDefault&&(t.preventDefault(),!l.dragoverBubble&&t.stopPropagation()),I=!0,X&&!l.disabled&&(p?g||(a=!S.contains(b)):X.pull&&h&&(X.name===d.name||h.indexOf&&~h.indexOf(X.name)))&&(void 0===t.rootEl||t.rootEl===this.el)){if(z(t,l,this.el),j)return;if(i=n(t.target,l.draggable,r),o=b.getBoundingClientRect(),a)return e(!0),void(y||T?S.insertBefore(b,y||T):g||S.appendChild(b));if(0===r.children.length||r.children[0]===_||r===t.target&&(i=f(r,t))){if(i){if(i.animated)return;m=i.getBoundingClientRect()}e(p),c(S,r,b,o,i,m)!==!1&&(b.contains(r)||(r.appendChild(b),D=r),this._animate(o,b),i&&this._animate(m,i))}else if(i&&!i.animated&&i!==b&&void 0!==i.parentNode[M]){E!==i&&(E=i,x=s(i),N=s(i.parentNode));var v,m=i.getBoundingClientRect(),w=m.right-m.left,C=m.bottom-m.top,B=/left|right|inline/.test(x.cssFloat+x.display)||"flex"==N.display&&0===N["flex-direction"].indexOf("row"),O=i.offsetWidth>b.offsetWidth,Y=i.offsetHeight>b.offsetHeight,A=(B?(t.clientX-m.left)/w:(t.clientY-m.top)/C)>.5,R=i.nextElementSibling,k=c(S,r,b,o,i,m);if(k!==!1){if(j=!0,setTimeout(u,30),e(p),1===k||-1===k)v=1===k;else if(B){var L=b.offsetTop,U=i.offsetTop;v=L===U?i.previousElementSibling===b&&!O||A&&O:U>L}else v=R!==b&&!Y||A&&Y;b.contains(r)||(v&&!R?r.appendChild(b):i.parentNode.insertBefore(b,v?R:i)),D=b.parentNode,this._animate(o,b),this._animate(m,i)}}}},_animate:function(t,e){var n=this.options.animation;if(n){var i=e.getBoundingClientRect();s(e,"transition","none"),s(e,"transform","translate3d("+(t.left-i.left)+"px,"+(t.top-i.top)+"px,0)"),e.offsetWidth,s(e,"transition","all "+n+"ms"),s(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){s(e,"transition",""),s(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;a(U,"touchmove",this._onTouchMove),a(t,"mouseup",this._onDrop),a(t,"touchend",this._onDrop),a(t,"touchcancel",this._onDrop)},_onDrop:function(e){var n=this.el,i=this.options;clearInterval(this._loopId),clearInterval(R.pid),clearTimeout(this._dragStartTimer),a(U,"mousemove",this._onTouchMove),this.nativeDraggable&&(a(U,"drop",this),a(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(I&&(e.preventDefault(),!i.dropBubble&&e.stopPropagation()),_&&_.parentNode.removeChild(_),b&&(this.nativeDraggable&&a(b,"dragend",this),h(b),r(b,this.options.ghostClass,!1),r(b,this.options.chosenClass,!1),S!==D?(O=g(b),O>=0&&(d(null,D,"sort",b,S,B,O),d(this,S,"sort",b,S,B,O),d(null,D,"add",b,S,B,O),d(this,S,"remove",b,S,B,O))):(y&&y.parentNode.removeChild(y),b.nextSibling!==T&&(O=g(b),O>=0&&(d(this,S,"update",b,S,B,O),d(this,S,"sort",b,S,B,O)))),t.active&&((null===O||-1===O)&&(O=B),d(this,S,"end",b,S,B,O),this.save())),S=b=D=_=T=y=w=C=Y=A=I=O=E=x=X=t.active=null)},handleEvent:function(t){var e=t.type;"dragover"===e||"dragenter"===e?b&&(this._onDragOver(t),i(t)):("drop"===e||"dragend"===e)&&this._onDrop(t)},toArray:function(){for(var t,e=[],i=this.el.children,o=0,a=i.length,r=this.options;a>o;o++)t=i[o],n(t,r.draggable,this.el)&&e.push(t.getAttribute(r.dataIdAttr)||p(t));return e},sort:function(t){var e={},i=this.el;this.toArray().forEach(function(t,o){var a=i.children[o];n(a,this.options.draggable,i)&&(e[t]=a)},this),t.forEach(function(t){e[t]&&(i.removeChild(e[t]),i.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;return void 0===e?n[t]:(n[t]=e,void("group"===t&&G(n)))},destroy:function(){var t=this.el;t[M]=null,a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart),this.nativeDraggable&&(a(t,"dragover",this),a(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),V.splice(V.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},t.utils={on:o,off:a,css:s,find:l,is:function(t,e){return!!n(t,e,t)},extend:m,throttle:v,closest:n,toggleClass:r,index:g},t.create=function(e,n){return new t(e,n)},t.version="1.4.2",t});
!function(n){"use strict";"function"==typeof define&&define.amd?define(["angular","./Sortable"],n):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?(require("angular"),n(angular,require("./Sortable")),module.exports="ng-sortable"):window.angular&&window.Sortable&&n(angular,Sortable)}(function(n,e){"use strict";var o="Sortable:ng-sortable";n.module("ng-sortable",[]).constant("ngSortableVersion","0.4.0").constant("ngSortableConfig",{}).directive("ngSortable",["$parse","ngSortableConfig",function(t,r){var l,i,a=function(n,e){var o=[].filter.call(n.childNodes,function(n){return 8===n.nodeType&&-1!==n.nodeValue.indexOf("ngRepeat:")})[0];if(!o)return function(){return null};o=o.nodeValue.match(/ngRepeat:\s*(?:\(.*?,\s*)?([^\s)]+)[\s)]+in\s+([^\s|]+)/);var r=t(o[2]);return function(){return r(e.$parent)||[]}};return{restrict:"AC",scope:{ngSortable:"=?"},link:function(t,u){function c(n,e){var o="on"+n.type.charAt(0).toUpperCase()+n.type.substr(1),t=b();p[o]&&p[o]({model:e||t[n.newIndex],models:t,oldIndex:n.oldIndex,newIndex:n.newIndex})}function d(r){var a=b();if(a){var u=r.oldIndex,c=r.newIndex;if(s!==r.from){var d=r.from[o]();l=d[u],r.clone?(l=n.copy(l),d.splice(e.utils.index(r.clone),0,d.splice(u,1)[0]),r.from.removeChild(r.clone)):d.splice(u,1),a.splice(c,0,l),r.from.insertBefore(r.item,i)}else a.splice(c,0,a.splice(u,1)[0]);t.$apply()}}var f,s=u[0],p=n.extend(t.ngSortable||{},r),g=[],b=a(s,t);s[o]=b,f=e.create(s,Object.keys(p).reduce(function(n,e){return n[e]=n[e]||p[e],n},{onStart:function(n){i=n.item.nextSibling,c(n),t.$apply()},onEnd:function(n){c(n,l),t.$apply()},onAdd:function(n){d(n),c(n,l),t.$apply()},onUpdate:function(n){d(n),c(n)},onRemove:function(n){c(n,l)},onSort:function(n){c(n)}})),u.on("$destroy",function(){n.forEach(g,function(n){n()}),f.destroy(),s[o]=null,s=null,g=null,f=null,i=null}),n.forEach(["sort","disabled","draggable","handle","animation","group","ghostClass","filter","onStart","onEnd","onAdd","onUpdate","onRemove","onSort"],function(n){g.push(t.$watch("ngSortable."+n,function(e){void 0!==e&&(p[n]=e,/^on[A-Z]/.test(n)||f.option(n,e))}))})}}}])});
!function(n){"function"==typeof define&&define.amd?define(["angular","./Sortable"],n):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?(require("angular"),n(angular,require("./Sortable")),module.exports="ng-sortable"):window.angular&&window.Sortable&&n(angular,Sortable)}(function(n,e){n.module("ng-sortable",[]).constant("ngSortableVersion","0.4.0").constant("ngSortableConfig",{}).directive("ngSortable",["$parse","ngSortableConfig",function(o,t){var r,a,i=function(n,e){var t=[].filter.call(n.childNodes,function(n){return 8===n.nodeType&&-1!==n.nodeValue.indexOf("ngRepeat:")})[0];if(!t)return function(){return null};var t=t.nodeValue.match(/ngRepeat:\s*(?:\(.*?,\s*)?([^\s)]+)[\s)]+in\s+([^\s|]+)/),r=o(t[2]);return function(){return r(e.$parent)||[]}};return{restrict:"AC",scope:{ngSortable:"=?"},link:function(o,l){function c(n,e){var o="on"+n.type.charAt(0).toUpperCase()+n.type.substr(1),t=b();s[o]&&s[o]({model:e||t[n.newIndex],models:t,oldIndex:n.oldIndex,newIndex:n.newIndex})}function u(t){var i=b();if(i){var l=t.oldIndex,c=t.newIndex;if(f!==t.from){var u=t.from["Sortable:ng-sortable"]();r=u[l],t.clone?(r=n.copy(r),u.splice(e.utils.index(t.clone),0,u.splice(l,1)[0]),t.from.removeChild(t.clone)):u.splice(l,1),i.splice(c,0,r),t.from.insertBefore(t.item,a)}else i.splice(c,0,i.splice(l,1)[0]);o.$apply()}}var d,f=l[0],s=n.extend(o.ngSortable||{},t),p=[],b=i(f,o);f["Sortable:ng-sortable"]=b,d=e.create(f,Object.keys(s).reduce(function(n,e){return n[e]=n[e]||s[e],n},{onStart:function(n){a=n.item.nextSibling,c(n),o.$apply()},onEnd:function(n){c(n,r),o.$apply()},onAdd:function(n){u(n),c(n,r),o.$apply()},onUpdate:function(n){u(n),c(n)},onRemove:function(n){c(n,r)},onSort:function(n){c(n)}})),l.on("$destroy",function(){n.forEach(p,function(n){n()}),d.destroy(),a=d=p=f=f["Sortable:ng-sortable"]=null}),n.forEach("sort disabled draggable handle animation group ghostClass filter onStart onEnd onAdd onUpdate onRemove onSort".split(" "),function(n){p.push(o.$watch("ngSortable."+n,function(e){void 0!==e&&(s[n]=e,/^on[A-Z]/.test(n)||d.option(n,e))}))})}}}])});
!function(e){var n=function(e){var n=e.module("FBAngular",[]);return n.factory("Fullscreen",["$document","$rootScope",function(n,l){var u=n[0],c="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element&&Element.ALLOW_KEYBOARD_INPUT,r=l.$new();n.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){r.$emit("FBFullscreen.change",t.isEnabled())});var t={$on:e.bind(r,r.$on),all:function(){t.enable(u.documentElement)},enable:function(e){e.requestFullScreen?e.requestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?/Version\/[\d]{1,2}(\.[\d]{1,2}){1}(\.(\d){1,2}){0,1} Safari/.test(navigator.userAgent)?e.webkitRequestFullscreen():e.webkitRequestFullscreen(c):e.msRequestFullscreen&&e.msRequestFullscreen()},cancel:function(){u.cancelFullScreen?u.cancelFullScreen():u.mozCancelFullScreen?u.mozCancelFullScreen():u.webkitExitFullscreen?u.webkitExitFullscreen():u.msExitFullscreen&&u.msExitFullscreen()},isEnabled:function(){var e=u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement;return!!e},toggleAll:function(){t.isEnabled()?t.cancel():t.all()},isSupported:function(){var e=u.documentElement,n=e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen;return!!n}};return t}]),n.directive("fullscreen",["Fullscreen",function(e){return{link:function(n,l,u){if(u.fullscreen){n.$watch(u.fullscreen,function(n){var u=e.isEnabled();n&&!u?(e.enable(l[0]),l.addClass("isInFullScreen")):!n&&u&&(e.cancel(),l.removeClass("isInFullScreen"))});var c=e.$on("FBFullscreen.change",function(e,c){c||n.$evalAsync(function(){n.$eval(u.fullscreen+"= false"),l.removeClass("isInFullScreen")})});n.$on("$destroy",function(){c()})}else{if(void 0!==u.onlyWatchedProperty)return;l.on("click",function(n){e.enable(l[0])})}}}}]),n};"function"==typeof define&&define.amd?define("FBAngular",["angular"],function(e){return n(e)}):n(e.angular)}(window);
!function(e){var n=function(e){var n=e.module("FBAngular",[]);return n.factory("Fullscreen",["$document","$rootScope",function(n,l){var u=n[0],c="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element&&Element.ALLOW_KEYBOARD_INPUT,r=l.$new();n.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){r.$emit("FBFullscreen.change",t.isEnabled())});var t={$on:e.bind(r,r.$on),all:function(){t.enable(u.documentElement)},enable:function(e){e.requestFullScreen?e.requestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?/Version\/[\d]{1,2}(\.[\d]{1,2}){1}(\.(\d){1,2}){0,1} Safari/.test(navigator.userAgent)?e.webkitRequestFullscreen():e.webkitRequestFullscreen(c):e.msRequestFullscreen&&e.msRequestFullscreen()},cancel:function(){u.cancelFullScreen?u.cancelFullScreen():u.mozCancelFullScreen?u.mozCancelFullScreen():u.webkitExitFullscreen?u.webkitExitFullscreen():u.msExitFullscreen&&u.msExitFullscreen()},isEnabled:function(){return!!(u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement)},toggleAll:function(){t.isEnabled()?t.cancel():t.all()},isSupported:function(){var e=u.documentElement;return!!(e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen)}};return t}]),n.directive("fullscreen",["Fullscreen",function(e){return{link:function(n,l,u){if(u.fullscreen){n.$watch(u.fullscreen,function(n){var u=e.isEnabled();n&&!u?(e.enable(l[0]),l.addClass("isInFullScreen")):!n&&u&&(e.cancel(),l.removeClass("isInFullScreen"))});var c=e.$on("FBFullscreen.change",function(e,c){c||n.$evalAsync(function(){n.$eval(u.fullscreen+"= false"),l.removeClass("isInFullScreen")})});n.$on("$destroy",function(){c()})}else void 0===u.onlyWatchedProperty&&l.on("click",function(n){e.enable(l[0])})}}}]),n};"function"==typeof define&&define.amd?define("FBAngular",["angular"],function(e){return n(e)}):n(e.angular)}(window);
!function(e){"function"==typeof define&&define.amd?define(["angular","./Sortable"],e):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?(require("angular"),e(angular,require("./Sortable")),module.exports="ng-sortable"):window.angular&&window.Sortable&&e(angular,Sortable)}(function(e,t){e.module("ng-sortable",[]).constant("ngSortableVersion","0.4.0").constant("ngSortableConfig",{}).directive("ngSortable",["$parse","ngSortableConfig",function(n,r){var o,a,i=function(e,t){var r=[].filter.call(e.childNodes,function(e){return 8===e.nodeType&&-1!==e.nodeValue.indexOf("ngRepeat:")})[0];if(!r)return function(){return null};var r=r.nodeValue.match(/ngRepeat:\s*(?:\(.*?,\s*)?([^\s)]+)[\s)]+in\s+([^\s|]+)/),o=n(r[2]);return function(){return o(t.$parent)||[]}};return{restrict:"AC",scope:{ngSortable:"=?"},link:function(n,c){function l(e,t){var n="on"+e.type.charAt(0).toUpperCase()+e.type.substr(1),r=p();f[n]&&f[n]({model:t||r[e.newIndex],models:r,oldIndex:e.oldIndex,newIndex:e.newIndex})}function s(r){var i=p();if(i){var c=r.oldIndex,l=r.newIndex;if(d!==r.from){var s=r.from["Sortable:ng-sortable"]();o=s[c],r.clone?(o=e.copy(o),s.splice(t.utils.index(r.clone),0,s.splice(c,1)[0]),r.from.removeChild(r.clone)):s.splice(c,1),i.splice(l,0,o),r.from.insertBefore(r.item,a)}else i.splice(l,0,i.splice(c,1)[0]);n.$apply()}}var u,d=c[0],f=e.extend(n.ngSortable||{},r),m=[],p=i(d,n);d["Sortable:ng-sortable"]=p,u=t.create(d,Object.keys(f).reduce(function(e,t){return e[t]=e[t]||f[t],e},{onStart:function(e){a=e.item.nextSibling,l(e),n.$apply()},onEnd:function(e){l(e,o),n.$apply()},onAdd:function(e){s(e),l(e,o),n.$apply()},onUpdate:function(e){s(e),l(e)},onRemove:function(e){l(e,o)},onSort:function(e){l(e)}})),c.on("$destroy",function(){e.forEach(m,function(e){e()}),u.destroy(),a=u=m=d=d["Sortable:ng-sortable"]=null}),e.forEach("sort disabled draggable handle animation group ghostClass filter onStart onEnd onAdd onUpdate onRemove onSort".split(" "),function(e){m.push(n.$watch("ngSortable."+e,function(t){void 0!==t&&(f[e]=t,/^on[A-Z]/.test(e)||u.option(e,t))}))})}}}])}),function(e){var t=function(e){var t=e.module("FBAngular",[]);return t.factory("Fullscreen",["$document","$rootScope",function(t,n){var r=t[0],o="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element&&Element.ALLOW_KEYBOARD_INPUT,a=n.$new();t.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){a.$emit("FBFullscreen.change",i.isEnabled())});var i={$on:e.bind(a,a.$on),all:function(){i.enable(r.documentElement)},enable:function(e){e.requestFullScreen?e.requestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?/Version\/[\d]{1,2}(\.[\d]{1,2}){1}(\.(\d){1,2}){0,1} Safari/.test(navigator.userAgent)?e.webkitRequestFullscreen():e.webkitRequestFullscreen(o):e.msRequestFullscreen&&e.msRequestFullscreen()},cancel:function(){r.cancelFullScreen?r.cancelFullScreen():r.mozCancelFullScreen?r.mozCancelFullScreen():r.webkitExitFullscreen?r.webkitExitFullscreen():r.msExitFullscreen&&r.msExitFullscreen()},isEnabled:function(){return!!(r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement)},toggleAll:function(){i.isEnabled()?i.cancel():i.all()},isSupported:function(){var e=r.documentElement;return!!(e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen)}};return i}]),t.directive("fullscreen",["Fullscreen",function(e){return{link:function(t,n,r){if(r.fullscreen){t.$watch(r.fullscreen,function(t){var r=e.isEnabled();t&&!r?(e.enable(n[0]),n.addClass("isInFullScreen")):!t&&r&&(e.cancel(),n.removeClass("isInFullScreen"))});var o=e.$on("FBFullscreen.change",function(e,o){o||t.$evalAsync(function(){t.$eval(r.fullscreen+"= false"),n.removeClass("isInFullScreen")})});t.$on("$destroy",function(){o()})}else void 0===r.onlyWatchedProperty&&n.on("click",function(t){e.enable(n[0])})}}}]),t};"function"==typeof define&&define.amd?define("FBAngular",["angular"],function(e){return t(e)}):t(e.angular)}(window),!function(e,t,n,r){var o=e(t);e.fn.lazyload=function(a){function i(){var t=0;l.each(function(){var n=e(this);if(!s.skip_invisible||n.is(":visible"))if(e.abovethetop(this,s)||e.leftofbegin(this,s));else if(e.belowthefold(this,s)||e.rightoffold(this,s)){if(++t>s.failure_limit)return!1}else n.trigger("appear"),t=0})}var c,l=this,s={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return a&&(r!==a.failurelimit&&(a.failure_limit=a.failurelimit,delete a.failurelimit),r!==a.effectspeed&&(a.effect_speed=a.effectspeed,delete a.effectspeed),e.extend(s,a)),c=s.container===r||s.container===t?o:e(s.container),0===s.event.indexOf("scroll")&&c.bind(s.event,function(){return i()}),this.each(function(){var t=this,n=e(t);t.loaded=!1,(n.attr("src")===r||n.attr("src")===!1)&&n.is("img")&&n.attr("src",s.placeholder),n.one("appear",function(){if(!this.loaded){if(s.appear){var r=l.length;s.appear.call(t,r,s)}e("<img />").bind("load",function(){var r=n.attr("data-"+s.data_attribute);n.hide(),n.is("img")?n.attr("src",r):n.css("background-image","url('"+r+"')"),n[s.effect](s.effect_speed),t.loaded=!0;var o=e.grep(l,function(e){return!e.loaded});if(l=e(o),s.load){var a=l.length;s.load.call(t,a,s)}}).attr("src",n.attr("data-"+s.data_attribute))}}),0!==s.event.indexOf("scroll")&&n.bind(s.event,function(){t.loaded||n.trigger("appear")})}),o.bind("resize",function(){i()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&o.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&l.each(function(){e(this).trigger("appear")})}),e(n).ready(function(){i()}),this},e.belowthefold=function(n,a){var i;return i=a.container===r||a.container===t?(t.innerHeight?t.innerHeight:o.height())+o.scrollTop():e(a.container).offset().top+e(a.container).height(),i<=e(n).offset().top-a.threshold},e.rightoffold=function(n,a){var i;return i=a.container===r||a.container===t?o.width()+o.scrollLeft():e(a.container).offset().left+e(a.container).width(),i<=e(n).offset().left-a.threshold},e.abovethetop=function(n,a){var i;return i=a.container===r||a.container===t?o.scrollTop():e(a.container).offset().top,i>=e(n).offset().top+a.threshold+e(n).height()},e.leftofbegin=function(n,a){var i;return i=a.container===r||a.container===t?o.scrollLeft():e(a.container).offset().left,i>=e(n).offset().left+a.threshold+e(n).width()},e.inviewport=function(t,n){return!(e.rightoffold(t,n)||e.leftofbegin(t,n)||e.belowthefold(t,n)||e.abovethetop(t,n))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window,document),!function(e,t){"use strict";function n(t){t=e.extend({},h,t||{}),null===m&&(m=e("body"));for(var n=e(this),o=0,a=n.length;a>o;o++)r(n.eq(o),t);return n}function r(n,r){if(!n.hasClass(p.base)){r=e.extend({},r,n.data(f+"-options"));var c="";c+='<div class="'+p.bar+'">',c+='<div class="'+p.track+'">',c+='<div class="'+p.handle+'">',c+="</div></div></div>",r.paddingRight=parseInt(n.css("padding-right"),10),r.paddingBottom=parseInt(n.css("padding-bottom"),10),n.addClass([p.base,r.customClass].join(" ")).wrapInner('<div class="'+p.content+'" />').prepend(c),r.horizontal&&n.addClass(p.isHorizontal);var l=e.extend({$scroller:n,$content:n.find(d(p.content)),$bar:n.find(d(p.bar)),$track:n.find(d(p.track)),$handle:n.find(d(p.handle))},r);l.trackMargin=parseInt(l.trackMargin,10),l.$content.on("scroll."+f,l,o),l.$scroller.on(g.start,d(p.track),l,a).on(g.start,d(p.handle),l,i).data(f,l),b.reset.apply(n),e(t).one("load",function(){b.reset.apply(n)})}}function o(e){e.preventDefault(),e.stopPropagation();var t=e.data,n={};if(t.horizontal){var r=t.$content.scrollLeft();0>r&&(r=0);var o=r/t.scrollRatio;o>t.handleBounds.right&&(o=t.handleBounds.right),n={left:o}}else{var a=t.$content.scrollTop();0>a&&(a=0);var i=a/t.scrollRatio;i>t.handleBounds.bottom&&(i=t.handleBounds.bottom),n={top:i}}t.$handle.css(n)}function a(e){e.preventDefault(),e.stopPropagation();var t=e.data,n=e.originalEvent,r=t.$track.offset(),o="undefined"!=typeof n.targetTouches?n.targetTouches[0]:null,a=o?o.pageX:e.clientX,i=o?o.pageY:e.clientY;t.horizontal?(t.mouseStart=a,t.handleLeft=a-r.left-t.handleWidth/2,u(t,t.handleLeft)):(t.mouseStart=i,t.handleTop=i-r.top-t.handleHeight/2,u(t,t.handleTop)),c(t)}function i(e){e.preventDefault(),e.stopPropagation();var t=e.data,n=e.originalEvent,r="undefined"!=typeof n.targetTouches?n.targetTouches[0]:null,o=r?r.pageX:e.clientX,a=r?r.pageY:e.clientY;t.horizontal?(t.mouseStart=o,t.handleLeft=parseInt(t.$handle.css("left"),10)):(t.mouseStart=a,t.handleTop=parseInt(t.$handle.css("top"),10)),c(t)}function c(e){e.$content.off(d(f)),m.on(g.move,e,l).on(g.end,e,s)}function l(e){e.preventDefault(),e.stopPropagation();var t=e.data,n=e.originalEvent,r=0,o=0,a="undefined"!=typeof n.targetTouches?n.targetTouches[0]:null,i=a?a.pageX:e.clientX,c=a?a.pageY:e.clientY;t.horizontal?(o=t.mouseStart-i,r=t.handleLeft-o):(o=t.mouseStart-c,r=t.handleTop-o),u(t,r)}function s(e){e.preventDefault(),e.stopPropagation();var t=e.data;t.$content.on("scroll.scroller",t,o),m.off(".scroller")}function u(e,t){var n={};if(e.horizontal){t<e.handleBounds.left&&(t=e.handleBounds.left),t>e.handleBounds.right&&(t=e.handleBounds.right);var r=Math.round(t*e.scrollRatio);n={left:t},e.$content.scrollLeft(r)}else{t<e.handleBounds.top&&(t=e.handleBounds.top),t>e.handleBounds.bottom&&(t=e.handleBounds.bottom);var o=Math.round(t*e.scrollRatio);n={top:t},e.$content.scrollTop(o)}e.$handle.css(n)}function d(e){return"."+e}var f="scroller",m=null,p={base:"scroller",content:"scroller-content",bar:"scroller-bar",track:"scroller-track",handle:"scroller-handle",isHorizontal:"scroller-horizontal",isSetup:"scroller-setup",isActive:"scroller-active"},g={start:"touchstart."+f+" mousedown."+f,move:"touchmove."+f+" mousemove."+f,end:"touchend."+f+" mouseup."+f},h={customClass:"",duration:0,handleSize:0,horizontal:!1,trackMargin:0},b={defaults:function(t){return h=e.extend(h,t||{}),"object"==typeof this?e(this):!0},destroy:function(){return e(this).each(function(t,n){var r=e(n).data(f);r&&(r.$scroller.removeClass([r.customClass,p.base,p.isActive].join(" ")),r.$bar.remove(),r.$content.contents().unwrap(),r.$content.off(d(f)),r.$scroller.off(d(f)).removeData(f))})},scroll:function(t,n){return e(this).each(function(){var r=e(this).data(f),o=n||h.duration;if("number"!=typeof t){var a=e(t);if(a.length>0){var i=a.position();t=r.horizontal?i.left+r.$content.scrollLeft():i.top+r.$content.scrollTop()}else t=r.$content.scrollTop()}var c=r.horizontal?{scrollLeft:t}:{scrollTop:t};r.$content.stop().animate(c,o)})},reset:function(){return e(this).each(function(){var t=e(this).data(f);if(t){t.$scroller.addClass(p.isSetup);var n={},r={},o={},a=0,i=!0;if(t.horizontal){t.barHeight=t.$content[0].offsetHeight-t.$content[0].clientHeight,t.frameWidth=t.$content.outerWidth(),t.trackWidth=t.frameWidth-2*t.trackMargin,t.scrollWidth=t.$content[0].scrollWidth,t.ratio=t.trackWidth/t.scrollWidth,t.trackRatio=t.trackWidth/t.scrollWidth,t.handleWidth=t.handleSize>0?t.handleSize:t.trackWidth*t.trackRatio,t.scrollRatio=(t.scrollWidth-t.frameWidth)/(t.trackWidth-t.handleWidth),t.handleBounds={left:0,right:t.trackWidth-t.handleWidth},t.$content.css({paddingBottom:t.barHeight+t.paddingBottom});var c=t.$content.scrollLeft();a=c*t.ratio,i=t.scrollWidth<=t.frameWidth,n={width:t.frameWidth},r={width:t.trackWidth,marginLeft:t.trackMargin,marginRight:t.trackMargin},o={width:t.handleWidth}}else{t.barWidth=t.$content[0].offsetWidth-t.$content[0].clientWidth,t.frameHeight=t.$content.outerHeight(),t.trackHeight=t.frameHeight-2*t.trackMargin,t.scrollHeight=t.$content[0].scrollHeight,t.ratio=t.trackHeight/t.scrollHeight,t.trackRatio=t.trackHeight/t.scrollHeight,t.handleHeight=t.handleSize>0?t.handleSize:t.trackHeight*t.trackRatio,t.scrollRatio=(t.scrollHeight-t.frameHeight)/(t.trackHeight-t.handleHeight),t.handleBounds={top:0,bottom:t.trackHeight-t.handleHeight};var l=t.$content.scrollTop();a=l*t.ratio,i=t.scrollHeight<=t.frameHeight,n={height:t.frameHeight},r={height:t.trackHeight,marginBottom:t.trackMargin,marginTop:t.trackMargin},o={height:t.handleHeight}}i?t.$scroller.removeClass(p.isActive):t.$scroller.addClass(p.isActive),t.$bar.css(n),t.$track.css(r),t.$handle.css(o),u(t,a),t.$scroller.removeClass(p.isSetup)}})}};e.fn[f]=function(e){return b[e]?b[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?this:n.apply(this,arguments)},e[f]=function(e){"defaults"===e&&b.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery),function(){var e=1===angular.version.major&&0===angular.version.minor;angular.module("ui-rangeSlider",[]).directive("rangeSlider",["$document","$filter","$log",function(t,n,r){var o=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup",over:"pointerdown",out:"mouseout"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",over:"MSPointerDown",out:"mouseout"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend",over:"mouseover touchstart",out:"mouseout"},a=o.start+".rangeSlider",i=o.move+".rangeSlider",c=o.end+".rangeSlider",l=o.over+".rangeSlider",s=o.out+".rangeSlider",u=function(e){try{return[e.clientX||e.originalEvent.clientX||e.originalEvent.touches[0].clientX,e.clientY||e.originalEvent.clientY||e.originalEvent.touches[0].clientY]}catch(t){return["x","y"]}},d=function(e){return 0>e?0:e>100?100:e},f=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},o={disabled:"=?",min:"=",max:"=",modelMin:"=?",modelMax:"=?",onHandleDown:"&",onHandleUp:"&",orientation:"@",step:"@",decimalPlaces:"@",filter:"@",filterOptions:"@",showValues:"@",pinHandle:"@",preventEqualMinMax:"@",attachHandleValues:"@",getterSetter:"@"};return e&&(o.disabled="=",o.modelMin="=",o.modelMax="="),{restrict:"A",replace:!0,template:'<div class="ngrs-range-slider"><div class="ngrs-runner"><div class="ngrs-handle ngrs-handle-min"><i></i></div><div class="ngrs-handle ngrs-handle-max"><i></i></div><div class="ngrs-join"></div></div><div class="ngrs-value-runner"><div class="ngrs-value ngrs-value-min" ng-show="showValues"><div>{{filteredModelMin}}</div></div><div class="ngrs-value ngrs-value-max" ng-show="showValues"><div>{{filteredModelMax}}</div></div></div></div>',scope:o,link:function(e,o,m,p){function g(t){return e.getterSetter?arguments.length?e.modelMin(t):e.modelMin():arguments.length?e.modelMin=t:e.modelMin}function h(t){return e.getterSetter?arguments.length?e.modelMax(t):e.modelMax():arguments.length?e.modelMax=t:e.modelMax}function b(e){"min"===e?(angular.element(C[0]).css("display","none"),angular.element(C[1]).css("display","block")):"max"===e?(angular.element(C[0]).css("display","block"),angular.element(C[1]).css("display","none")):(angular.element(C[0]).css("display","block"),angular.element(C[1]).css("display","block"))}function v(e){e?y.addClass("ngrs-disabled"):y.removeClass("ngrs-disabled")}function k(){e.min>e.max&&S("min must be less than or equal to max"),angular.isDefined(e.min)&&angular.isDefined(e.max)&&(f(e.min)||S("min must be a number"),f(e.max)||S("max must be a number"),_=e.max-e.min,w())}function w(){if(g()>h()&&(r.warn("modelMin must be less than or equal to modelMax"),g(h())),(angular.isDefined(g())||"min"===e.pinHandle)&&(angular.isDefined(h())||"max"===e.pinHandle)){f(g())||("min"!==e.pinHandle&&r.warn("modelMin must be a number"),g(e.min)),f(h())||("max"!==e.pinHandle&&r.warn("modelMax must be a number"),h(e.max));var t,o,a=d((g()-e.min)/_*100),i=d((h()-e.min)/_*100);if(e.attachHandleValues&&(t=a,o=i),g(Math.max(e.min,g())),h(Math.min(e.max,h())),e.filter&&e.filterOptions)e.filteredModelMin=n(e.filter)(g(),e.filterOptions),e.filteredModelMax=n(e.filter)(h(),e.filterOptions);else if(e.filter){var c=e.filter.split(":"),l=e.filter.split(":")[0],s=c.slice().slice(1),s=s.map(function(e){return f(e)?+e:'"'==e[0]&&'"'==e[e.length-1]||"'"==e[0]&&"'"==e[e.length-1]?e.slice(1,-1):void 0}),c=s.slice(),s=s.slice();c.unshift(g()),s.unshift(h()),e.filteredModelMin=n(l).apply(null,c),e.filteredModelMax=n(l).apply(null,s)}else e.filteredModelMin=g(),e.filteredModelMax=h();e.min===e.max&&g()==h()?(angular.element(C[0]).css(O,"0%"),angular.element(C[1]).css(O,"100%"),e.attachHandleValues&&(angular.element(x[0]).css(O,"0%"),angular.element(x[1]).css(O,"100%")),angular.element($).css(O,"0%").css(M,"0%")):(angular.element(C[0]).css(O,a+"%"),angular.element(C[1]).css(O,i+"%"),e.attachHandleValues&&(angular.element(x[0]).css(O,t+"%"),angular.element(x[1]).css(O,o+"%"),angular.element(x[1]).css(M,"auto")),angular.element($).css(O,a+"%").css(M,100-i+"%"),a>95&&angular.element(C[0]).css("z-index",3))}}function j(n){var r=C[n];r.bind(a+"X",function(o){var a=(0===n?"ngrs-handle-min":"ngrs-handle-max")+"-down",l=((0===n?g():h())-e.min)/_*100,s=u(o),f=s,m=!1;angular.isFunction(e.onHandleDown)&&e.onHandleDown(),angular.element("body").bind("selectstart.rangeSlider",function(){return!1}),e.disabled||(P=!0,r.addClass("ngrs-down"),y.addClass("ngrs-focus "+a),angular.element("body").addClass("ngrs-touching"),t.bind(i,function(t){t.preventDefault(),t=u(t);var o,a,i=e.step/_*100,c=((0===n?h():g())-e.min)/_*100;"x"!==t[0]&&(t[0]-=s[0],t[1]-=s[1],o=[f[0]!==t[0],f[1]!==t[1]],a=l+100*t[F]/(F?y.height():y.width()),a=d(a),e.preventEqualMinMax&&(0===i&&(i=1/_*100),0===n?c-=i:1===n&&(c+=i)),0===n?a=a>c?c:a:1===n&&(a=c>a?c:a),0<e.step&&100>a&&a>0&&(a=Math.round(a/i)*i),a>95&&0===n?r.css("z-index",3):r.css("z-index",""),o[F]&&a!=m&&(0===n?g(parseFloat(parseFloat(a*_/100+e.min).toFixed(e.decimalPlaces))):1===n&&h(parseFloat(parseFloat(a*_/100+e.min).toFixed(e.decimalPlaces))),e.$apply(),m=a),f=t)}).bind(c,function(){angular.isFunction(e.onHandleUp)&&e.onHandleUp(),t.off(i),t.off(c),angular.element("body").removeClass("ngrs-touching"),P=!1,r.removeClass("ngrs-down"),r.removeClass("ngrs-over"),y.removeClass("ngrs-focus "+a)}))}).on(l,function(){r.addClass("ngrs-over")}).on(s,function(){P||r.removeClass("ngrs-over")})}function S(t){throw e.disabled=!0,Error("RangeSlider: "+t)}var y=angular.element(o),C=[o.find(".ngrs-handle-min"),o.find(".ngrs-handle-max")],x=[o.find(".ngrs-value-min"),o.find(".ngrs-value-max")],$=o.find(".ngrs-join"),O="left",M="right",F=0,_=0,P=!1;e.filteredModelMin=g(),e.filteredModelMax=h(),m.$observe("disabled",function(t){angular.isDefined(t)||(e.disabled=!1),e.$watch("disabled",v)}),m.$observe("orientation",function(t){angular.isDefined(t)||(e.orientation="horizontal"),t=e.orientation.split(" ");for(var n=0,r=t.length;r>n;n++)t[n]="ngrs-"+t[n];t=t.join(" "),y.addClass(t),("vertical"===e.orientation||"vertical left"===e.orientation||"vertical right"===e.orientation)&&(O="top",M="bottom",F=1)}),m.$observe("step",function(t){angular.isDefined(t)||(e.step=0)}),m.$observe("decimalPlaces",function(t){angular.isDefined(t)||(e.decimalPlaces=0)}),m.$observe("showValues",function(t){angular.isDefined(t)?e.showValues="false"!==t:e.showValues=!0}),m.$observe("pinHandle",function(t){angular.isDefined(t)?e.pinHandle="min"===t||"max"===t?t:null:e.pinHandle=null,e.$watch("pinHandle",b)}),m.$observe("preventEqualMinMax",function(t){angular.isDefined(t)?e.preventEqualMinMax="false"!==t:e.preventEqualMinMax=!1}),m.$observe("attachHandleValues",function(t){!angular.isDefined(t)||"true"!==t&&""!==t?e.attachHandleValues=!1:(e.attachHandleValues=!0,o.find(".ngrs-value-runner").addClass("ngrs-attached-handles"))}),e.$watch("min",k),e.$watch("max",k),e.$watch(function(){return g()},w),e.$watch(function(){return h()},w),e.$on("$destroy",function(){y.off(".rangeSlider"),angular.element("body").off(".rangeSlider"),t.off(".rangeSlider");for(var e=0,n=C.length;n>e;e++)C[e].off(".rangeSlider"),C[e].off(".rangeSliderX")}),y.bind("selectstart.rangeSlider",function(e){return!1}).bind("click",function(e){e.stopPropagation()}),j(0),j(1)}}}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()}(),directoryPrefix="/blake",angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(e,t,n,r){}]).directive("carousel",[function(){return{}}]),angular.module("blake",["ngRoute","ngSanitize","ui-rangeSlider","ui.bootstrap","ng-sortable","FBAngular","ngAnimate"]).config(["$routeProvider","$locationProvider",function(e,t){e.when(directoryPrefix+"/",{templateUrl:directoryPrefix+"/static/html/home.html",controller:"HomeController"}),e.when(directoryPrefix+"/object/:objectId",{templateUrl:directoryPrefix+"/static/html/object.html",controller:"ObjectController"}),e.when(directoryPrefix+"/copy/:copyId",{templateUrl:directoryPrefix+"/static/html/copy.html",controller:"CopyController"}),e.when(directoryPrefix+"/copy/:copyId/:objectId",{templateUrl:directoryPrefix+"/static/html/copy.html",controller:"CopyController"}),e.when(directoryPrefix+"/work/:workId",{templateUrl:directoryPrefix+"/static/html/work.html",controller:"WorkController"}),e.when(directoryPrefix+"/compare/",{templateUrl:directoryPrefix+"/static/html/compare.html"}),e.when(directoryPrefix+"/search/",{templateUrl:directoryPrefix+"/static/html/search.html",controller:"SearchController"}),e.otherwise({redirectTo:directoryPrefix+"/"}),t.html5Mode(!0)}]),angular.module("blake").factory("GenericService",function(){return function(e){return{create:function(t){var n,r;if(t.length)for(r=[],n=0;n<t.length;n++)r.push(e(t[n]));else r=e(t);return r}}}}),angular.module("blake").factory("BlakeObject",["GenericService",function(e){var t=function(e){var t=angular.copy(e);return t.illustration_description=angular.fromJson(e.illustration_description),t.characteristics=angular.fromJson(e.characteristics),t.text=angular.fromJson(e.text),t.header=angular.fromJson(e.header),t.source=angular.fromJson(e.source),t};return e(t)}]),angular.module("blake").factory("BlakeCopy",["BlakeObject","GenericService",function(e,t){var n=function(t){var n,r=angular.copy(t);if(r.header=angular.fromJson(t.header),r.source=angular.fromJson(t.source),t.objects)for(n=0;n<t.objects.length;n++)r.objects.push(e.create(t.objects[n]));return r};return t(n)}]),angular.module("blake").factory("BlakeWork",["BlakeCopy","GenericService",function(e,t){var n=function(t){var n,r=angular.copy(t);if(t.copies)for(n=0;n<t.copies.length;n++)r.copies.push(e.create(t.copies[n]));return r};return t(n)}]),angular.module("blake").factory("BlakeFeaturedWork",["GenericService",function(e){var t=function(e){return angular.copy(e)};return e(t)}]),angular.module("blake").factory("BlakeDataService",["$http","$q","$rootScope","BlakeWork","BlakeCopy","BlakeObject","BlakeFeaturedWork",function(e,t,n,r,o,a,i){var c,l,s,u,d,f,m,p,g,h,b,v,k,w,j,S,y,C,x,$,O,M,F,_,P=[],A=!1,B=!1,H=!1;return f=function(n){var r=directoryPrefix+"/api/query_objects";return t(function(t,o){e.post(r,n).success(function(e){t(e)}).error(function(e,t){o(e,t)})})},m=function(n){var r=directoryPrefix+"/api/object/"+n;return t(function(t,n){e.get(r).success(function(e){t(a.create(e))}).error(function(e,t){n(e,t)})})},_=function(){B=!1,H=!1,A=!1,n.$broadcast("objectSelectionChange")},p=function(n){var r=directoryPrefix+"/api/object/"+n+"/objects_with_same_motif";return t(function(t,n){e.get(r).success(function(e){e.results.length&&(A=!0),t(a.create(e.results))}).error(function(e,t){n(e,t)})})},g=function(n){var r=directoryPrefix+"/api/object/"+n+"/objects_from_same_matrix";return t(function(t,n){e.get(r).success(function(e){e.results.length&&(B=!0),t(a.create(e.results))}).error(function(e,t){n(e,t)})})},h=function(n){var r=directoryPrefix+"/api/object/"+n+"/objects_from_same_production_sequence";return t(function(t,n){e.get(r).success(function(e){e.results.length&&(H=!0),t(a.create(e.results))}).error(function(e,t){n(e,t)})})},b=function(n){var r=directoryPrefix+"/api/copy/"+n;return t(function(t,n){e.get(r).success(function(e){t(o.create(e))}).error(function(e,t){n(e,t)})})},v=function(n){var r=directoryPrefix+"/api/copy/"+n+"/objects";return t(function(t,n){e.get(r).success(function(e){t(a.create(e.results))}).error(function(e,t){n(e,t)})})},k=function(n){var o=directoryPrefix+"/api/work/"+n;return t(function(t,n){e.get(o).success(function(e){t(r.create(e))}).error(function(e,t){n(e,t)})})},w=function(){var n=directoryPrefix+"/api/work/";return t(function(t,o){e.get(n).success(function(e){t(r.create(e.results))}).error(function(e,t){o(e,t)})})},j=function(n){var r=directoryPrefix+"/api/work/"+n+"/copies";return t(function(t,n){e.get(r).success(function(e){t(o.create(e.results))}).error(function(e,t){n(e,t)})})},S=function(){var n=directoryPrefix+"/api/featured_work/";return t(function(t,r){e.get(n).success(function(e){t(i.create(e.results))}).error(function(e,t){r(e,t)})})},y=function(e){return k(e).then(function(t){c=t,n.$broadcast("workSelectionChange",t),j(e).then(function(e){u=e,n.$broadcast("workSelectionCopiesChange")})})},C=function(e,t){return b(e).then(function(r){l=r,n.$broadcast("copySelectionChange",r),v(e).then(function(e){d=e,t?e.forEach(function(e){e.object_id==t&&(s=e)}):s=e[0],n.$broadcast("copySelectionObjectsChange"),_()})})},x=function(e){return m(e).then(function(e){s=e,M(),$(e),_()})},$=function(e){var t,r=!1;for(t=P.length;t--;)if(P[t].object_id==e.object_id){r=!0;break}r||(P.push(e),n.$broadcast("comparisonObjectsChange"))},O=function(e){var t;for(t=P.length;t--;)if(P[t].object_id==e.object_id){P.splice(t,1),n.$broadcast("comparisonObjectsChange");break}},M=function(){P=[],n.$broadcast("comparisonObjectsChange")},F=function(e){for(var t=P.length;t--;)if(P[t].object_id==e.object_id)return!0;return!1},{queryObjects:f,getObject:m,getObjectsWithSameMotif:p,hasObjectsWithSameMotif:function(){return A},getObjectsFromSameMatrix:g,hasObjectsFromSameMatrix:function(){return B},getObjectsFromSameProductionSequence:h,hasObjectsFromSameProductionSequence:function(){return H},getCopy:b,getObjectsForCopy:v,getWork:k,getWorks:w,getCopiesForWork:j,getFeaturedWorks:S,setSelectedWork:y,setSelectedCopy:C,setSelectedObject:x,getSelectedWork:function(){return c},getSelectedCopy:function(){return l},getSelectedObject:function(){return s},getSelectedWorkCopies:function(){return u},getSelectedCopyObjects:function(){return d},addComparisonObject:$,removeComparisonObject:O,clearComparisonObjects:M,getComparisonObjects:function(){return P},isComparisonObject:F}}]),angular.module("blake").factory("MockBlakeDataService",["$http","$q","BlakeWork","BlakeCopy","BlakeObject","BlakeFeaturedWork",function(e,t,n,r,o,a){var i=function(){return t(function(t,n){e.get(directoryPrefix+"/static/json/objects.json").success(function(e){t(o.create(e))}).error(function(e,t){n(e,t)})})},c=function(){return t(function(t,n){e.get(directoryPrefix+"/static/json/objects.json").success(function(e){t(o.create(e[0]))}).error(function(e,t){n(e,t)})})},l=function(){return t(function(t,n){e.get(directoryPrefix+"/static/json/copies.json").success(function(e){t(r.create(e))}).error(function(e,t){n(e,t)})})},s=function(){return t(function(t,n){e.get(directoryPrefix+"/static/json/copies.json").success(function(e){t(r.create(e[0]))}).error(function(e,t){n(e,t)})})},u=function(){return t(function(t,r){e.get(directoryPrefix+"/static/json/works.json").success(function(e){t(n.create(e))}).error(function(e,t){r(e,t)})})},d=function(){return t(function(t,r){e.get(directoryPrefix+"/static/json/works.json").success(function(e){t(n.create(e[0]))}).error(function(e,t){r(e,t)})})},f=function(){return t(function(t,n){e.get(directoryPrefix+"/static/json/featured_works.json").success(function(e){t(a.create(e))}).error(function(e,t){n(e,t)})})};return{query:function(e){return i()},getObject:function(e){return c()},getObjectsWithSameMotif:function(e){return i()},getObjectsFromSameMatrix:function(e){return i()},getObjectsFromSameProductionSequence:function(e){return i()},getCopy:function(e){return s()},getObjectsForCopy:function(e){return i()},getWork:function(e){return d()},getWorks:function(){return u()},getCopiesForWork:function(e){return l()},getFeaturedWorks:function(){return f()}}}]),angular.module("blake").factory("FormatService",function(){var e=function(e){return/\s+copy\s+/.test(e)?e.replace(/copy/,"Copy"):!1};return{cap:function(){return e()}}}),angular.module("blake").factory("UtilityServices",function(){var e=function(){var e={};return e.waitForIdle=function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(r,o)},t)}},e},t=function(e){var t=e.height(),n=$(".panel-group .panel-default").length,r=t-47*n;$(".panel-group").css("min-height",t+"px"),$(".panel-group .panel-body").css("max-height",r+"px")},n=function(n,r){angular.element(document).ready(function(){r(function(){var n=e(),r=$("#object-view");$("#object-detail-tray").length&&(t(r),r.resize(n.waitForIdle(function(){t(r)},10)))},n)})},r=function(){var e=$("#object-container");e.hasClass("tray-closed")?(e.removeClass("tray-closed").addClass("tray-open"),setTimeout(function(){$(".scrollbar").scroller("reset")},300),$(".scrollbar").scroller("reset")):(e.removeClass("tray-open").addClass("tray-closed"),$(".scrollbar").scroller("reset"),setTimeout(function(){$(".scrollbar").scroller("reset")},300))},o=function(e,t){return e.obj.text.lg.forEach(function(e){e.l.length?e.l.forEach(function(e){t.push(e["#text"])}):t.push(e.l["#text"])}),t},a=function(){var e=$(window).innerHeight(),t=Math.round(.35*e);return e-t},i=function(e,t){var n=$(".panel-group .panel-body");if(e.isEnabled())e.cancel();else{var r=n.css("max-height");localStorage.setItem("panel-height",r),e.enable(document.getElementById(t));var o=$(window).innerWidth(),a=Math.round(.3*o);n.css({"max-height":o-a+"px"})}},c=function(e){function t(){if(!e.isEnabled()){var t=localStorage.getItem("panel-height");localStorage.removeItem("panel-height"),$(".panel-group .panel-body").css("max-height",t)}}document.addEventListener&&(document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("fullscreenchange",t,!1),document.addEventListener("MSFullscreenChange",t,!1))};return{responseChange:e,trayHeight:t,getImageHeight:n,togglingTray:r,imageText:o,imageViewerHeight:a,fullScreen:i,resetPanelFromFullscreen:c}}),angular.module("blake").controller("HomeController",["$rootScope","$scope","BlakeDataService",function(e,t,n){e.showSubMenu=0,n.getFeaturedWorks().then(function(n){var r=0,o=1;angular.forEach(n,function(e){e.column=o,++r,4==r&&(++o,r=0)}),t.featured_works=n,e.homePageOverride=!0})}]),angular.module("blake").controller("WorkController",["$scope","$routeParams","BlakeDataService",function(e,t,n){n.setSelectedWork(t.workId)}]),angular.module("blake").controller("ObjectController",["$scope","$routeParams","BlakeDataService",function(e,t,n){n.setSelectedWork($routeParams.objectId)}]),angular.module("blake").controller("CopyController",["$scope","$routeParams","BlakeDataService",function(e,t,n){n.setSelectedCopy(t.copyId,t.objectId).then(function(e){n.setSelectedWork(n.getSelectedCopy().bad_id)})}]),angular.module("blake").controller("SearchController",["$rootScope","$scope","$location","$routeParams","BlakeDataService",function(e,t,n,r,o){
var a,i;e.showSubMenu=0,t.search=function(){o.queryObjects(t.searchConfig).then(function(e){t.results=e})},t.loadSearchPage=function(){n.url(directoryPrefix+"/search?search="+encodeURIComponent(t.searchText))},t.searchConfig={useCompDate:!0,searchTitle:!0,searchIlluminatedBooks:!0,searchCommercialBookIllustrations:!0,searchSeparatePrints:!0,searchDrawingsPaintings:!0,searchManuscripts:!0,searchRelatedMaterials:!0,minDate:1772,maxDate:1827},a=function(e){return t.searchConfig.searchIlluminatedBooks&&"illbk"==e.work_medium?!0:!!(t.searchConfig.searchCommercialBookIllustrations&&("comb"==e.work_medium||"comdes"==e.work_medium||"comeng"==e.work_medium)||t.searchConfig.searchSeparatePrints&&("spb"==e.work_medium||"spdes"==e.work_medium||"speng"==e.work_medium)||t.searchConfig.searchCommercialBookIllustrations&&("comb"==e.work_medium||"comdes"==e.work_medium||"comeng"==e.work_medium)||t.searchConfig.searchDrawingsPaintings&&("cprint"==e.work_medium||"penc"==e.work_medium||"penink"==e.work_medium||"mono"==e.work_medium||"wc"==e.work_medium||"paint"==e.work_medium)||t.searchConfig.searchManuscripts&&("ms"==e.work_medium||"ltr"==e.work_medium||"te"==e.work_medium)||t.searchConfig.searchRelatedMaterials&&("rmb"==e.work_medium||"rmoth"==e.work_medium))},i=function(e){return t.searchConfig.searchIlluminatedBooks&&"illbk"==e.medium?!0:!!(t.searchConfig.searchCommercialBookIllustrations&&("comb"==e.medium||"comdes"==e.medium||"comeng"==e.medium)||t.searchConfig.searchSeparatePrints&&("spb"==e.medium||"spdes"==e.medium||"speng"==e.medium)||t.searchConfig.searchCommercialBookIllustrations&&("comb"==e.medium||"comdes"==e.medium||"comeng"==e.medium)||t.searchConfig.searchDrawingsPaintings&&("cprint"==e.medium||"penc"==e.medium||"penink"==e.medium||"mono"==e.medium||"wc"==e.medium||"paint"==e.medium)||t.searchConfig.searchManuscripts&&("ms"==e.medium||"ltr"==e.medium||"te"==e.medium)||t.searchConfig.searchRelatedMaterials&&("rmb"==e.medium||"rmoth"==e.medium))},t.objectResultsMatchingFilter=function(e){var n,r,o=[];if(t.results)for(r=t.results.object_results[e],n=0;n<r.length;n++)r[n].copy_composition_date>=t.searchConfig.minDate&&r[n].copy_composition_date<=t.searchConfig.maxDate&&a(r[n])&&o.push(r[n]);return o},t.workResultsMatchingFilter=function(e){var n,r,o=[];if(t.results)for(r=t.results.work_results[e],n=0;n<r.length;n++)r[n].composition_date>=t.searchConfig.minDate&&r[n].composition_date<=t.searchConfig.maxDate&&i(r[n])&&o.push(r[n]);return o},r.search&&(t.searchConfig.searchString=r.search,t.search()),t.showWorks=!0,t.showCopies=!0,t.showObjects=!0}]),function(e){"use strict";e(function(){function t(){var t=r.height()-220;e("#object-view .carousel .featured-object img").css("height",t+"px")}function n(){var t=r.scrollTop();e("#scroll-wrapper1").css("margin-top",-90-.2*t+"px"),e("#scroll-wrapper2").css("margin-top",-20-.4*t+"px"),e("#scroll-wrapper3").css("margin-top",-90-.14*t+"px"),e("#scroll-wrapper4").css("margin-top",-20-.4*t+"px"),e("#scroll-wrapper5").css("margin-top",-90-.5*t+"px"),e("#scroll-wrapper6").css("margin-top",-20-.3*t+"px")}var r=e(window),o={};o.waitForIdle=function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(r,o)},t)}},r.on("resize",o.waitForIdle(function(){if(e("nav.navbar ul.navbar-nav li.dropdown").hasClass("open")){var t=r.width(),n=e("nav.navbar ul.navbar-nav li.dropdown.open").offset().left;e("nav.navbar ul.navbar-nav li.dropdown.open").find("ul.dropdown-menu").css({width:t+"px",left:"-"+n+"px"})}},100));var a=e("button.collapse-archive"),i=e("nav.navbar");"true"!==localStorage.getItem("archive_menu_dismissed")?(a.addClass("menu-closed").removeClass("menu-open"),i.addClass("menu-closed").removeClass("menu-open")):(i.addClass("menu-open").removeClass("menu-closed"),a.addClass("menu-open").removeClass("menu-closed")),a.on("click",function(){i.hasClass("menu-open")?(i.removeClass("menu-open").addClass("menu-closed"),a.removeClass("menu-open").addClass("menu-closed"),localStorage.setItem("archive_menu_dismissed","false")):(i.addClass("menu-open").removeClass("menu-closed"),a.addClass("menu-open").removeClass("menu-closed"),localStorage.setItem("archive_menu_dismissed","true"))}),e("#object-view .carousel").length&&(t(),r.on("resize",o.waitForIdle(function(){t()},100))),e(".scrollbar").scroller({customClass:"advanced",trackMargin:10,horizontal:!0}),e(window).on("resize",o.waitForIdle(function(){e(".scrollbar").scroller("reset")},100));var c=e(".back-top");c.length&&(c.on("click",function(){e("html, body").animate({scrollTop:0},"slow")}),r.on("scroll",function(){var e=r.scrollTop();e>=50?c.addClass("scrolling"):c.removeClass("scrolling")})),n();var l=e("body.home");l.length&&r.bind("scroll",function(e){n()}),l.length&&e(function(){e("img.lazy-load").lazyload({threshold:100})})})}(this.jQuery),angular.module("blake").directive("objectsForCopy",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-for-copy/template.html",controller:"ObjectsForCopyController"}}),angular.module("blake").controller("ObjectsForCopyController",["$scope",function(e){}]),angular.module("blake").directive("copiesForWork",function(){return{restrict:"E",templateUrl:"/blake/static/directives/copies-for-work/template.html",controller:"CopiesForWorkController"}}),angular.module("blake").controller("CopiesForWorkController",["$scope","BlakeDataService",function(e,t){e.getCopyFirstObject=function(t){function n(e){switch(e){case"comb":return"com";case"comdes":return"com";case"comeng":return"com";case"spb":return"sp";case"spdes":return"sp";case"speng":return"sp";case"cprint":return"cpd";case"mono":return"wd";case"paint":return"pt";case"pen":return"pid";case"penink":return"pid";case"penc":return"pid";case"wc":return"wc";case"ms":return"ms";case"ltr":return"lt";case"te":return"typ";default:return!1}}return e.work?"illbk"==e.work.medium?"http://www.blakearchive.org/blake/images/"+t.bad_id+".p1.100.jpg":"http://www.blakearchive.org/blake/images/"+t.bad_id+".1."+n(e.work.medium)+".100.jpg":void 0};var n=function(e){switch(e){case"illbk":return"Illuminated Books";case"comb":case"comdes":case"comeng":return"Commercial Book Illustrations";case"spb":case"spdes":case"speng":case"cprint":return"Prints";case"mono":case"paint":case"pen":case"penink":case"penc":case"wc":return"Drawings and Paintings";case"ms":case"ltr":case"te":return"Manuscripts and Typographic Works";default:return!1}};e.$on("workSelectionChange",function(){e.work=t.getSelectedWork(),e.work.medium_pretty=n(e.work.medium)}),e.$on("workSelectionCopiesChange",function(){var n=t.getSelectedWorkCopies();n.sort(function(e,t){return e.source.objdescid.compdate["@value"]-t.source.objdescid.compdate["@value"]}),e.copies=n})}]),angular.module("blake").directive("viewSubMenu",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/view-sub-menu/template.html",controller:"viewSubMenuController"}}),angular.module("blake").controller("viewSubMenuController",["$scope",function(e){}]),angular.module("blake").directive("navigationMenu",function(){function e(e,t,n){var r=function(e){switch(e){case"illbk":return"illuminated_books";case"comb":return"book_illustration:designed_engraved";case"comdes":return"book_illustration:designed";case"comeng":return"book_illustration:engraved";case"spb":return"prints:designed_engraved";case"spdes":return"prints:designed";case"speng":return"prints:engraved";case"cprint":return"prints:drawings";case"mono":return"drawings_paintings:monochrome";case"paint":return"drawings_paintings:paintings";case"pen":case"penink":return"drawings_paintings:pen";case"penc":return"drawings_paintings:pencil";case"wc":return"drawings_paintings:wc";case"ms":return"manuscripts_typo:manuscripts";case"ltr":return"manuscripts_typo:letters";case"te":return"manuscripts_typo:typographic";default:return!1}};e.organizeMenus=function(t){if(t){t.sort(function(e,t){return e.composition_date-t.composition_date});var n={illuminated_books:[],book_illustration:[{designed_engraved:[],designed:[],engraved:[]}],prints:[{designed_engraved:[],designed:[],engraved:[],drawings:[]}],drawings_paintings:[{pencil:[],pen:[],monochrome:[],wc:[],paintings:[]}],manuscripts_typo:[{manuscripts:[],letters:[],typographic:[]}]};t.forEach(function(e){var t,o=r(e.medium);o&&(t=o.split(/:/),(void 0!==n[t[0]]||void 0!==n[t[0]][0][t[1]])&&(1===t.length?n[t[0]].push(e):n[t[0]][0][t[1]].push(e)))}),e.menu_lists=n}}}return{restrict:"E",link:e,controller:"MenuController",templateUrl:"/blake/static/directives/menu/template.html"}}),angular.module("blake").controller("MenuController",["$scope","BlakeDataService",function(e,t){$("nav.navbar ul.navbar-nav > li.dropdown").click(function(){var e=$(window).width(),t=$(this).offset().left;$(this).find("ul.dropdown-menu").css({width:e+"px",left:"-"+t+"px"})}),t.getWorks().then(function(t){e.organizeMenus(t)})}]),angular.module("blake").directive("copyInformation",function(){return{restrict:"E",templateUrl:"/blake/static/directives/copy-information/template.html",controller:"CopyInformationController"}}),angular.module("blake").controller("CopyInformationController",["$scope","BlakeDataService",function(e,t){e.copy=t.getSelectedCopy(),e.$on("copySelectionChange",function(){e.copy=t.getSelectedCopy()}),e.$on("objectSelectionChange",function(){var n=t.getSelectedObject(),r=t.getSelectedCopy();r.source&&r.header?(e.copySource=r.source,e.copyHeader=r.header):(e.copySource=n.source,e.copyHeader=n.header)}),e.getOriginationRole=function(e){if(e){if(e.join){var t=[];return e.forEach(function(e){t.push(e["#text"])}),t.join(" ")}return e["#text"]}}}]),angular.module("blake").directive("objectViewer",function(){return{restrict:"E",templateUrl:"/blake/static/directives/object-viewer/template.html",controller:"ObjectViewerController"}}),angular.module("blake").controller("ObjectViewerController",["$rootScope","$scope","$timeout","Fullscreen","BlakeDataService","UtilityServices",function(e,t,n,r,o,a){e.showSubMenu=1,t.BlakeDataService=o,t.getPreviousNextObjects=function(){if(t.objects&&t.objects.length)for(var e=t.objects.length;e--;)if(t.objects[e].object_id==t.obj.object_id){0>e-1?t.previousObject=t.objects[t.objects.length-1]:t.previousObject=t.objects[e-1],e+1>=t.objects.length?t.nextObject=t.objects[0]:t.nextObject=t.objects[e+1];break}},t.getObjLines=function(){var e=[];return t.obj&&t.obj.text&&t.obj.text.lg&&t.obj.text.lg.length&&(e=a.imageText(t,e)),e},t.toggleTray=a.togglingTray,t.openWindow=function(e){e.target.innerHTML,window.open("http://www.blakearchive.org/blake/")},t.goFullscreen=function(e){a.fullScreen(r,e)},a.resetPanelFromFullscreen(r),t.viewerHeight=a.imageViewerHeight()+"px",t.imageHeight=t.viewerHeight.split("px")[0]-50+"px",t.copy=o.getSelectedCopy(),t.objects=o.getSelectedCopyObjects(),t.obj=o.getSelectedObject(),t.copy&&!t.work?o.setSelectedWork(t.copy.bad_id):t.work=o.getSelectedWork(),t.getPreviousNextObjects(),t.$on("copySelectionChange",function(){t.copy=o.getSelectedCopy(),a.getImageHeight(100,n)}),t.$on("copySelectionObjectsChange",function(){t.objects=o.getSelectedCopyObjects(),a.getImageHeight(100,n)}),t.$on("objectSelectionChange",function(){t.obj=o.getSelectedObject(),t.getPreviousNextObjects(),a.getImageHeight(100,n)}),t.$on("workSelectionChange",function(){t.work=o.getSelectedWork()})}]),angular.module("blake").directive("objectsFromSameMatrix",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-from-same-matrix/template.html",controller:"ObjectsFromSameMatrixController"}}),angular.module("blake").controller("ObjectsFromSameMatrixController",["$scope","BlakeDataService",function(e,t){e.BlakeDataService=t,e.$on("objectSelectionChange",function(){var n=t.getSelectedObject();n&&(e.item=n,t.getObjectsFromSameMatrix(n.object_id).then(function(t){e.objects=t}))}),e.compareText="Select All Objects",e.selectedAll=!1,t.clearComparisonObjects(),e.selectAll=function(){var n=e.objects.length;if(t.clearComparisonObjects(),e.selectedAll){e.compareText="Select All Objects",e.selectedAll=!1;for(var r=n;r--;)e.objects[r].Selected=!1;t.clearComparisonObjects()}else{e.compareText="Clear All Objects",e.selectedAll=!0,t.addComparisonObject(e.item);for(var o=n;o--;)e.objects[o].Selected=!0,t.addComparisonObject(e.objects[o])}},e.selectOne=function(n){n.Selected?(n.Selected=!0,t.addComparisonObject(n)):(n.Selected=!1,t.removeComparisonObject(n)),t.getComparisonObjects&&t.addComparisonObject(e.item)}}]),angular.module("blake").directive("objectsFromSameProductionSequence",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-from-same-production-sequence/template.html",controller:"ObjectsFromSameProductionSequenceController"}}),angular.module("blake").controller("ObjectsFromSameProductionSequenceController",["$scope","BlakeDataService",function(e,t){e.BlakeDataService=t,e.$on("objectSelectionChange",function(){var n=t.getSelectedObject();n&&(e.item=n,t.getObjectsFromSameProductionSequence(n.object_id).then(function(t){e.objects=t}))})}]),angular.module("blake").directive("objectsWithSameMotif",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/objects-with-same-motif/template.html",controller:"ObjectsWithSameMotifController"}}),angular.module("blake").controller("ObjectsWithSameMotifController",["$scope","BlakeDataService",function(e,t){e.BlakeDataService=t,e.$on("objectSelectionChange",function(){var n=t.getSelectedObject();n&&(e.item=n,t.getObjectsWithSameMotif(n.object_id).then(function(t){e.objects=t}))})}]),angular.module("blake").directive("objectCompare",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/object-compare/template.html",controller:"ObjectCompareController"}}),angular.module("blake").controller("ObjectCompareController",["$scope","$timeout","Fullscreen","BlakeDataService","UtilityServices",function(e,t,n,r,o){function a(){var e=0;$("#object-view #compare .item").each(function(){e+=Number($(this).width())}),$("#object-view #compare .compare-inner").css("width",e+10+"px")}function i(){var e=$(window).height()-370;$("#object-view #compare .featured-object img").css("height",e+"px")}e.BlakeDataService=r,e.updateCopyInfo=function(t,n){var o=t.split(".").slice(0,2).join(".");e.copy=r.setSelectedCopy(o,n)},e.getObjLines=function(){var t=[];return e.obj&&void 0!==e.obj.text&&null!==e.obj.text&&e.obj.text.lg.length&&(t=o.imageText(e,t)),t},e.toggleTray=o.togglingTray,e.compareViewerHeight=o.imageViewerHeight()+"px",e.compareImageHeight=e.compareViewerHeight.split("px")[0]-125+"px",e.goFullscreen=function(e){o.fullScreen(n,e)},o.resetPanelFromFullscreen(n),e.comparisonObjects=r.getComparisonObjects(),e.obj=r.getSelectedObject(),e.$on("comparisonObjectsChange",function(){e.comparisonObjects=r.getComparisonObjects()}),e.$on("objectSelectionChange",function(){e.obj=r.getSelectedObject()});var c=o.responseChange();angular.element(document).ready(function(){t(function(){a(),i();var e=$("div.compare-inner");$("#object-detail-tray").length&&(o.trayHeight(e),e.resize(c.waitForIdle(function(){o.trayHeight(e)},10)))},0)}),$(window).on("resize",c.waitForIdle(function(){a(),i()},100))}]),angular.module("blake").directive("infoTray",function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/info-tray/template.html",controller:"infoTrayController"}}),angular.module("blake").controller("infoTrayController",["$scope",function(e){}]),angular.module("blake").directive("copyTabs",function(){return{restrict:"E",templateUrl:"/blake/static/directives/copy-tabs/template.html",controller:"CopyTabsController"}}),angular.module("blake").controller("CopyTabsController",["$scope","BlakeDataService",function(e,t){e.BlakeDataService=t,e.$on("objectSelectionChange",function(){e.tabs={},e.tabs[1]={href:"#objects-in-copy",name:"Objects in Copy",active:"active"};var n=t.getSelectedObject();n&&(t.getObjectsFromSameMatrix(n.object_id).then(function(n){t.hasObjectsFromSameMatrix()&&(e.tabs[2]={href:"#objects-from-same-matrix",name:"Objects Printed from the Same Matrix"})}),t.getObjectsFromSameProductionSequence(n.object_id).then(function(n){t.hasObjectsFromSameProductionSequence()&&(e.tabs[3]={href:"#objects-from-same-production-sequence",name:"Objects from the Same Production Sequence"})}),t.getObjectsWithSameMotif(n.object_id).then(function(n){t.hasObjectsWithSameMotif()&&(e.tabs[4]={href:"#objects-with-same-motif",name:"Objects with the Same Motif"})})),e.tabs[99]={href:"#copy-info",name:"Copy Information"},e.selectedTab="#objects-in-copy"}),e.selectedTab="#objects-in-copy",e.showTab=function(t){angular.forEach(e.tabs,function(n,r){n.href==t?n.active="active":n.active="",e.selectedTab=t})}}]);
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):e.hasOwnProperty("angular")?t(e.angular):"object"==typeof exports&&(module.exports=t(require("angular")))}(this,function(e){"use strict";function t(t){return function(){var n="ngStorage-";this.setKeyPrefix=function(e){if("string"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setKeyPrefix() expects a String.");n=e};var r=e.toJson,o=e.fromJson;this.setSerializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setSerializer expects a function.");r=e},this.setDeserializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setDeserializer expects a function.");o=e},this.get=function(e){return o(window[t].getItem(n+e))},this.set=function(e,o){return window[t].setItem(n+e,r(o))},this.$get=["$rootScope","$window","$log","$timeout","$document",function(i,a,s,c,u){function f(e){var t;try{t=a[e]}catch(n){t=!1}if(t&&"localStorage"===e){var r="__"+Math.round(1e7*Math.random());try{localStorage.setItem(r,r),localStorage.removeItem(r)}catch(n){t=!1}}return t}var l,d,p=n.length,g=f(t)||(s.warn("This browser does not support Web Storage!"),{setItem:e.noop,getItem:e.noop,removeItem:e.noop}),y={$default:function(t){for(var n in t)e.isDefined(y[n])||(y[n]=e.copy(t[n]));return y.$sync(),y},$reset:function(e){for(var t in y)"$"===t[0]||delete y[t]&&g.removeItem(n+t);return y.$default(e)},$sync:function(){for(var e,t=0,r=g.length;r>t;t++)(e=g.key(t))&&n===e.slice(0,p)&&(y[e.slice(p)]=o(g.getItem(e)))},$apply:function(){var t;if(d=null,!e.equals(y,l)){t=e.copy(l),e.forEach(y,function(o,i){e.isDefined(o)&&"$"!==i[0]&&(g.setItem(n+i,r(o)),delete t[i])});for(var o in t)g.removeItem(n+o);l=e.copy(y)}}};return y.$sync(),l=e.copy(y),i.$watch(function(){d||(d=c(y.$apply,100,!1))}),a.addEventListener&&a.addEventListener("storage",function(t){if(t.key){var r=u[0];r.hasFocus&&r.hasFocus()||n!==t.key.slice(0,p)||(t.newValue?y[t.key.slice(p)]=o(t.newValue):delete y[t.key.slice(p)],l=e.copy(y),i.$apply())}}),a.addEventListener&&a.addEventListener("beforeunload",function(){y.$apply()}),y}]}}return e=e&&e.module?e:window.angular,e.module("ngStorage",[]).provider("$localStorage",t("localStorage")).provider("$sessionStorage",t("sessionStorage"))});
!function(){"use strict";var e=1===angular.version.major&&0===angular.version.minor;angular.module("ui-rangeSlider",[]).directive("rangeSlider",["$document","$filter","$log",function(n,a,i){var l=".rangeSlider",t={disabled:!1,orientation:"horizontal",step:0,decimalPlaces:0,showValues:!0,preventEqualMinMax:!1,attachHandleValues:!1},s=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup",over:"pointerdown",out:"mouseout"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",over:"MSPointerDown",out:"mouseout"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend",over:"mouseover touchstart",out:"mouseout"},r=s.start+l,o=s.move+l,d=s.end+l,u=s.over+l,m=s.out+l,c=function(e){try{return[e.clientX||e.originalEvent.clientX||e.originalEvent.touches[0].clientX,e.clientY||e.originalEvent.clientY||e.originalEvent.touches[0].clientY]}catch(n){return["x","y"]}},f=function(e){return 0>e?0:e>100?100:e},g=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},v={disabled:"=?",min:"=",max:"=",modelMin:"=?",modelMax:"=?",onHandleDown:"&",onHandleUp:"&",orientation:"@",step:"@",decimalPlaces:"@",filter:"@",filterOptions:"@",showValues:"@",pinHandle:"@",preventEqualMinMax:"@",attachHandleValues:"@",getterSetter:"@"};return e&&(v.disabled="=",v.modelMin="=",v.modelMax="="),{restrict:"A",replace:!0,template:['<div class="ngrs-range-slider">','<div class="ngrs-runner">','<div class="ngrs-handle ngrs-handle-min"><i></i></div>','<div class="ngrs-handle ngrs-handle-max"><i></i></div>','<div class="ngrs-join"></div>',"</div>",'<div class="ngrs-value-runner">','<div class="ngrs-value ngrs-value-min" ng-show="showValues"><div>{{filteredModelMin}}</div></div>','<div class="ngrs-value ngrs-value-max" ng-show="showValues"><div>{{filteredModelMax}}</div></div>',"</div>","</div>"].join(""),scope:v,link:function(e,s,v,h){function p(n){return e.getterSetter?arguments.length?e.modelMin(n):e.modelMin():arguments.length?e.modelMin=n:e.modelMin}function M(n){return e.getterSetter?arguments.length?e.modelMax(n):e.modelMax():arguments.length?e.modelMax=n:e.modelMax}function x(e){"min"===e?(angular.element(E[0]).css("display","none"),angular.element(E[1]).css("display","block")):"max"===e?(angular.element(E[0]).css("display","block"),angular.element(E[1]).css("display","none")):(angular.element(E[0]).css("display","block"),angular.element(E[1]).css("display","block"))}function b(e){e?y.addClass("ngrs-disabled"):y.removeClass("ngrs-disabled")}function w(){e.min>e.max&&V("min must be less than or equal to max"),angular.isDefined(e.min)&&angular.isDefined(e.max)&&(g(e.min)||V("min must be a number"),g(e.max)||V("max must be a number"),j=e.max-e.min,k=[e.min,e.max],H())}function H(){if(p()>M()&&(D("modelMin must be less than or equal to modelMax"),p(M())),(angular.isDefined(p())||"min"===e.pinHandle)&&(angular.isDefined(M())||"max"===e.pinHandle)){g(p())||("min"!==e.pinHandle&&D("modelMin must be a number"),p(e.min)),g(M())||("max"!==e.pinHandle&&D("modelMax must be a number"),M(e.max));var n,i,l=f((p()-e.min)/j*100),t=f((M()-e.min)/j*100);if(e.attachHandleValues&&(n=l,i=t),p(Math.max(e.min,p())),M(Math.min(e.max,M())),e.filter&&e.filterOptions)e.filteredModelMin=a(e.filter)(p(),e.filterOptions),e.filteredModelMax=a(e.filter)(M(),e.filterOptions);else if(e.filter){var s,r,o=e.filter.split(":"),d=e.filter.split(":")[0],u=o.slice().slice(1);u=u.map(function(e){return g(e)?+e:'"'==e[0]&&'"'==e[e.length-1]||"'"==e[0]&&"'"==e[e.length-1]?e.slice(1,-1):void 0}),s=u.slice(),r=u.slice(),s.unshift(p()),r.unshift(M()),e.filteredModelMin=a(d).apply(null,s),e.filteredModelMax=a(d).apply(null,r)}else e.filteredModelMin=p(),e.filteredModelMax=M();e.min===e.max&&p()==M()?(angular.element(E[0]).css(C,"0%"),angular.element(E[1]).css(C,"100%"),e.attachHandleValues&&(angular.element(q[0]).css(C,"0%"),angular.element(q[1]).css(C,"100%")),angular.element(F).css(C,"0%").css(P,"0%")):(angular.element(E[0]).css(C,l+"%"),angular.element(E[1]).css(C,t+"%"),e.attachHandleValues&&(angular.element(q[0]).css(C,n+"%"),angular.element(q[1]).css(C,i+"%"),angular.element(q[1]).css(P,"auto")),angular.element(F).css(C,l+"%").css(P,100-t+"%"),l>95&&angular.element(E[0]).css("z-index",3))}}function $(a){var i=E[a];i.bind(r+"X",function(t){var s=(0===a?"ngrs-handle-min":"ngrs-handle-max")+"-down",r=(0===a?p():M())-e.min,u=r/j*100,m=c(t),g=m,v=!1;angular.isFunction(e.onHandleDown)&&e.onHandleDown(),angular.element("body").bind("selectstart"+l,function(){return!1}),e.disabled||(z=!0,i.addClass("ngrs-down"),y.addClass("ngrs-focus "+s),angular.element("body").addClass("ngrs-touching"),n.bind(o,function(n){n.preventDefault();var l,t,s=c(n),r=e.step/j*100,o=((0===a?M():p())-e.min)/j*100;"x"!==s[0]&&(s[0]-=m[0],s[1]-=m[1],l=[g[0]!==s[0],g[1]!==s[1]],t=u+100*s[S]/(S?y.height():y.width()),t=f(t),e.preventEqualMinMax&&(0===r&&(r=1/j*100),0===a?o-=r:1===a&&(o+=r)),0===a?t=t>o?o:t:1===a&&(t=o>t?o:t),e.step>0&&100>t&&t>0&&(t=Math.round(t/r)*r),t>95&&0===a?i.css("z-index",3):i.css("z-index",""),l[S]&&t!=v&&(0===a?p(parseFloat(parseFloat(t*j/100+e.min).toFixed(e.decimalPlaces))):1===a&&M(parseFloat(parseFloat(t*j/100+e.min).toFixed(e.decimalPlaces))),e.$apply(),v=t),g=s)}).bind(d,function(){angular.isFunction(e.onHandleUp)&&e.onHandleUp(),n.off(o),n.off(d),angular.element("body").removeClass("ngrs-touching"),z=!1,i.removeClass("ngrs-down"),i.removeClass("ngrs-over"),y.removeClass("ngrs-focus "+s)}))}).on(u,function(){i.addClass("ngrs-over")}).on(m,function(){z||i.removeClass("ngrs-over")})}function V(n){throw e.disabled=!0,new Error("RangeSlider: "+n)}function D(e){i.warn(e)}var y=angular.element(s),E=[s.find(".ngrs-handle-min"),s.find(".ngrs-handle-max")],q=[s.find(".ngrs-value-min"),s.find(".ngrs-value-max")],F=s.find(".ngrs-join"),C="left",P="right",S=0,k=[0,0],j=0,z=!1;e.filteredModelMin=p(),e.filteredModelMax=M(),v.$observe("disabled",function(n){angular.isDefined(n)||(e.disabled=t.disabled),e.$watch("disabled",b)}),v.$observe("orientation",function(n){angular.isDefined(n)||(e.orientation=t.orientation);for(var a,i=e.orientation.split(" "),l=0,s=i.length;s>l;l++)i[l]="ngrs-"+i[l];a=i.join(" "),y.addClass(a),"vertical"!==e.orientation&&"vertical left"!==e.orientation&&"vertical right"!==e.orientation||(C="top",P="bottom",S=1)}),v.$observe("step",function(n){angular.isDefined(n)||(e.step=t.step)}),v.$observe("decimalPlaces",function(n){angular.isDefined(n)||(e.decimalPlaces=t.decimalPlaces)}),v.$observe("showValues",function(n){angular.isDefined(n)?"false"===n?e.showValues=!1:e.showValues=!0:e.showValues=t.showValues}),v.$observe("pinHandle",function(n){angular.isDefined(n)&&("min"===n||"max"===n)?e.pinHandle=n:e.pinHandle=null,e.$watch("pinHandle",x)}),v.$observe("preventEqualMinMax",function(n){angular.isDefined(n)?"false"===n?e.preventEqualMinMax=!1:e.preventEqualMinMax=!0:e.preventEqualMinMax=t.preventEqualMinMax}),v.$observe("attachHandleValues",function(n){angular.isDefined(n)?"true"===n||""===n?(e.attachHandleValues=!0,s.find(".ngrs-value-runner").addClass("ngrs-attached-handles")):e.attachHandleValues=!1:e.attachHandleValues=t.attachHandleValues}),e.$watch("min",w),e.$watch("max",w),e.$watch(function(){return p()},H),e.$watch(function(){return M()},H),e.$on("$destroy",function(){y.off(l),angular.element("body").off(l),n.off(l);for(var e=0,a=E.length;a>e;e++)E[e].off(l),E[e].off(l+"X")}),y.bind("selectstart"+l,function(e){return!1}).bind("click",function(e){e.stopPropagation()}),$(0),$(1)}}}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()}();
!function(){var e=1===angular.version.major&&0===angular.version.minor;angular.module("ui-rangeSlider",[]).directive("rangeSlider",["$document","$filter","$log",function(n,a,i){var l=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup",over:"pointerdown",out:"mouseout"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",over:"MSPointerDown",out:"mouseout"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend",over:"mouseover touchstart",out:"mouseout"},t=l.start+".rangeSlider",r=l.move+".rangeSlider",s=l.end+".rangeSlider",o=l.over+".rangeSlider",d=l.out+".rangeSlider",u=function(e){try{return[e.clientX||e.originalEvent.clientX||e.originalEvent.touches[0].clientX,e.clientY||e.originalEvent.clientY||e.originalEvent.touches[0].clientY]}catch(n){return["x","y"]}},m=function(e){return 0>e?0:e>100?100:e},c=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},l={disabled:"=?",min:"=",max:"=",modelMin:"=?",modelMax:"=?",onHandleDown:"&",onHandleUp:"&",orientation:"@",step:"@",decimalPlaces:"@",filter:"@",filterOptions:"@",showValues:"@",pinHandle:"@",preventEqualMinMax:"@",attachHandleValues:"@",getterSetter:"@"};return e&&(l.disabled="=",l.modelMin="=",l.modelMax="="),{restrict:"A",replace:!0,template:'<div class="ngrs-range-slider"><div class="ngrs-runner"><div class="ngrs-handle ngrs-handle-min"><i></i></div><div class="ngrs-handle ngrs-handle-max"><i></i></div><div class="ngrs-join"></div></div><div class="ngrs-value-runner"><div class="ngrs-value ngrs-value-min" ng-show="showValues"><div>{{filteredModelMin}}</div></div><div class="ngrs-value ngrs-value-max" ng-show="showValues"><div>{{filteredModelMax}}</div></div></div></div>',scope:l,link:function(e,l,g,f){function v(n){return e.getterSetter?arguments.length?e.modelMin(n):e.modelMin():arguments.length?e.modelMin=n:e.modelMin}function h(n){return e.getterSetter?arguments.length?e.modelMax(n):e.modelMax():arguments.length?e.modelMax=n:e.modelMax}function p(e){"min"===e?(angular.element($[0]).css("display","none"),angular.element($[1]).css("display","block")):"max"===e?(angular.element($[0]).css("display","block"),angular.element($[1]).css("display","none")):(angular.element($[0]).css("display","block"),angular.element($[1]).css("display","block"))}function M(e){e?S.addClass("ngrs-disabled"):S.removeClass("ngrs-disabled")}function x(){e.min>e.max&&H("min must be less than or equal to max"),angular.isDefined(e.min)&&angular.isDefined(e.max)&&(c(e.min)||H("min must be a number"),c(e.max)||H("max must be a number"),E=e.max-e.min,b())}function b(){if(v()>h()&&(i.warn("modelMin must be less than or equal to modelMax"),v(h())),(angular.isDefined(v())||"min"===e.pinHandle)&&(angular.isDefined(h())||"max"===e.pinHandle)){c(v())||("min"!==e.pinHandle&&i.warn("modelMin must be a number"),v(e.min)),c(h())||("max"!==e.pinHandle&&i.warn("modelMax must be a number"),h(e.max));var n,l,t=m((v()-e.min)/E*100),r=m((h()-e.min)/E*100);if(e.attachHandleValues&&(n=t,l=r),v(Math.max(e.min,v())),h(Math.min(e.max,h())),e.filter&&e.filterOptions)e.filteredModelMin=a(e.filter)(v(),e.filterOptions),e.filteredModelMax=a(e.filter)(h(),e.filterOptions);else if(e.filter){var s=e.filter.split(":"),o=e.filter.split(":")[0],d=s.slice().slice(1),d=d.map(function(e){return c(e)?+e:'"'==e[0]&&'"'==e[e.length-1]||"'"==e[0]&&"'"==e[e.length-1]?e.slice(1,-1):void 0}),s=d.slice(),d=d.slice();s.unshift(v()),d.unshift(h()),e.filteredModelMin=a(o).apply(null,s),e.filteredModelMax=a(o).apply(null,d)}else e.filteredModelMin=v(),e.filteredModelMax=h();e.min===e.max&&v()==h()?(angular.element($[0]).css(F,"0%"),angular.element($[1]).css(F,"100%"),e.attachHandleValues&&(angular.element(D[0]).css(F,"0%"),angular.element(D[1]).css(F,"100%")),angular.element(y).css(F,"0%").css(C,"0%")):(angular.element($[0]).css(F,t+"%"),angular.element($[1]).css(F,r+"%"),e.attachHandleValues&&(angular.element(D[0]).css(F,n+"%"),angular.element(D[1]).css(F,l+"%"),angular.element(D[1]).css(C,"auto")),angular.element(y).css(F,t+"%").css(C,100-r+"%"),t>95&&angular.element($[0]).css("z-index",3))}}function w(a){var i=$[a];i.bind(t+"X",function(l){var t=(0===a?"ngrs-handle-min":"ngrs-handle-max")+"-down",o=((0===a?v():h())-e.min)/E*100,d=u(l),c=d,g=!1;angular.isFunction(e.onHandleDown)&&e.onHandleDown(),angular.element("body").bind("selectstart.rangeSlider",function(){return!1}),e.disabled||(q=!0,i.addClass("ngrs-down"),S.addClass("ngrs-focus "+t),angular.element("body").addClass("ngrs-touching"),n.bind(r,function(n){n.preventDefault(),n=u(n);var l,t,r=e.step/E*100,s=((0===a?h():v())-e.min)/E*100;"x"!==n[0]&&(n[0]-=d[0],n[1]-=d[1],l=[c[0]!==n[0],c[1]!==n[1]],t=o+100*n[V]/(V?S.height():S.width()),t=m(t),e.preventEqualMinMax&&(0===r&&(r=1/E*100),0===a?s-=r:1===a&&(s+=r)),0===a?t=t>s?s:t:1===a&&(t=s>t?s:t),0<e.step&&100>t&&t>0&&(t=Math.round(t/r)*r),t>95&&0===a?i.css("z-index",3):i.css("z-index",""),l[V]&&t!=g&&(0===a?v(parseFloat(parseFloat(t*E/100+e.min).toFixed(e.decimalPlaces))):1===a&&h(parseFloat(parseFloat(t*E/100+e.min).toFixed(e.decimalPlaces))),e.$apply(),g=t),c=n)}).bind(s,function(){angular.isFunction(e.onHandleUp)&&e.onHandleUp(),n.off(r),n.off(s),angular.element("body").removeClass("ngrs-touching"),q=!1,i.removeClass("ngrs-down"),i.removeClass("ngrs-over"),S.removeClass("ngrs-focus "+t)}))}).on(o,function(){i.addClass("ngrs-over")}).on(d,function(){q||i.removeClass("ngrs-over")})}function H(n){throw e.disabled=!0,Error("RangeSlider: "+n)}var S=angular.element(l),$=[l.find(".ngrs-handle-min"),l.find(".ngrs-handle-max")],D=[l.find(".ngrs-value-min"),l.find(".ngrs-value-max")],y=l.find(".ngrs-join"),F="left",C="right",V=0,E=0,q=!1;e.filteredModelMin=v(),e.filteredModelMax=h(),g.$observe("disabled",function(n){angular.isDefined(n)||(e.disabled=!1),e.$watch("disabled",M)}),g.$observe("orientation",function(n){angular.isDefined(n)||(e.orientation="horizontal"),n=e.orientation.split(" ");for(var a=0,i=n.length;i>a;a++)n[a]="ngrs-"+n[a];n=n.join(" "),S.addClass(n),"vertical"!==e.orientation&&"vertical left"!==e.orientation&&"vertical right"!==e.orientation||(F="top",C="bottom",V=1)}),g.$observe("step",function(n){angular.isDefined(n)||(e.step=0)}),g.$observe("decimalPlaces",function(n){angular.isDefined(n)||(e.decimalPlaces=0)}),g.$observe("showValues",function(n){angular.isDefined(n)?e.showValues="false"!==n:e.showValues=!0}),g.$observe("pinHandle",function(n){angular.isDefined(n)?e.pinHandle="min"===n||"max"===n?n:null:e.pinHandle=null,e.$watch("pinHandle",p)}),g.$observe("preventEqualMinMax",function(n){angular.isDefined(n)?e.preventEqualMinMax="false"!==n:e.preventEqualMinMax=!1}),g.$observe("attachHandleValues",function(n){angular.isDefined(n)&&("true"===n||""===n)?(e.attachHandleValues=!0,l.find(".ngrs-value-runner").addClass("ngrs-attached-handles")):e.attachHandleValues=!1}),e.$watch("min",x),e.$watch("max",x),e.$watch(function(){return v()},b),e.$watch(function(){return h()},b),e.$on("$destroy",function(){S.off(".rangeSlider"),angular.element("body").off(".rangeSlider"),n.off(".rangeSlider");for(var e=0,a=$.length;a>e;e++)$[e].off(".rangeSlider"),$[e].off(".rangeSliderX")}),S.bind("selectstart.rangeSlider",function(e){return!1}).bind("click",function(e){e.stopPropagation()}),w(0),w(1)}}}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()}();
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,o=this;t(this).one("bsTransitionEnd",function(){i=!0});var s=function(){i||t(o).trigger(t.support.transition.end)};return setTimeout(s,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),s=i.data("bs.alert");s||i.data("bs.alert",s=new o(this)),"string"==typeof e&&s[e].call(i)})}var i='[data-dismiss="alert"]',o=function(e){t(e).on("click",i,this.close)};o.VERSION="3.3.1",o.TRANSITION_DURATION=150,o.prototype.close=function(e){function i(){a.detach().trigger("closed.bs.alert").remove()}var s=t(this),n=s.attr("data-target");n||(n=s.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,""));var a=t(n);e&&e.preventDefault(),a.length||(a=s.closest(".alert")),a.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),t.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",i).emulateTransitionEnd(o.TRANSITION_DURATION):i())};var s=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=o,t.fn.alert.noConflict=function(){return t.fn.alert=s,this},t(document).on("click.bs.alert.data-api",i,o.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),s=o.data("bs.button"),n="object"==typeof e&&e;s||o.data("bs.button",s=new i(this,n)),"toggle"==e?s.toggle():e&&s.setState(e)})}var i=function(e,o){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,o),this.isLoading=!1};i.VERSION="3.3.1",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",o=this.$element,s=o.is("input")?"val":"html",n=o.data();e+="Text",null==n.resetText&&o.data("resetText",o[s]()),setTimeout(t.proxy(function(){o[s](null==n[e]?this.options[e]:n[e]),"loadingText"==e?(this.isLoading=!0,o.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,o.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));t&&this.$element.toggleClass("active")};var o=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=o,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var o=t(i.target);o.hasClass("btn")||(o=o.closest(".btn")),e.call(o,"toggle"),i.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),s=o.data("bs.carousel"),n=t.extend({},i.DEFAULTS,o.data(),"object"==typeof e&&e),a="string"==typeof e?e:n.slide;s||o.data("bs.carousel",s=new i(this,n)),"number"==typeof e?s.to(e):a?s[a]():n.interval&&s.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.1",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i="prev"==t?-1:1,o=this.getItemIndex(e),s=(o+i)%this.$items.length;return this.$items.eq(s)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(e,o){var s=this.$element.find(".item.active"),n=o||this.getItemForDirection(e,s),a=this.interval,r="next"==e?"left":"right",l="next"==e?"first":"last",h=this;if(!n.length){if(!this.options.wrap)return;n=this.$element.find(".item")[l]()}if(n.hasClass("active"))return this.sliding=!1;var d=n[0],p=t.Event("slide.bs.carousel",{relatedTarget:d,direction:r});if(this.$element.trigger(p),!p.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var c=t(this.$indicators.children()[this.getItemIndex(n)]);c&&c.addClass("active")}var f=t.Event("slid.bs.carousel",{relatedTarget:d,direction:r});return t.support.transition&&this.$element.hasClass("slide")?(n.addClass(e),n[0].offsetWidth,s.addClass(r),n.addClass(r),s.one("bsTransitionEnd",function(){n.removeClass([e,r].join(" ")).addClass("active"),s.removeClass(["active",r].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(f)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(s.removeClass("active"),n.addClass("active"),this.sliding=!1,this.$element.trigger(f)),a&&this.cycle(),this}};var o=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=o,this};var s=function(i){var o,s=t(this),n=t(s.attr("data-target")||(o=s.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,""));if(n.hasClass("carousel")){var a=t.extend({},n.data(),s.data()),r=s.attr("data-slide-to");r&&(a.interval=!1),e.call(n,a),r&&n.data("bs.carousel").to(r),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",s).on("click.bs.carousel.data-api","[data-slide-to]",s),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),+function(t){"use strict";function e(e){var i,o=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(o)}function i(e){return this.each(function(){var i=t(this),s=i.data("bs.collapse"),n=t.extend({},o.DEFAULTS,i.data(),"object"==typeof e&&e);!s&&n.toggle&&"show"==e&&(n.toggle=!1),s||i.data("bs.collapse",s=new o(this,n)),"string"==typeof e&&s[e]()})}var o=function(e,i){this.$element=t(e),this.options=t.extend({},o.DEFAULTS,i),this.$trigger=t(this.options.trigger).filter('[href="#'+e.id+'"], [data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};o.VERSION="3.3.1",o.TRANSITION_DURATION=350,o.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},o.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},o.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,s=this.$parent&&this.$parent.find("> .panel").children(".in, .collapsing");if(!(s&&s.length&&(e=s.data("bs.collapse"),e&&e.transitioning))){var n=t.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){s&&s.length&&(i.call(s,"hide"),e||s.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return r.call(this);var l=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(o.TRANSITION_DURATION)[a](this.$element[0][l])}}}},o.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[i](0).one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(o.TRANSITION_DURATION):s.call(this)}}},o.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},o.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,o){var s=t(o);this.addAriaAndCollapsedClass(e(s),s)},this)).end()},o.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var s=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=o,t.fn.collapse.noConflict=function(){return t.fn.collapse=s,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(o){var s=t(this);s.attr("data-target")||o.preventDefault();var n=e(s),a=n.data("bs.collapse"),r=a?"toggle":t.extend({},s.data(),{trigger:this});i.call(n,r)})}(jQuery),+function(t){"use strict";function e(e){e&&3===e.which||(t(s).remove(),t(n).each(function(){var o=t(this),s=i(o),n={relatedTarget:this};s.hasClass("open")&&(s.trigger(e=t.Event("hide.bs.dropdown",n)),e.isDefaultPrevented()||(o.attr("aria-expanded","false"),s.removeClass("open").trigger("hidden.bs.dropdown",n)))}))}function i(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var o=i&&t(i);return o&&o.length?o:e.parent()}function o(e){return this.each(function(){var i=t(this),o=i.data("bs.dropdown");o||i.data("bs.dropdown",o=new a(this)),"string"==typeof e&&o[e].call(i)})}var s=".dropdown-backdrop",n='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.1",a.prototype.toggle=function(o){var s=t(this);if(!s.is(".disabled, :disabled")){var n=i(s),a=n.hasClass("open");if(e(),!a){"ontouchstart"in document.documentElement&&!n.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var r={relatedTarget:this};if(n.trigger(o=t.Event("show.bs.dropdown",r)),o.isDefaultPrevented())return;s.trigger("focus").attr("aria-expanded","true"),n.toggleClass("open").trigger("shown.bs.dropdown",r)}return!1}},a.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var o=t(this);if(e.preventDefault(),e.stopPropagation(),!o.is(".disabled, :disabled")){var s=i(o),a=s.hasClass("open");if(!a&&27!=e.which||a&&27==e.which)return 27==e.which&&s.find(n).trigger("focus"),o.trigger("click");var r=" li:not(.divider):visible a",l=s.find('[role="menu"]'+r+', [role="listbox"]'+r);if(l.length){var h=l.index(e.target);38==e.which&&h>0&&h--,40==e.which&&h<l.length-1&&h++,~h||(h=0),l.eq(h).trigger("focus")}}}};var r=t.fn.dropdown;t.fn.dropdown=o,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",n,a.prototype.toggle).on("keydown.bs.dropdown.data-api",n,a.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',a.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',a.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e,o){return this.each(function(){var s=t(this),n=s.data("bs.modal"),a=t.extend({},i.DEFAULTS,s.data(),"object"==typeof e&&e);n||s.data("bs.modal",n=new i(this,a)),"string"==typeof e?n[e](o):a.show&&n.show(o)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.3.1",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var o=this,s=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop(function(){var s=t.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(o.$body),o.$element.show().scrollTop(0),o.options.backdrop&&o.adjustBackdrop(),o.adjustDialog(),s&&o.$element[0].offsetWidth,o.$element.addClass("in").attr("aria-hidden",!1),o.enforceFocus();var n=t.Event("shown.bs.modal",{relatedTarget:e});s?o.$element.find(".modal-dialog").one("bsTransitionEnd",function(){o.$element.trigger("focus").trigger(n)}).emulateTransitionEnd(i.TRANSITION_DURATION):o.$element.trigger("focus").trigger(n)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var o=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&s;if(this.$backdrop=t('<div class="modal-backdrop '+s+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",t.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){o.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},i.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},i.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var o=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=o,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var o=t(this),s=o.attr("href"),n=t(o.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),a=n.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(s)&&s},n.data(),o.data());o.is("a")&&i.preventDefault(),n.one("show.bs.modal",function(t){t.isDefaultPrevented()||n.one("hidden.bs.modal",function(){o.is(":visible")&&o.trigger("focus")})}),e.call(n,a,this)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),s=o.data("bs.tooltip"),n="object"==typeof e&&e,a=n&&n.selector;(s||"destroy"!=e)&&(a?(s||o.data("bs.tooltip",s={}),s[a]||(s[a]=new i(this,n))):s||o.data("bs.tooltip",s=new i(this,n)),"string"==typeof e&&s[e]())})}var i=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};i.VERSION="3.3.1",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(e,i,o){this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport);for(var s=this.options.trigger.split(" "),n=s.length;n--;){var a=s[n];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},i.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},i.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i&&i.$tip&&i.$tip.is(":visible")?void(i.hoverState="in"):(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var o=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!o)return;var s=this,n=this.tip(),a=this.getUID(this.type);this.setContent(),n.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&n.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,h=l.test(r);h&&(r=r.replace(l,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var d=this.getPosition(),p=n[0].offsetWidth,c=n[0].offsetHeight;if(h){var f=r,u=this.options.container?t(this.options.container):this.$element.parent(),g=this.getPosition(u);r="bottom"==r&&d.bottom+c>g.bottom?"top":"top"==r&&d.top-c<g.top?"bottom":"right"==r&&d.right+p>g.width?"left":"left"==r&&d.left-p<g.left?"right":r,n.removeClass(f).addClass(r)}var v=this.getCalculatedOffset(r,d,p,c);this.applyPlacement(v,r);var m=function(){var t=s.hoverState;s.$element.trigger("shown.bs."+s.type),s.hoverState=null,"out"==t&&s.leave(s)};t.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",m).emulateTransitionEnd(i.TRANSITION_DURATION):m()}},i.prototype.applyPlacement=function(e,i){var o=this.tip(),s=o[0].offsetWidth,n=o[0].offsetHeight,a=parseInt(o.css("margin-top"),10),r=parseInt(o.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top=e.top+a,e.left=e.left+r,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var l=o[0].offsetWidth,h=o[0].offsetHeight;"top"==i&&h!=n&&(e.top=e.top+n-h);var d=this.getViewportAdjustedDelta(i,e,l,h);d.left?e.left+=d.left:e.top+=d.top;var p=/top|bottom/.test(i),c=p?2*d.left-s+l:2*d.top-n+h,f=p?"offsetWidth":"offsetHeight";o.offset(e),this.replaceArrow(c,o[0][f],p)},i.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},i.prototype.hide=function(e){function o(){"in"!=s.hoverState&&n.detach(),s.$element.removeAttr("aria-describedby").trigger("hidden.bs."+s.type),e&&e()}var s=this,n=this.tip(),a=t.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(n.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",o).emulateTransitionEnd(i.TRANSITION_DURATION):o(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],o="BODY"==i.tagName,s=i.getBoundingClientRect();null==s.width&&(s=t.extend({},s,{width:s.right-s.left,height:s.bottom-s.top}));var n=o?{top:0,left:0}:e.offset(),a={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},r=o?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},s,a,r,n)},i.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},i.prototype.getViewportAdjustedDelta=function(t,e,i,o){var s={top:0,left:0};if(!this.$viewport)return s;var n=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-n-a.scroll,l=e.top+n-a.scroll+o;r<a.top?s.top=a.top-r:l>a.top+a.height&&(s.top=a.top+a.height-l)}else{var h=e.left-n,d=e.left+n+i;h<a.left?s.left=a.left-h:d>a.width&&(s.left=a.left+a.width-d)}return s},i.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},i.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},i.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(e){var i=this;e&&(i=t(e.currentTarget).data("bs."+this.type),i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type)})};var o=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=i,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=o,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),s=o.data("bs.popover"),n="object"==typeof e&&e,a=n&&n.selector;(s||"destroy"!=e)&&(a?(s||o.data("bs.popover",s={}),s[a]||(s[a]=new i(this,n))):s||o.data("bs.popover",s=new i(this,n)),"string"==typeof e&&s[e]())})}var i=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.3.1",i.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},i.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var o=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=i,t.fn.popover.noConflict=function(){return t.fn.popover=o,this}}(jQuery),+function(t){"use strict";function e(i,o){var s=t.proxy(this.process,this);this.$body=t("body"),this.$scrollElement=t(t(i).is("body")?window:i),this.options=t.extend({},e.DEFAULTS,o),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",s),this.refresh(),this.process()}function i(i){return this.each(function(){var o=t(this),s=o.data("bs.scrollspy"),n="object"==typeof i&&i;s||o.data("bs.scrollspy",s=new e(this,n)),"string"==typeof i&&s[i]()})}e.VERSION="3.3.1",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e="offset",i=0;t.isWindow(this.$scrollElement[0])||(e="position",i=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var o=this;this.$body.find(this.selector).map(function(){var o=t(this),s=o.data("target")||o.attr("href"),n=/^#./.test(s)&&t(s);return n&&n.length&&n.is(":visible")&&[[n[e]().top+i,s]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){o.offsets.push(this[0]),o.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),o=this.options.offset+i-this.$scrollElement.height(),s=this.offsets,n=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=o)return a!=(t=n[n.length-1])&&this.activate(t);if(a&&e<s[0])return this.activeTarget=null,this.clear();for(t=s.length;t--;)a!=n[t]&&e>=s[t]&&(!s[t+1]||e<=s[t+1])&&this.activate(n[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',o=t(i).parents("li").addClass("active");o.parent(".dropdown-menu").length&&(o=o.closest("li.dropdown").addClass("active")),o.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var o=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=o,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);i.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),s=o.data("bs.tab");s||o.data("bs.tab",s=new i(this)),"string"==typeof e&&s[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.3.1",i.TRANSITION_DURATION=150,i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),o=e.data("target");if(o||(o=e.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var s=i.find(".active:last a"),n=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:s[0]});if(s.trigger(n),e.trigger(a),!a.isDefaultPrevented()&&!n.isDefaultPrevented()){var r=t(o);this.activate(e.closest("li"),i),this.activate(r,r.parent(),function(){s.trigger({type:"hidden.bs.tab",
relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:s[0]})})}}},i.prototype.activate=function(e,o,s){function n(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),r?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),s&&s()}var a=o.find("> .active"),r=s&&t.support.transition&&(a.length&&a.hasClass("fade")||!!o.find("> .fade").length);a.length&&r?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n(),a.removeClass("in")};var o=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=o,this};var s=function(i){i.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',s).on("click.bs.tab.data-api",'[data-toggle="pill"]',s)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var o=t(this),s=o.data("bs.affix"),n="object"==typeof e&&e;s||o.data("bs.affix",s=new i(this,n)),"string"==typeof e&&s[e]()})}var i=function(e,o){this.options=t.extend({},i.DEFAULTS,o),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.3.1",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,o){var s=this.$target.scrollTop(),n=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed)return i>s?"top":!1;if("bottom"==this.affixed)return null!=i?s+this.unpin<=n.top?!1:"bottom":t-o>=s+a?!1:"bottom";var r=null==this.affixed,l=r?s:n.top,h=r?a:e;return null!=i&&i>=l?"top":null!=o&&l+h>=t-o?"bottom":!1},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),o=this.options.offset,s=o.top,n=o.bottom,a=t("body").height();"object"!=typeof o&&(n=s=o),"function"==typeof s&&(s=o.top(this.$element)),"function"==typeof n&&(n=o.bottom(this.$element));var r=this.getState(a,e,s,n);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");var l="affix"+(r?"-"+r:""),h=t.Event(l+".bs.affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:a-e-n})}};var o=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),o=i.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),e.call(i,o)})})}(jQuery);
!function(t,e){"use strict";function a(e){e=t.extend({},v,e||{}),null===f&&(f=t("body"));for(var a=t(this),n=0,r=a.length;r>n;n++)o(a.eq(n),e);return a}function o(a,o){if(!a.hasClass(p.base)){o=t.extend({},o,a.data(u+"-options"));var i="";i+='<div class="'+p.bar+'">',i+='<div class="'+p.track+'">',i+='<div class="'+p.handle+'">',i+="</div></div></div>",o.paddingRight=parseInt(a.css("padding-right"),10),o.paddingBottom=parseInt(a.css("padding-bottom"),10),a.addClass([p.base,o.customClass].join(" ")).wrapInner('<div class="'+p.content+'" />').prepend(i),o.horizontal&&a.addClass(p.isHorizontal);var s=t.extend({$scroller:a,$content:a.find(d(p.content)),$bar:a.find(d(p.bar)),$track:a.find(d(p.track)),$handle:a.find(d(p.handle))},o);s.trackMargin=parseInt(s.trackMargin,10),s.$content.on("scroll."+u,s,n),s.$scroller.on(g.start,d(p.track),s,r).on(g.start,d(p.handle),s,l).data(u,s),m.reset.apply(a),t(e).one("load",function(){m.reset.apply(a)})}}function n(t){t.preventDefault(),t.stopPropagation();var e=t.data,a={};if(e.horizontal){var o=e.$content.scrollLeft();0>o&&(o=0);var n=o/e.scrollRatio;n>e.handleBounds.right&&(n=e.handleBounds.right),a={left:n}}else{var r=e.$content.scrollTop();0>r&&(r=0);var l=r/e.scrollRatio;l>e.handleBounds.bottom&&(l=e.handleBounds.bottom),a={top:l}}e.$handle.css(a)}function r(t){t.preventDefault(),t.stopPropagation();var e=t.data,a=t.originalEvent,o=e.$track.offset(),n="undefined"!=typeof a.targetTouches?a.targetTouches[0]:null,r=n?n.pageX:t.clientX,l=n?n.pageY:t.clientY;e.horizontal?(e.mouseStart=r,e.handleLeft=r-o.left-e.handleWidth/2,h(e,e.handleLeft)):(e.mouseStart=l,e.handleTop=l-o.top-e.handleHeight/2,h(e,e.handleTop)),i(e)}function l(t){t.preventDefault(),t.stopPropagation();var e=t.data,a=t.originalEvent,o="undefined"!=typeof a.targetTouches?a.targetTouches[0]:null,n=o?o.pageX:t.clientX,r=o?o.pageY:t.clientY;e.horizontal?(e.mouseStart=n,e.handleLeft=parseInt(e.$handle.css("left"),10)):(e.mouseStart=r,e.handleTop=parseInt(e.$handle.css("top"),10)),i(e)}function i(t){t.$content.off(d(u)),f.on(g.move,t,s).on(g.end,t,c)}function s(t){t.preventDefault(),t.stopPropagation();var e=t.data,a=t.originalEvent,o=0,n=0,r="undefined"!=typeof a.targetTouches?a.targetTouches[0]:null,l=r?r.pageX:t.clientX,i=r?r.pageY:t.clientY;e.horizontal?(n=e.mouseStart-l,o=e.handleLeft-n):(n=e.mouseStart-i,o=e.handleTop-n),h(e,o)}function c(t){t.preventDefault(),t.stopPropagation();var e=t.data;e.$content.on("scroll.scroller",e,n),f.off(".scroller")}function h(t,e){var a={};if(t.horizontal){e<t.handleBounds.left&&(e=t.handleBounds.left),e>t.handleBounds.right&&(e=t.handleBounds.right);var o=Math.round(e*t.scrollRatio);a={left:e},t.$content.scrollLeft(o)}else{e<t.handleBounds.top&&(e=t.handleBounds.top),e>t.handleBounds.bottom&&(e=t.handleBounds.bottom);var n=Math.round(e*t.scrollRatio);a={top:e},t.$content.scrollTop(n)}t.$handle.css(a)}function d(t){return"."+t}var u="scroller",f=null,p={base:"scroller",content:"scroller-content",bar:"scroller-bar",track:"scroller-track",handle:"scroller-handle",isHorizontal:"scroller-horizontal",isSetup:"scroller-setup",isActive:"scroller-active"},g={start:"touchstart."+u+" mousedown."+u,move:"touchmove."+u+" mousemove."+u,end:"touchend."+u+" mouseup."+u},v={customClass:"",duration:0,handleSize:0,horizontal:!1,trackMargin:0},m={defaults:function(e){return v=t.extend(v,e||{}),"object"==typeof this?t(this):!0},destroy:function(){return t(this).each(function(e,a){var o=t(a).data(u);o&&(o.$scroller.removeClass([o.customClass,p.base,p.isActive].join(" ")),o.$bar.remove(),o.$content.contents().unwrap(),o.$content.off(d(u)),o.$scroller.off(d(u)).removeData(u))})},scroll:function(e,a){return t(this).each(function(){var o=t(this).data(u),n=a||v.duration;if("number"!=typeof e){var r=t(e);if(r.length>0){var l=r.position();e=o.horizontal?l.left+o.$content.scrollLeft():l.top+o.$content.scrollTop()}else e=o.$content.scrollTop()}var i=o.horizontal?{scrollLeft:e}:{scrollTop:e};o.$content.stop().animate(i,n)})},reset:function(){return t(this).each(function(){var e=t(this).data(u);if(e){e.$scroller.addClass(p.isSetup);var a={},o={},n={},r=0,l=!0;if(e.horizontal){e.barHeight=e.$content[0].offsetHeight-e.$content[0].clientHeight,e.frameWidth=e.$content.outerWidth(),e.trackWidth=e.frameWidth-2*e.trackMargin,e.scrollWidth=e.$content[0].scrollWidth,e.ratio=e.trackWidth/e.scrollWidth,e.trackRatio=e.trackWidth/e.scrollWidth,e.handleWidth=e.handleSize>0?e.handleSize:e.trackWidth*e.trackRatio,e.scrollRatio=(e.scrollWidth-e.frameWidth)/(e.trackWidth-e.handleWidth),e.handleBounds={left:0,right:e.trackWidth-e.handleWidth},e.$content.css({paddingBottom:e.barHeight+e.paddingBottom});var i=e.$content.scrollLeft();r=i*e.ratio,l=e.scrollWidth<=e.frameWidth,a={width:e.frameWidth},o={width:e.trackWidth,marginLeft:e.trackMargin,marginRight:e.trackMargin},n={width:e.handleWidth}}else{e.barWidth=e.$content[0].offsetWidth-e.$content[0].clientWidth,e.frameHeight=e.$content.outerHeight(),e.trackHeight=e.frameHeight-2*e.trackMargin,e.scrollHeight=e.$content[0].scrollHeight,e.ratio=e.trackHeight/e.scrollHeight,e.trackRatio=e.trackHeight/e.scrollHeight,e.handleHeight=e.handleSize>0?e.handleSize:e.trackHeight*e.trackRatio,e.scrollRatio=(e.scrollHeight-e.frameHeight)/(e.trackHeight-e.handleHeight),e.handleBounds={top:0,bottom:e.trackHeight-e.handleHeight};var s=e.$content.scrollTop();r=s*e.ratio,l=e.scrollHeight<=e.frameHeight,a={height:e.frameHeight},o={height:e.trackHeight,marginBottom:e.trackMargin,marginTop:e.trackMargin},n={height:e.handleHeight}}l?e.$scroller.removeClass(p.isActive):e.$scroller.addClass(p.isActive),e.$bar.css(a),e.$track.css(o),e.$handle.css(n),h(e,r),e.$scroller.removeClass(p.isSetup)}})}};t.fn[u]=function(t){return m[t]?m[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?this:a.apply(this,arguments)},t[u]=function(t){"defaults"===t&&m.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery);
!function(e,t,i,o){var n=e(t);e.fn.lazyload=function(r){function f(){var t=0;l.each(function(){var i=e(this);if(!h.skip_invisible||i.is(":visible"))if(e.abovethetop(this,h)||e.leftofbegin(this,h));else if(e.belowthefold(this,h)||e.rightoffold(this,h)){if(++t>h.failure_limit)return!1}else i.trigger("appear"),t=0})}var a,l=this,h={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return r&&(o!==r.failurelimit&&(r.failure_limit=r.failurelimit,delete r.failurelimit),o!==r.effectspeed&&(r.effect_speed=r.effectspeed,delete r.effectspeed),e.extend(h,r)),a=h.container===o||h.container===t?n:e(h.container),0===h.event.indexOf("scroll")&&a.bind(h.event,function(){return f()}),this.each(function(){var t=this,i=e(t);t.loaded=!1,(i.attr("src")===o||i.attr("src")===!1)&&i.is("img")&&i.attr("src",h.placeholder),i.one("appear",function(){if(!this.loaded){if(h.appear){var o=l.length;h.appear.call(t,o,h)}e("<img />").bind("load",function(){var o=i.attr("data-"+h.data_attribute);i.hide(),i.is("img")?i.attr("src",o):i.css("background-image","url('"+o+"')"),i[h.effect](h.effect_speed),t.loaded=!0;var n=e.grep(l,function(e){return!e.loaded});if(l=e(n),h.load){var r=l.length;h.load.call(t,r,h)}}).attr("src",i.attr("data-"+h.data_attribute))}}),0!==h.event.indexOf("scroll")&&i.bind(h.event,function(){t.loaded||i.trigger("appear")})}),n.bind("resize",function(){f()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&n.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&l.each(function(){e(this).trigger("appear")})}),e(i).ready(function(){f()}),this},e.belowthefold=function(i,r){var f;return f=r.container===o||r.container===t?(t.innerHeight?t.innerHeight:n.height())+n.scrollTop():e(r.container).offset().top+e(r.container).height(),f<=e(i).offset().top-r.threshold},e.rightoffold=function(i,r){var f;return f=r.container===o||r.container===t?n.width()+n.scrollLeft():e(r.container).offset().left+e(r.container).width(),f<=e(i).offset().left-r.threshold},e.abovethetop=function(i,r){var f;return f=r.container===o||r.container===t?n.scrollTop():e(r.container).offset().top,f>=e(i).offset().top+r.threshold+e(i).height()},e.leftofbegin=function(i,r){var f;return f=r.container===o||r.container===t?n.scrollLeft():e(r.container).offset().left,f>=e(i).offset().left+r.threshold+e(i).width()},e.inviewport=function(t,i){return!(e.rightoffold(t,i)||e.leftofbegin(t,i)||e.belowthefold(t,i)||e.abovethetop(t,i))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window,document);
directoryPrefix="/blake",angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(e,t,r,n){}]).directive("carousel",[function(){return{}}]),angular.module("blake",["ngRoute","ngSanitize","ui-rangeSlider","ui.bootstrap","ng-sortable","FBAngular","ngAnimate","ngStorage"]).factory("GenericService",function(){return function(e){return{create:function(t){var r,n;if(t.length)for(n=[],r=0;r<t.length;r++)n.push(e(t[r]));else n=e(t);return n}}}}).factory("BlakeObject",["GenericService",function(e){var t=function(e,t,r,n){if(angular.isArray(e))angular.forEach(e,function(e,o){if(angular.isArray(e.l))angular.forEach(e.l,function(e,o){var i=angular.isDefined(e["@indent"])?e["@indent"]:0;t.push({indent:i,text:e["#text"],lineNum:e["@n"],justify:e["@justify"],type:r,colnum:n})});else{var i=angular.isDefined(e.l["@indent"])?e.l["@indent"]:0;angular.isDefined(e.l.physnumber)?t.push({indent:i,text:e.l.physnumber["#text"],lineNum:e.l["@n"],justify:e.l["@justify"],type:r,colnum:n}):angular.isDefined(e.l.catchword)?t.push({indent:i,text:e.l.catchword["#text"],lineNum:e.l["@n"],justify:e.l["@justify"],type:r,colnum:n}):t.push({indent:i,text:e.l["#text"],lineNum:e.l["@n"],justify:e.l["@justify"],type:r,colnum:n})}});else if(angular.isArray(e.l))angular.forEach(e.l,function(e,o){var i=angular.isDefined(e["@indent"])?e["@indent"]:0;t.push({indent:i,text:e["#text"],lineNum:e["@n"],justify:e["@justify"],type:r,colnum:n})});else{var o=angular.isDefined(e.l["@indent"])?e.l["@indent"]:0;angular.isDefined(e.l.physnumber)?t.push({indent:o,text:e.l.physnumber["#text"],lineNum:e.l["@n"],justify:e.l["@justify"],type:r,colnum:n}):angular.isDefined(e.l.catchword)?t.push({indent:o,text:e.l.catchword["#text"],lineNum:e.l["@n"],justify:e.l["@justify"],type:r,colnum:n}):t.push({indent:o,text:e.l["#text"],lineNum:e.l["@n"],justify:e.l["@justify"],type:r,colnum:n})}},r=function(e){var r=angular.copy(e);if(r){if(r.illustration_description=angular.fromJson(e.illustration_description),r.characteristics=angular.fromJson(e.characteristics),r.text=angular.fromJson(e.text),r.notes=angular.fromJson(e.notes),r.lines=[],angular.isObject(r.text)){if(angular.isDefined(r.text.texthead)&&t(r.text.texthead,r.lines,"header",0),angular.isDefined(r.text.columns)){var n=1;angular.forEach(r.text.columns.column,function(e,o){angular.isDefined(e.texthead)&&t(e.texthead,r.lines,"header",n),angular.isDefined(e.lg)&&t(e.lg,r.lines,"body",n),angular.isDefined(e.textfoot)&&t(e.textfoot,r.lines,"footer",n),n++})}angular.isDefined(r.text.lg)&&t(r.text.lg,r.lines,"body",0),angular.isDefined(r.text.textfoot)&&t(r.text.textfoot,r.lines,n)}return r.lines.sort(function(e,t){return e.lineNum>t.lineNum?1:e.lineNum<t.lineNum?-1:0}),r.header=angular.fromJson(e.header),r.source=angular.fromJson(e.source),r}};return e(r)}]).factory("BlakeCopy",["BlakeObject","GenericService",function(e,t){var r=function(e){var t=angular.copy(e);switch(t.header=angular.fromJson(e.header),t.source=angular.fromJson(e.source),t.archive_copy_id){case"biblicalwc":case"biblicaltemperas":case"but543":case"letters":case"gravepd":case"gravewc":case"cpd":case"allegropenseroso":t.virtual=!0;break;default:t.virtual=!1}return t};return t(r)}]).factory("BlakeWork",["BlakeCopy","GenericService",function(e,t){var r=function(e){var t=angular.copy(e);switch(t.menuTitle=t.title,t.bad_id){case"biblicalwc":t.title="Water Color Drawings Illustrating the Bible",t.virtual=!0;break;case"biblicaltemperas":t.title="Paintings Illustrating the Bible",t.virtual=!0;break;case"but543":t.title="Illustrations to Milton's \"On the Morning of Christ's Nativity\"",t.virtual=!0;break;case"letters":case"gravepd":case"gravewc":case"cpd":case"allegropenseroso":t.virtual=!0;break;default:t.virtual=!1}return t};return t(r)}]).factory("BlakeFeaturedWork",["GenericService",function(e){var t=function(e){return angular.copy(e)};return e(t)}]).factory("BlakeDataService",["$http","$q","$rootScope","BlakeWork","BlakeCopy","BlakeObject","BlakeFeaturedWork","$localStorage",function(e,t,r,n,o,i,c,l){var s={};return s.query=function(r){var n=directoryPrefix+"/api/query";return t(function(t,o){e.post(n,r).success(function(e){t(e)}).error(function(e,t){o(e,t)})})},s.getObject=function(r){console.log("getting object");var n=directoryPrefix+"/api/object/"+r;return t(function(t,r){e.get(n).success(function(e){t(i.create(e))}).error(function(e,t){r(e,t)})})},s.getObjects=function(r){console.log("getting objects");var n=directoryPrefix+"/api/object/";return t(function(t,o){e.get(n,{params:{object_ids:r.join()}}).success(function(e){t(i.create(e.results))}).error(function(e,t){o(e,t)})})},s.getObjectsWithSameMotif=function(r){console.log("getting same motif");var n=directoryPrefix+"/api/object/"+r+"/objects_with_same_motif";return t(function(t,r){e.get(n).success(function(e){angular.isDefined(e.results)&&t(i.create(e.results))}).error(function(e,t){r(e,t)})})},s.getObjectsFromSameMatrix=function(r){console.log("getting same matrix");var n=directoryPrefix+"/api/object/"+r+"/objects_from_same_matrix";return t(function(t,r){e.get(n).success(function(e){angular.isDefined(e.results)&&t(i.create(e.results))}).error(function(e,t){r(e,t)})})},s.getObjectsFromSameProductionSequence=function(r){console.log("getting same production");var n=directoryPrefix+"/api/object/"+r+"/objects_from_same_production_sequence";return t(function(t,r){e.get(n).success(function(e){angular.isDefined(e.results)&&t(i.create(e.results))}).error(function(e,t){r(e,t)})})},s.getCopy=function(r){console.log("getting copy");var n=directoryPrefix+"/api/copy/"+r;return t(function(t,r){e.get(n).success(function(e){t(o.create(e))}).error(function(e,t){r(e,t)})})},s.getCopies=function(r){console.log("getting copies");var n=directoryPrefix+"/api/copy/";return t(function(t,i){e.get(n,{params:{bad_ids:r.join()}}).success(function(e){t(o.create(e.results))}).error(function(e,t){i(e,t)})})},s.getObjectsForCopy=function(r){console.log("getting objects in copy");var n=directoryPrefix+"/api/copy/"+r+"/objects";return t(function(t,r){e.get(n).success(function(e){t(i.create(e.results))}).error(function(e,t){r(e,t)})})},s.getWork=function(r){console.log("getting work");var o=directoryPrefix+"/api/work/"+r;return t(function(t,r){e.get(o).success(function(e){t(n.create(e))}).error(function(e,t){r(e,t)})})},s.getWorks=function(){console.log("getting work (multiple)");var r=directoryPrefix+"/api/work/";return t(function(t,o){e.get(r).success(function(e){t(n.create(e.results))}).error(function(e,t){o(e,t)})})},s.getCopiesForWork=function(r){console.log("getting copies in work");var n=directoryPrefix+"/api/work/"+r+"/copies";return t(function(t,r){e.get(n).success(function(e){t(o.create(e.results))}).error(function(e,t){r(e,t)})})},s.getFeaturedWorks=function(){console.log("getting featured works");var r=directoryPrefix+"/api/featured_work/";return t(function(t,n){e.get(r).success(function(e){t(c.create(e.results))}).error(function(e,t){n(e,t)})})},s.setSelectedWork=function(e){return console.log("setting work"),t.all([s.getWork(e),s.getCopiesForWork(e)]).then(function(e){s.selectedWork=e[0],s.selectedWork.copiesInWork=e[1],console.log(s.selectedWork)})["catch"](function(){s.selectedWork={}})},s.setWorkNoCopies=function(e){return console.log("setting work no copies"),s.getWork(e).then(function(e){s.selectedWork=e})["catch"](function(){s.selectedWork={}})},s.setSelectedCopy=function(e,r){return console.log("setting copy"),t.all([s.getCopy(e),s.getObjectsForCopy(e)]).then(function(e){if(s.selectedCopy=e[0],s.selectedCopy.objectsInCopy=e[1],console.log(s.selectedCopy),s.selectedCopy.virtual){var t=1;e[1].forEach(function(e){e.object_number=t,t++})}r?e[1].forEach(function(e){e.object_id==r&&(s.selectedCopy.selectedObject=e)}):s.selectedCopy.selectedObject=e[1][0],console.log("copy set")})},s.setSelectedObject=function(e){return console.log("setting an object"),s.getObject(e).then(function(e){s.selectedObject=e,console.log(s.selectedObject)})},s}]).factory("FormatService",function(){var e=function(e){return/\s+copy\s+/.test(e)?e.replace(/copy/,"Copy"):!1};return{cap:function(){return e()}}}).factory("WindowSize",["$window",function(e){var t={},r=angular.element(e);return t.height=r.height(),t.width=r.width(),t}]).directive("resize",["$window","$timeout","WindowSize",function(e,t,r){return function(n,o){var i=angular.element(e);n.getWindowDimensions=function(){return{h:i.height(),w:i.width()}},n.$watch(n.getWindowDimensions,function(e,o){t.cancel(n.resizing),n.resizing=t(function(){r.height=e.h,r.width=e.w,n.$broadcast("resize::resize",{height:r.height,width:r.width})},300)},!0),i.bind("resize",function(){n.$apply()})}}]).directive("copyImage",["WindowSize","$rootScope",function(e){var t=function(t,r,n){t.setStyles=function(e){var t=e.height-270;r.height(t)},r.on("load",function(){t.setStyles(e)}),t.$on("resize::resize",function(e,r){t.setStyles(r)}),t.$on("copyCtrl::toggleTools",function(e,t){var n=1==t.tools?-50:50;r.height(r.height()+n)})};return{restrict:"A",link:t}}]).directive("comparisonImage",["WindowSize",function(e){var t=function(t,r,n){var o=270;t.setStyles=function(e,t){var n=r.height(),o=r.width(),i=o/n,c=e.height-t,l=Math.ceil(c*i);r.css("height",c),r.parent().css("width",l)},r.on("load",function(){t.setStyles(e,o)}),t.$on("resize::resize",function(e,r){t.setStyles(r,o)}),t.$on("compareCtrl::toggleTools",function(r,n){var i=1==n.tools?o:o-112;t.setStyles(e,i)})};return{restrict:"A",link:t}}]).directive("parallax",function(e){return function(t,r,n){angular.element(e).bind("scroll",function(){t.$broadcast("scroll::scroll",{offset:this.pageYOffset})})}}).controller("ObjectController",["$scope","$routeParams","BlakeDataService",function(e,t,r){r.setSelectedWork($routeParams.objectId)}]).config(["$routeProvider","$locationProvider",function(e,t){e.when(directoryPrefix+"/",{templateUrl:directoryPrefix+"/static/controllers/home/home.html",controller:"HomeController",controllerAs:"home"}),e.when(directoryPrefix+"/object/:objectId",{templateUrl:directoryPrefix+"/static/html/object.html",controller:"ObjectController"}),e.when(directoryPrefix+"/copy/:copyId",{templateUrl:directoryPrefix+"/static/controllers/copy/copy.html",controller:"CopyController",controllerAs:"copyCtrl",reloadOnSearch:!1}),e.when(directoryPrefix+"/new-window/:what/:copyId",{templateUrl:directoryPrefix+"/static/controllers/showme/showme.html",controller:"ShowMeController",controllerAs:"showme",reloadOnSearch:!1}),e.when(directoryPrefix+"/work/:workId",{templateUrl:directoryPrefix+"/static/controllers/work/work.html",controller:"WorkController",controllerAs:"workCtrl"}),e.when(directoryPrefix+"/search/",{templateUrl:directoryPrefix+"/static/controllers/search/search.html",controller:"SearchController"}),e.otherwise({redirectTo:directoryPrefix+"/"}),t.html5Mode(!0)}]);
!function(e){"use strict";e(function(){var a=e(window),n={};n.waitForIdle=function(e,a){var n=null;return function(){var o=this,s=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(o,s)},a)}},a.on("resize",n.waitForIdle(function(){if(e("nav.navbar ul.navbar-nav li.dropdown").hasClass("open")){var n=a.width(),o=e("nav.navbar ul.navbar-nav li.dropdown.open").offset().left;e("nav.navbar ul.navbar-nav li.dropdown.open").find("ul.dropdown-menu").css({width:n+"px",left:"-"+o+"px"})}},100));var o=e("button.collapse-archive"),s=e("nav.navbar");"true"!==localStorage.getItem("archive_menu_dismissed")?(o.addClass("menu-closed").removeClass("menu-open"),s.addClass("menu-closed").removeClass("menu-open")):(s.addClass("menu-open").removeClass("menu-closed"),o.addClass("menu-open").removeClass("menu-closed")),o.on("click",function(){s.hasClass("menu-open")?(s.removeClass("menu-open").addClass("menu-closed"),o.removeClass("menu-open").addClass("menu-closed"),localStorage.setItem("archive_menu_dismissed","false")):(s.addClass("menu-open").removeClass("menu-closed"),o.addClass("menu-open").removeClass("menu-closed"),localStorage.setItem("archive_menu_dismissed","true"))}),e(".scrollbar").scroller({customClass:"advanced",trackMargin:10,horizontal:!0}),e(window).on("resize",n.waitForIdle(function(){e(".scrollbar").scroller("reset")},100));var l=e(".back-top");l.length&&(l.on("click",function(){e("html, body").animate({scrollTop:0},"slow")}),a.on("scroll",function(){var e=a.scrollTop();e>=50?l.addClass("scrolling"):l.removeClass("scrolling")}));var r=e("body.home");r.length&&e(function(){e("img.lazy-load").lazyload({threshold:100})})})}(this.jQuery);
!function(){var e=function(e,t,o,c,n,i,s){var a=this;n.showSubMenu=1,a.$storage=s,t.setSelectedCopy(o.copyId,o.objectId).then(function(){a.copy=t.selectedCopy,angular.isDefined(o.objectId)||i.search("objectId",a.copy.selectedObject.object_id);var e=t.selectedCopy.bad_id,c=e.indexOf("."),n=c>0?e.substring(0,c):e;angular.isUndefined(t.selectedWork)?t.setWorkNoCopies(n).then(function(){a.init()}):a.init()}),a.init=function(){a.work=t.selectedWork,a.setSimilarObjects(a.copy.selectedObject.object_id),n.$broadcast("copyCtrl::objectChanged")},a.setSimilarObjects=function(e){t.getObjectsFromSameMatrix(e).then(function(e){a.copy.selectedObject.matrix=e}),t.getObjectsWithSameMotif(e).then(function(e){a.copy.selectedObject.motif=e}),t.getObjectsFromSameProductionSequence(e).then(function(e){a.copy.selectedObject.sequence=e})},a.changeObject=function(e){a.copy.selectedObject=e,i.search("objectId",e.object_id),a.init()},a.trayOpen=!1,a.showTools=!0,a.toggleTray=function(){a.trayOpen=!a.trayOpen},a.toggleTools=function(){a.showTools=!a.showTools,e.$broadcast("copyCtrl::toggleTools",{tools:a.showTools})}};e.$inject=["$scope","BlakeDataService","$routeParams","WindowSize","$rootScope","$location","$sessionStorage"],angular.module("blake").controller("CopyController",e)}();
!function(){var o=function(o,t,f,e,s){var n=this;t.showSubMenu=0,n.columns={1:{topOffset:"-90px"},2:{topOffset:"-20px"},3:{topOffset:"-90px"},4:{topOffset:"-20px"},5:{topOffset:"-90px"},6:{topOffset:"-20px"}},o.$on("scroll::scroll",function(t,f){o.$apply(function(){n.columns[1].topOffset=-90-.2*f.offset+"px",n.columns[2].topOffset=-20-.4*f.offset+"px",n.columns[3].topOffset=-90-.14*f.offset+"px",n.columns[4].topOffset=-20-.4*f.offset+"px",n.columns[5].topOffset=-90-.5*f.offset+"px",n.columns[6].topOffset=-20-.3*f.offset+"px"})}),f.getFeaturedWorks().then(function(o){var t=0,f=1,e=[];angular.forEach(o,function(o){-1==e.indexOf(o.bad_id)&&(e.push(o.bad_id),o.column=f,++t,4==t&&(++f,t=0))}),n.featured_works=o})};o.$inject=["$scope","$rootScope","BlakeDataService","$window","$localStorage"],angular.module("blake").controller("HomeController",o)}();
!function(){var e=function(e,t,o,c,s){e.showSubMenu=0,t.results=[],t.search=function(){s.query(t.searchConfig).then(function(e){t.results=e,console.log(t.results)})},t.loadSearchPage=function(){o.url(directoryPrefix+"/search?search="+encodeURIComponent(t.searchText))},t.searchConfig={useCompDate:!0,searchTitle:!0,searchText:!0,searchWorkInformation:!0,searchImageKeywords:!0,searchNotes:!0,searchImageDescriptions:!0,searchIlluminatedBooks:!0,searchCommercialBookIllustrations:!0,searchSeparatePrints:!0,searchDrawingsPaintings:!0,searchManuscripts:!0,searchRelatedMaterials:!0,minDate:1772,maxDate:1827},t.pagination={title:[],text:[],notes:[],tag:[],description:[],worktitle:[],workinfo:[]},t.setPagination=function(e,o){t.pagination[e]=[];var c,s=Math.ceil(o/10);if(s>1)for(c=1;s>=c;c++)t.pagination[e].push(c)},t.paginate=function(e,o){switch(e){case"title":t.searchConfig.objectTitleOffset=10*(o-1);break;case"text":t.searchConfig.objectTextOffset=10*(o-1);break;case"tag":t.searchConfig.objectKeywordsOffset=10*(o-1);break;case"notes":t.searchConfig.objectNotesOffset=10*(o-1);break;case"description":t.searchConfig.objectDescriptionOffset=10*(o-1);break;case"worktitle":t.searchConfig.workTitleOffset=10*(o-1);break;case"workinfo":t.searchConfig.workInformationOffset=10*(o-1)}console.log(t.searchConfig),t.search()},c.search&&(t.searchConfig.searchString=c.search,t.search()),t.populateWorkCopies=function(e,o){var c=[],a={};t.selectedObjectSearchWork[e]!=o?(t.results.object_results[e][o][2].forEach(function(e){"string"==typeof e[0]&&(c.push(e[0]),a[e[0]]=e)}),c.length>0&&s.getCopies(c).then(function(e){e.forEach(function(e){a[e.bad_id][0]=e})}),t.selectedObjectSearchWork[e]=o):delete t.selectedObjectSearchWork[e]},t.populateCopyObjects=function(e,o,c){var a=[],r={};t.selectedObjectSearchCopy[e][o]!=c?(t.results.object_results[e][o][2][c][2].forEach(function(e){"number"==typeof e[0]&&(a.push(e[0]),r[e[0]]=e)}),a.length>0&&s.getObjects(a).then(function(e){e.forEach(function(e){r[e.object_id][0]=e})}),t.selectedObjectSearchCopy[e][o]=c):delete t.selectedObjectSearchCopy[e][o]},t.selectedObjectSearchCopy={},t.selectedObjectSearchWork={},t.showWorks=!0,t.showCopies=!0,t.showObjects=!0};e.$inject=["$rootScope","$scope","$location","$routeParams","BlakeDataService"],angular.module("blake").controller("SearchController",e)}();
!function(){var e=function(e,t,o,c,n,i){var p=this;n.showmePage=!0,p.what=o.what,t.setSelectedCopy(o.copyId,o.objectId).then(function(){p.copy=t.selectedCopy;var e=t.selectedCopy.bad_id,o=e.indexOf("."),c=o>0?e.substring(0,o):e;angular.isUndefined(t.selectedWork)?t.setWorkNoCopies(c).then(function(){p.init()}):p.init()}),p.init=function(){p.work=t.selectedWork,p.copy.objectsInCopy.length>1&&p.getPreviousNextObjects()},p.getOvpTitle=function(){if(angular.isDefined(p.copy)){if(1==p.copy.virtual)return p.copy.selectedObject.title;var e=null==p.copy.archive_copy_id?"":", Copy "+p.copy.archive_copy_id;return p.copy.header.filedesc.titlestmt.title["@reg"]+e}},p.getOvpSubtitle=function(){return angular.isDefined(p.copy)?1==p.copy.virtual?"Object "+p.copy.selectedObject.object_number+p.copy.selectedObject.full_object_id.replace(/object [\d]+/g,""):p.copy.selectedObject.full_object_id:void 0},p.getPreviousNextObjects=function(){if(p.copy.objectsInCopy&&p.copy.objectsInCopy.length)for(var e=p.copy.objectsInCopy.length;e--;)if(p.copy.objectsInCopy[e].object_id==p.copy.selectedObject.object_id){0>e-1?p.previousObject=p.copy.objectsInCopy[p.copy.objectsInCopy.length-1]:p.previousObject=p.copy.objectsInCopy[e-1],e+1>=p.copy.objectsInCopy.length?p.nextObject=p.copy.objectsInCopy[0]:p.nextObject=p.copy.objectsInCopy[e+1];break}},p.changeObject=function(e){p.copy.selectedObject=e,i.search("objectId",e.object_id),p.init()}};e.$inject=["$scope","BlakeDataService","$routeParams","WindowSize","$rootScope","$location"],angular.module("blake").controller("ShowMeController",e)}();
!function(){var e=function(e,r,o,n){var t=this;n.setSelectedWork(r.workId).then(function(){t.work=n.selectedWork;var e=a(t.work.medium);t.work.medium_pretty=e.medium,t.work.probable=e.probable,t.copies=t.work.copiesInWork,t.sortCopies(t.copies),t.copyCount=t.copies.length,t.rowCount=Math.ceil(t.copyCount/4),t.knownCopiesDiv3=Math.ceil(t.copyCount/3),angular.isUndefined(t.work.related_works)||null===t.work.related_works||(t.allKnownRelatedItemsDiv3=Math.ceil(t.work.related_works.length/3)),t.rows=[];for(var r=1;r<=t.rowCount;r++)t.rows.push(r)}),t.sortCopies=function(e){angular.isDefined(e)&&e.sort(function(e,r){return e.archive_copy_id>r.archive_copy_id?1:e.archive_copy_id<r.archive_copy_id?-1:0})},t.getCopyFirstObject=function(e){function r(e){switch(e){case"comb":return"com";case"comdes":return"com";case"comeng":return"com";case"spb":return"sp";case"spdes":return"sp";case"speng":return"sp";case"cprint":return"cpd";case"mono":return"wd";case"paint":return"pt";case"pen":return"pid";case"penink":return"pid";case"penc":return"pid";case"wc":return"wc";case"ms":return"ms";case"ltr":return"lt";case"te":return"typ";default:return!1}}return t.work?"illbk"==t.work.medium?"http://www.blakearchive.org/blake/images/"+e.bad_id+".p1.100.jpg":"http://www.blakearchive.org/blake/images/"+e.bad_id+".1."+r(t.work.medium)+".100.jpg":void 0};var a=function(e){switch(e){case"illbk":return{medium:"Illuminated Books",probable:"printing"};case"comb":case"comdes":case"comeng":return{medium:"Commercial Book Illustrations",probable:"printing"};case"spb":case"spdes":case"speng":case"cprint":return{medium:"Prints",probable:"printing"};case"mono":case"paint":case"pen":case"penink":case"penc":case"wc":return{medium:"Drawings and Paintings",probable:"composition"};case"ms":case"ltr":case"te":return{medium:"Manuscripts and Typographic Works",probable:"composition"};default:return!1}}};e.$inject=["$scope","$routeParams","$sanitize","BlakeDataService"],angular.module("blake").controller("WorkController",e)}();
!function(){var e=function(e,o){var t=this;t.getHeader=function(){return angular.isDefined(t.copy)?t.copy.virtual?t.copy.selectedObject.header:t.copy.header:void 0},t.getSource=function(){return angular.isDefined(t.copy)?t.copy.virtual?t.copy.selectedObject.source:t.copy.source:void 0},t.getOriginationRole=function(e){if(e){if(e.join){var o=[];return e.forEach(function(e){o.push(e["#text"])}),o.join(" ")}return e["#text"]}}};e.$inject=["$scope","BlakeDataService"];var o=function(){return{restrict:"E",templateUrl:"/blake/static/directives/copy-information/copyInformation.html",controller:e,controllerAs:"info",scope:{copy:"=copy"},bindToController:!0}};angular.module("blake").directive("copyInformation",o)}();
!function(){var t=function(){},e=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/editor-notes/editorNotes.html",controller:t,scope:{object:"=object"},controllerAs:"noteCtrl",bindToController:!0}};angular.module("blake").directive("editorNotes",e)}();
!function(){var e=function(e,t,o){var i=this;i.showTab=function(e){i.selectedTab=e},i.selectedTab="#objects-in-copy",i.getHeader=function(){if(angular.isDefined(i.copy)){if(1!=i.copy.virtual)return i.copy.header.filedesc.titlestmt.title.main["#text"];if(angular.isDefined(i.work))return i.work.title}},i.getOicSubheader=function(){if(angular.isDefined(i.copy)){if(1==i.copy.virtual)return"";var e=null==i.copy.archive_copy_id?"":"Copy "+i.copy.archive_copy_id+", ",t=angular.isDefined(i.copy.source.objinfo.printdate)?i.copy.source.objinfo.printdate["#text"]+" ":"",o=null==i.copy.institutuion?"":"("+i.copy.institution+")";return e+t+o}},i.getCopyOrGroup=function(){return angular.isDefined(i.copy)?i.copy.virtual?"Group":"Copy":void 0},e.$on("copyCtrl::objectChanged",function(){i.selectedTab="#objects-in-copy"})};e.$inject=["$scope","$localStorage","BlakeDataService"];var t=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/copy-tabs/copyTabs.html",controller:e,controllerAs:"tabs",scope:{copy:"=copy",work:"=work",changeObject:"&"},bindToController:!0}};angular.module("blake").directive("copyTabs",t)}();
!function(){var t=function(){},i=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/illustration-description/illustrationDescription.html",controller:t,scope:{object:"=object"},controllerAs:"descCtrl",bindToController:!0}};angular.module("blake").directive("illustrationDescription",i)}();
!function(){var t=function(t,e,i,r){var n=this;n.firstLine=1,n.trayPixels=i.height-136,i.width<=992?n.trayHeight=0:n.trayHeight=n.trayPixels+"px",n.panelCount=5,n.trayBodyHeight=n.trayPixels-53*n.panelCount+"px",n.newWindow=function(t,e){r.open("/blake/new-window/"+e+"/"+t.bad_id+"?objectId="+t.selectedObject.object_id,"_blank","width=800, height=600")},t.$on("resize::resize",function(t,e){n.trayPixels=e.height-136,i.width<=992?n.trayHeight=0:n.trayHeight=n.trayPixels+"px",n.trayBodyHeight=n.trayPixels-53*n.panelCount+"px"})};t.$inject=["$scope","BlakeDataService","WindowSize","$window"];var e=function(){return{restrict:"E",scope:{toggle:"&",copy:"=copy"},templateUrl:"/blake/static/directives/info-tray/infoTray.html",controller:t,controllerAs:"tray",bindToController:!0}};angular.module("blake").directive("infoTray",e)}();
!function(){var n=function(n,e,t){var r=this;$("nav.navbar ul.navbar-nav > li.dropdown").click(function(){var n=$(window).width(),e=$(this).offset().left;$(this).find("ul.dropdown-menu").css({width:n+"px",left:"-"+e+"px"})}),angular.isUndefined(t.menus)?e.getWorks().then(function(n){r.organizeMenus(n)}):r.lists=t.menus;var i=function(n){switch(n){case"illbk":return"illuminated_books";case"comb":return"book_illustration:designed_engraved";case"comdes":return"book_illustration:designed";case"comeng":return"book_illustration:engraved";case"spb":return"prints:designed_engraved";case"spdes":return"prints:designed";case"speng":return"prints:engraved";case"cprint":return"prints:drawings";case"mono":return"drawings_paintings:monochrome";case"paint":return"drawings_paintings:paintings";case"pen":case"penink":return"drawings_paintings:pen";case"penc":return"drawings_paintings:pencil";case"wc":return"drawings_paintings:wc";case"ms":return"manuscripts_typo:manuscripts";case"ltr":return"manuscripts_typo:letters";case"te":return"manuscripts_typo:typographic";default:return!1}};r.organizeMenus=function(n){if(n){n.sort(function(n,e){return n.composition_date-e.composition_date});var e={illuminated_books:[],book_illustration:[{designed_engraved:[],designed:[],engraved:[]}],prints:[{designed_engraved:[],designed:[],engraved:[],drawings:[]}],drawings_paintings:[{pencil:[],pen:[],monochrome:[],wc:[],paintings:[]}],manuscripts_typo:[{manuscripts:[],letters:[],typographic:[]}]};n.forEach(function(n){var t,r=i(n.medium);r&&(t=r.split(/:/),void 0===e[t[0]]&&void 0===e[t[0]][0][t[1]]||(1===t.length?e[t[0]].push(n):e[t[0]][0][t[1]].push(n)))}),r.lists=e,t.menus=e}}};n.$inject=["$scope","BlakeDataService","$sessionStorage"];var e=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/menu/template.html",controller:n,controllerAs:"menu",bindToController:!0}};angular.module("blake").directive("navMenu",e)}();
!function(){var e=function(e,o,t,r,c){var a=this;a.$storage=c};e.$inject=["$scope","WindowSize","$timeout","$rootScope","$sessionStorage"];var o=function(){return{restrict:"E",templateUrl:"/blake/static/directives/object-compare/objectCompare.html",controller:e,scope:{copy:"=copy",work:"=work",changeObject:"&"},controllerAs:"compare",bindToController:!0}};angular.module("blake").directive("objectCompare",o)}();
!function(){var t=function(){var t=this;switch(t.strongTitle="",t.title="",t.date="",t.institutuion="",t.copyLtr="",t.objNumber="",t.type){case"copyDesc":t.virtual?t.title=t.override:(t.title="Copy "+t.object.archive_copy_id,t.object.source.objinfo.printdate&&(t.date=t.object.source.objinfo.printdate["#text"]),t.institution=t.object.institution);break;case"objectSimple":t.virtual?(t.title=t.object.title,t.objNumber="Object "+t.object.object_number+t.object.full_object_id.replace(/object [\d]+/g,"")):t.objNumber=t.object.full_object_id;break;case"objectFull":t.virtual?(t.strongTitle=t.object.copy_title,t.title=t.object.title):(t.strongTitle=t.object.title,t.object.archive_copy_id&&(t.copyLtr="Copy "+t.object.archive_copy_id),t.objNumber=t.object.full_object_id)}},e=function(){return{restrict:"A",templateUrl:"/blake/static/directives/object-description/objectDescription.html",controller:t,scope:{object:"=object",virtual:"=virtual",type:"@type",override:"=override"},controllerAs:"objDesc",bindToController:!0}};angular.module("blake").directive("objectDescription",e)}();
!function(){var t=function(){},e=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/object-metadata/objectMetadata.html",controller:t,scope:{object:"=object"},controllerAs:"metaCtrl",bindToController:!0}};angular.module("blake").directive("objectMetadata",e)}();
!function(){var e=function(e){var o=this;o.newWindow=function(o){e.open("/blake/new-window/enlargement/"+o.bad_id+"?objectId="+o.selectedObject.object_id,"_blank","width=800, height=600")}};e.$inject=["$window"];var o=function(){return{restrict:"E",templateUrl:"/blake/static/directives/object-tools/objectTools.html",controller:e,scope:{copy:"=copy",toggle:"&"},controllerAs:"objTools",bindToController:!0}};angular.module("blake").directive("objectTools",o)}();
!function(){var e=function(){var e=this;e.getOvpTitle=function(){if(angular.isDefined(e.copy)){if(1==e.copy.virtual)return e.copy.selectedObject.title;var o=null==e.copy.archive_copy_id?"":", Copy "+e.copy.archive_copy_id;return e.copy.header.filedesc.titlestmt.title["@reg"]+o}},e.getOvpSubtitle=function(o){return angular.isDefined(e.copy)?1==e.copy.virtual?"Object "+o.object_number+o.full_object_id.replace(/object [\d]+/g,""):o.full_object_id:void 0},e.getPreviousObject=function(){if(angular.isDefined(e.copy.objectsInCopy))for(var o=e.copy.objectsInCopy.length;o--;)if(e.copy.objectsInCopy[o].object_id==e.copy.selectedObject.object_id)return 0>o-1?e.copy.objectsInCopy[e.copy.objectsInCopy.length-1]:e.copy.objectsInCopy[o-1]},e.getNextObject=function(){if(angular.isDefined(e.copy.objectsInCopy))for(var o=e.copy.objectsInCopy.length;o--;)if(e.copy.objectsInCopy[o].object_id==e.copy.selectedObject.object_id)return o+1>=e.copy.objectsInCopy.length?e.copy.objectsInCopy[0]:e.copy.objectsInCopy[o+1]}},o=function(){return{restrict:"E",templateUrl:"/blake/static/directives/object-viewer/objectViewer.html",controller:e,scope:{copy:"=copy",work:"=work",changeObject:"&"},controllerAs:"viewer",bindToController:!0}};angular.module("blake").directive("objectViewer",o)}();
!function(){var e=function(e,c){var t=this;t.addComparisonObject=function(e){var t,o=!1;for(t=c.comparisonObjects.length;t--;)if(c.comparisonObjects[t].object_id==e.object_id){o=!0;break}o||c.comparisonObjects.push(e)},t.removeComparisonObject=function(e){var t;for(t=c.comparisonObjects.length;t--;)if(c.comparisonObjects[t].object_id==e.object_id){c.comparisonObjects.splice(t,1);break}},t.clearComparisonObjects=function(){c.comparisonObjects=[],c.comparisonObjects.unshift(t.copy.selectedObject)},t.isComparisonObject=function(e){for(var t=c.comparisonObjects.length;t--;)if(c.comparisonObjects[t].object_id==e.object_id)return!0;return!1},t.selectAll=function(){if(angular.isDefined(t.copy.selectedObject.matrix)){var e=t.copy.selectedObject.matrix.length;if(t.clearComparisonObjects(),t.selectedAll){t.compareText="Select All Objects",t.selectedAll=!1;for(var c=e;c--;)t.copy.selectedObject.matrix[c].Selected=!1;t.clearComparisonObjects()}else{t.compareText="Clear All Objects",t.selectedAll=!0;for(var o=e;o--;)t.copy.selectedObject.matrix[o].Selected=!0,t.addComparisonObject(t.copy.selectedObject.matrix[o])}}},t.selectOne=function(e){var c=t.copy.selectedObject.matrix.indexOf(e);t.copy.selectedObject.matrix[c].Selected?(t.copy.selectedObject.matrix[c].Selected=!1,t.removeComparisonObject(e)):(t.copy.selectedObject.matrix[c].Selected=!0,t.addComparisonObject(e))},t.activateCompare=function(){c.view={mode:"compare",scope:"image"}},t.compareText="Select All Objects",t.selectedAll=!1,e.$on("copyCtrl::objectChanged",function(){t.compareText="Select All Objects",t.selectedAll=!1,t.clearComparisonObjects()})};e.$inject=["$scope","$sessionStorage"];var c=function(){return{restrict:"E",templateUrl:"/blake/static/directives/objects-from-same-matrix/objectsFromSameMatrix.html",controller:e,controllerAs:"matrix",scope:{copy:"=copy"},bindToController:!0}};angular.module("blake").directive("objectsFromSameMatrix",c)}();
!function(){var t=function(){},e=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/tei-markup/teiMarkup.html",controller:t,scope:{object:"=object"},controllerAs:"teiCtrl",bindToController:!0}};angular.module("blake").directive("teiMarkup",e)}();
!function(){var e=function(e,o){var i=this;angular.isDefined(o.view)||(console.log("no session storage view"),o.view={mode:"object",scope:"image"}),i.$storage=o,i.changeView=function(e,o){i.$storage.view.mode=e,i.$storage.view.scope=o}};e.$inject=["$scope","$sessionStorage"];var o=function(){return{restrict:"E",scope:!0,templateUrl:"/blake/static/directives/view-sub-menu/viewSubMenu.html",controller:e,controllerAs:"viewSubMenu",bindToController:!0}};angular.module("blake").directive("viewSubMenu",o)}();
!function(){var t=function(){},r=function(){return{restrict:"EA",templateUrl:"/blake/static/directives/text-transcription/textTranscription.html",controller:t,scope:{object:"=object"},controllerAs:"textCtrl",bindToController:!0}};angular.module("blake").directive("textTranscription",r)}();