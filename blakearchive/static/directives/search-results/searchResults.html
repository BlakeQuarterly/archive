<h3>{{ esr.label }} ({{ esr.resultTree.length}} works)</h3>

<div ng-show="esr.resultTree.length == 0">
    No results found
</div>


<div class="row search-result-row" ng-show="esr.resultTree.length > 0">
    <div class="col-xs-12 full-width">
        <slide-box id="{{esr.type}}-slide-box">
            <div ng-repeat="(k,work) in esr.resultTree" class="search-result-item">
                <div class="handprint-block" ng-class="{selected:k == esr.selectedWork}">
                    <a href="#" ng-click="esr.showCopies($index); slideBox.scrollToResult($index)">
                        <span class="object-img" style="background-image: url(http://www.blakearchive.org/blake/images/{{ work[2][0][2][0][0].dbi }}.100.jpg);"></span>
                        <span class="description"><strong>{{ work[0].title }}</strong><br><span ng-if="work[1] > 1">({{ work[1] }} results<span ng-if="work[2].length > 1"> in {{ work[2].length }} copies</span>)</span></span>
                    </a>
                </div>
            </div>
        </slide-box>
    </div>
    <div class="col-xs-12 full-width">
        <div class="copy-container" ng-style="esr.selectedWork != -1 ? esr.copy_container: {'height':0}">
            <header class="page-header">
                <h1>{{esr.resultTree[esr.selectedWork][0].title}}</h1>
                <button class="close-copies"><span class="glyphicon glyphicon-remove" ng-click="esr.closeCopies()"></span></button>
            </header>
            <div class="flex" ng-style="esr.copy_container_flex">
                <div class="copies-in-work" ng-style="esr.search_grid">
                    <div class="flex-wrap">
                        <div class="handprint-block-small" 
                            ng-repeat="copy in esr.resultTree[esr.selectedWork][2] track by $index"
                            ng-class="{selected: esr.selectedCopy == $index}"
                            >
                            <a ng-click="esr.showObjects($index)">
                                <span class="object-img" style="background-image: url(http://www.blakearchive.org/blake/images/{{ copy[0].image }}.100.jpg);"></span>
                                <span class="description text-capitalize">
                                    Copy {{copy[0].archive_copy_id}}, {{copy[0].composition_date}}<br>
                                    <small>({{ copy[2].length }} object<span ng-if="copy[2].length > 1">s</span>)</small>
                                </span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="objects-in-copy" ng-style="esr.search_grid" ng-class="{'hidden':esr.selectedCopy == -1}">
                    <div class="object-img-container text-center" ng-style="esr.object_image_container" ng-class="{'hidden':esr.selectedObject == -1}">
                        <img ng-src="http://www.blakearchive.org/blake/images/{{ esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2][esr.selectedObject][0].dbi }}.100.jpg">
                    </div>
                    <div class="flex-wrap">
                        <div class="handprint-block-small" 
                             ng-repeat="object in esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2] track by $index"
                             ng-class="{selected: esr.selectedObject == $index}"
                            >
                            <a ng-click="esr.showHighlight($index)">
                                <span class="object-img" style="background-image: url(http://www.blakearchive.org/blake/images/{{ object[0].dbi }}.100.jpg);"></span>
                                <span class="description text-capitalize">{{object[0].full_object_id}}</span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="object-result-highlight" ng-style="esr.search_grid" ng-class="{'hidden':esr.selectedObject == -1}">
                    <div ng-if="esr.type == 'title'" class="text-center">
                        <span ng-bind-html="esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2][esr.selectedObject][0].title | highlight:esr.highlight"></span>
                    </div>
                    <div ng-if="esr.type == 'text'">
                        <text-transcription object="esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2][esr.selectedObject][0]" highlight="{{esr.highlight}}"></text-transcription>
                    </div>
                    <div ng-if="esr.type == 'description'">
                        <illustration-description object="esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2][esr.selectedObject][0]" highlight="{{esr.highlight}}"></illustration-description>
                    </div>
                    <div ng-if="esr.type == 'notes'">
                        <editor-notes object="esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2][esr.selectedObject][0]" highlight="{{esr.highlight}}"></editor-notes>
                    </div>
                    <div ng-if="esr.type == 'tag'">
                        <illustration-description object="esr.resultTree[esr.selectedWork][2][esr.selectedCopy][2][esr.selectedObject][0]" highlight="{{esr.highlight}}" keywords="true"></illustration-description>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>